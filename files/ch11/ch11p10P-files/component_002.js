window.Chegg_Search_Define=function(e,t,s,r,n){!function(e,t){return e=e||global,e.EVENTS_NO_REQUIRE?void(e.Events=t()):void("object"==typeof exports?module.exports.Events=t():e.Events=t())}(this,function(){function e(e,t){return e.indexOf?e.indexOf(t):String.prototype.indexOf(e,t)}function t(e){if(g.strict)throw new Error(e);"console"in window&&(console.error?console.error(e):console.warn?console.warn(e):console.log(e))}function s(e){return e.replace(/^on([A-Z])/,function(e,t){return t.toLowerCase()})}function i(e){var s=e.match(b);return e.split(":").length>2&&t("Library does not support multiple pseudo events"),{name:s[1],pseudo:s[2],args:s[3]}}function r(e){return i(s(e))}function n(e,t,s,i){var r;return m?(r=document.createEvent("UIEvents"),r.initUIEvent(e,i,!0,window,1)):r={},r.dispatcher=t,r.args=s,r.object_event=!0,r}function o(t,s,i){m?t.$event_element.addEventListener(s,i,!1):t.$events[s]?-1==e(t.$events[s],i)&&t.$events[s].push(i):t.$events[s]=[i]}function a(e,t,s){var i,r;if(m)e.$event_element.dispatchEvent(s);else{if(!e.$events[t])return;for(i=0;r=e.$events[t][i];i++)r.apply(null,[s])}}function l(t,s,i){var r;if(m)t.$event_element.removeEventListener(s,i,!1);else{if(!t.$events[s])return;if(r=e(t.$events[s],i),0>r)return;t.$events[s].splice(r,1)}}var c,h,d,u,p,g,f,m=!1,b=/([^:]+)(?:\:([^(]*)(?:\((.*)\))?)?/;try{m=document&&"addEventListener"in document}catch(v){}return g=function k(e,t){var s,i=this,r="$event_element $latched $events $once addEvent addEvents fireEvent removeEvent addEventOnce fireLatchedEvent".split(" ");m?this.$event_element=e||document.createElement("events"):this.$events={},this.$has_events=!0,this.$latched={},this.$once={},this.addEvent=c,this.addEvents=h,this.fireEvent=d,this.removeEvent=u,this.addEventOnce=p,this.fireLatchedEvent=f;for(s in k.aliases)this[s]=this[k.aliases[s]],r.push(s);t||this.addEvent("destroy:delay(0)",function(){var e,t;if(!i.$no_ev_destroy){for(e=0;t=r[e];e++)i[t]=null;i.$events_destroyed=!0}})},g.removeOn=s,g.getPseudos=i,g.processType=r,g.createEvent=n,g.strict=!1,g.aliases={on:"addEvent",addListener:"addEvent",once:"addEventOnce",removeListener:"removeEvent",off:"removeEvent",emit:"fireEvent"},g.Pseudoes={once:{addEvent:function(e,t){return this.addEventOnce(e,t)}},latched:{fireEvent:function(e,t){return this.fireLatchedEvent(e,t)}},times:{addEvent:function(e,t,s){var i=0,r=this;this.addEvent(e,function n(){t.apply(null,arguments),i+=1,i==s&&r.removeEvent(e,n)})}},delay:{addEvent:function(e,t,s){this.addEvent(e,function(){setTimeout(t,s)})},fireEvent:function(e,t,s){var i=this;setTimeout(function(){i.fireEvent(e,t)},s)}}},c=function(e,t){if(this.$events_destroyed)return this;var s,i=r(e),a=g.Pseudoes[i.pseudo]&&g.Pseudoes[i.pseudo].addEvent,l=this.$latched[i.name]&&this.$latched[i.name].args;return a?a.apply(this,[i.name,t,i.args]):(o(this,i.name,t),this.$latched&&this.$latched[i.name]&&(s=n(i.name,this,l),t.apply(null,[s])),this)},h=function(e){if(this.$events_destroyed)return this;var t;for(t in e)e.hasOwnProperty(t)&&this.addEvent(t,e[t]);return this},d=function(e,t,s){if(this.$events_destroyed)return this;var i,o,l,c=r(e),h=g.Pseudoes[c.pseudo]&&g.Pseudoes[c.pseudo].fireEvent;if(null==s&&(s=!0),h)return h.call(this,c.name,t);if(l=this.$once[c.name],this.$once[c.name]=null,i=n(c.name,this,t,s),a(this,c.name,i),!l)return this;for(;o=l.pop();)this.removeEvent(c.name,o,!0);return this},u=function(t,s,i){if(this.$events_destroyed)return this;var n,o=r(t);return l(this,o.name,s),!i&&this.$once[o.name]&&(n=e(this.$once[o.name],s))>-1&&this.$once[o.name].splice(n,1),this},p=function(t,s){if(this.$events_destroyed)return this;var i=r(t);return this.$once[i.name]||(this.$once[i.name]=[]),-1==e(this.$once[i.name],s)&&this.$once[i.name].push(s),this.addEvent(i.name,s)},f=function(e,t){return this.$events_destroyed?this:(this.$latched||(this.$latched={}),this.$latched[e]={args:t},this.fireEvent(e,t),this)},g.addEvent=c,g.addEvents=h,g.addEventOnce=p,g.fireEvent=d,g.fireLatchedEvent=f,g.removeEvent=u,g.processType=r,g}),n.define("C.common.bookcover",{inputs:["show","hide","set book image","set book alt","set book link","set book cover size","set book cover type","set book data","get book data","turn on shadow","turn off shadow","add class"],outputs:["ready","error","clicked","returned book data"]},r.View.extend({events:{"click a":"bookOnClick"},initialize:function(){this.model=new r.Model,this.$el.addClass("centered shadow-enabled"),"undefined"!=typeof e.browser&&e.browser&&e.browser.msie&&e.browser.version<=8&&this.$el.addClass("ie-old"),n.find(this).on("set book cover type",this.setBookCoverType).on("set book cover size",this.setBookCoverSize).on("set book image",this.setBookImage).on("set book alt",this.setBookAlt).on("set book link",this.setBookLink).on("add class",this.setBookClassName).on("turn on shadow",this.enableShadow).on("turn off shadow",this.disableShadow).on("set book data",this.setData).on("get book data",this.getData).trigger("ready")},setData:function(e,t){this.model.set("data",t)},getData:function(){n.find(this).trigger("returned book data",this.model.get("data"))},render:function(){this.$el.removeClass("img-wrapper"),this.$el.empty();var t=this.$el;if(this.model.get("image")){this.model.get("link")&&(t=e("<a></a>").attr("href",this.model.get("link")).appendTo(this.$el)),this.$el.hasClass("centered")&&t.addClass("img-wrapper");var s=e("<img/>").appendTo(t);s.error(e.proxy(function(){this.$el.addClass("error"),this.$("img").remove(),this.Eggshell.trigger("error")},this)),s.attr("src",this.model.get("image"))}},setBookCoverType:function(e,t){if(!t||"string"!=typeof t)throw"Invalid book cover type. Type needs to be a string value.";this.$el.removeClass("flexible centered shadow-enabled img-wrapper"),"flexible"===t?this.$el.addClass("flexible"):"centered"===t&&this.$el.addClass("centered shadow-enabled")},setBookCoverSize:function(e,t){if(!t||"string"!=typeof t)throw"Invalid book cover size. Size needs to be a string value.";this.$el.removeClass("large medium small"),"small"===t?this.$el.addClass("small"):"medium"===t?this.$el.addClass("medium"):"large"===t&&this.$el.addClass("large")},setBookImage:function(e,t){if(!t&&"string"!=typeof t)throw"Invalid book image url. Url needs to be a string value.";this.model.set("image",t),this.render()},setBookAlt:function(e,t){if(!t&&"string"!=typeof t)throw"Invalid book alt. Alt needs to be a string value.";this.$("img").attr("alt",t)},setBookLink:function(e,t){if(!t&&"string"!=typeof t)throw"Invalid link. Link needs to be a string value.";this.model.set("link",t),this.render()},setBookClassName:function(e,t){if(!t&&"string"!=typeof t)throw"Invalid class name";this.$("img").addClass(t)},enableShadow:function(){this.$el.addClass("shadow-enabled")},disableShadow:function(){this.$el.removeClass("shadow-enabled")},bookOnClick:function(e){this.Eggshell.trigger("clicked")}})),function(e){var t={init:function(s){var i=e.extend({items:1,itemsOnPage:1,pages:0,displayedPages:5,edges:2,currentPage:1,hrefTextPrefix:"#page-",hrefTextSuffix:"",prevText:"Prev",nextText:"Next",ellipseText:"&hellip;",cssStyle:"light-theme",labelMap:[],selectOnClick:!0,onPageClick:function(e,t){},onInit:function(){}},s||{}),r=this;return i.pages=i.pages?i.pages:Math.ceil(i.items/i.itemsOnPage)?Math.ceil(i.items/i.itemsOnPage):1,i.currentPage=i.currentPage-1,i.halfDisplayed=i.displayedPages/2,this.each(function(){r.addClass(i.cssStyle+" simple-pagination").data("pagination",i),t._draw.call(r)}),i.onInit(),this},selectPage:function(e){return t._selectPage.call(this,e-1),this},prevPage:function(){var e=this.data("pagination");return e.currentPage>0&&t._selectPage.call(this,e.currentPage-1),this},nextPage:function(){var e=this.data("pagination");return e.currentPage<e.pages-1&&t._selectPage.call(this,e.currentPage+1),this},getPagesCount:function(){return this.data("pagination").pages},getCurrentPage:function(){return this.data("pagination").currentPage+1},destroy:function(){return this.empty(),this},drawPage:function(e){var s=this.data("pagination");return s.currentPage=e-1,this.data("pagination",s),t._draw.call(this),this},redraw:function(){return t._draw.call(this),this},disable:function(){var e=this.data("pagination");return e.disabled=!0,this.data("pagination",e),t._draw.call(this),this},enable:function(){var e=this.data("pagination");return e.disabled=!1,this.data("pagination",e),t._draw.call(this),this},updateItems:function(e){var s=this.data("pagination");s.items=e,s.pages=t._getPages(s),this.data("pagination",s),t._draw.call(this)},updateItemsOnPage:function(e){var s=this.data("pagination");return s.itemsOnPage=e,s.pages=t._getPages(s),this.data("pagination",s),t._selectPage.call(this,0),this},_draw:function(){var s,i,r=this.data("pagination"),n=t._getInterval(r);t.destroy.call(this),i="function"==typeof this.prop?this.prop("tagName"):this.attr("tagName");var o="UL"===i?this:e("<ul></ul>").appendTo(this);if(r.prevText&&t._appendItem.call(this,r.currentPage-1,{text:r.prevText,classes:"prev"}),n.start>0&&r.edges>0){var a=Math.min(r.edges,n.start);for(s=0;a>s;s++)t._appendItem.call(this,s);r.edges<n.start&&n.start-r.edges!=1?o.append('<li class="disabled"><span class="ellipse">'+r.ellipseText+"</span></li>"):n.start-r.edges==1&&t._appendItem.call(this,r.edges)}for(s=n.start;s<n.end;s++)t._appendItem.call(this,s);if(n.end<r.pages&&r.edges>0){r.pages-r.edges>n.end&&r.pages-r.edges-n.end!=1?o.append('<li class="disabled"><span class="ellipse">'+r.ellipseText+"</span></li>"):r.pages-r.edges-n.end==1&&t._appendItem.call(this,n.end++);var l=Math.max(r.pages-r.edges,n.end);for(s=l;s<r.pages;s++)t._appendItem.call(this,s)}r.nextText&&t._appendItem.call(this,r.currentPage+1,{text:r.nextText,classes:"next"})},_getPages:function(e){var t=Math.ceil(e.items/e.itemsOnPage);return t||1},_getInterval:function(e){return{start:Math.ceil(e.currentPage>e.halfDisplayed?Math.max(Math.min(e.currentPage-e.halfDisplayed,e.pages-e.displayedPages),0):0),end:Math.ceil(e.currentPage>e.halfDisplayed?Math.min(e.currentPage+e.halfDisplayed,e.pages):Math.min(e.displayedPages,e.pages))}},_appendItem:function(s,i){var r,n,o=this,a=o.data("pagination"),l=e("<li></li>"),c=o.find("ul");s=0>s?0:s<a.pages?s:a.pages-1,r={text:s+1,classes:""},a.labelMap.length&&a.labelMap[s]&&(r.text=a.labelMap[s]),r=e.extend(r,i||{}),s==a.currentPage||a.disabled?(a.disabled?l.addClass("disabled"):l.addClass("active"),n=e('<span class="current">'+r.text+"</span>")):(n=e('<a href="'+a.hrefTextPrefix+(s+1)+a.hrefTextSuffix+'" class="page-link">'+r.text+"</a>"),n.click(function(e){return t._selectPage.call(o,s,e)})),r.classes&&n.addClass(r.classes),l.append(n),c.length?c.append(l):o.append(l)},_selectPage:function(e,s){var i=this.data("pagination");return i.currentPage=e,i.selectOnClick&&t._draw.call(this),i.onPageClick(e+1,s)}};e.fn.pagination=function(s){return t[s]&&"_"!=s.charAt(0)?t[s].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof s&&s?void e.error("Method "+s+" does not exist on jQuery.pagination"):t.init.apply(this,arguments)}}(t),n.define("C.Eggshell.pagination",{inputs:["totalItemsNum","itemsPerPage","currentPage","pages","displayedPages","pageNumAtEdges","previousText","nextText","hrefTextPrefix","hrefTextSuffix","theme","selectOnClick","showPageDesc","limitMaxPages"],outputs:[]},r.View.extend({$el:null,totalItemsNum:1,showPageDesc:!0,itemsPerPage:1,currentPage:1,displayedPages:3,pageNumAtEdges:1,nextText:"Next",previousText:"Previous",hrefTextPrefix:"",hrefTextSuffix:"",theme:"chegg-std-theme",selectOnClick:!1,initialize:function(){this.registerListeners()},render:function(){var t=(this.currentPage-1)*this.itemsPerPage+1,s=t-1+this.itemsPerPage;s=s>this.totalItemsNum?this.totalItemsNum:s;var i=this.totalItemsNum/this.itemsPerPage;this.limitMaxPages&&this.limitMaxPages<i&&(this.totalItemsNum=this.limitMaxPages*this.itemsPerPage),this.$el&&(e(this.$el).pagination({items:this.totalItemsNum,itemsOnPage:this.itemsPerPage,currentPage:this.currentPage,displayedPages:this.displayedPages,edges:this.pageNumAtEdges,nextText:this.nextText,prevText:this.previousText,hrefTextPrefix:this.hrefTextPrefix,hrefTextSuffix:this.hrefTextSuffix,selectOnClick:this.selectOnClick,showPageDesc:this.showPageDesc,cssStyle:this.theme}),this.showPageDesc&&e(this.$el).find("ul").before('<div class="item-desc">Showing <span class="startNum">'+t+'</span> - <span class="endNum">'+s+'</span><span class="of"> of </span><span class="totalItemsNum">'+this.totalItemsNum+"</span></div>"),e(this.$el).find("ul li").has(".prev").addClass("prev").end().has(".next").addClass("next"))},registerListeners:function(){this.Eggshell.listen("totalItemsNum",function(e,t){this.throwNumError("totalItemsNum",t),this.totalItemsNum=t}),this.Eggshell.listen("itemsPerPage",function(e,t){this.throwNumError("itemsPerPage",t),this.itemsPerPage=t}),this.Eggshell.listen("currentPage",function(e,t){this.throwNumError("currentPage",t),this.currentPage=t}),this.Eggshell.listen("displayedPages",function(e,t){this.throwNumError("displayedPages",t),this.displayedPages=t}),this.Eggshell.listen("pageNumAtEdges",function(e,t){this.throwNumError("pageNumAtEdges",t),this.pageNumAtEdges=t}),this.Eggshell.listen("nextText",function(e,t){this.nextText=t}),this.Eggshell.listen("previousText",function(e,t){this.previousText=t}),this.Eggshell.listen("hrefTextPrefix",function(e,t){this.hrefTextPrefix=t}),this.Eggshell.listen("hrefTextSuffix",function(e,t){this.hrefTextSuffix=t}),this.Eggshell.listen("theme",function(e,t){this.theme=t}),this.Eggshell.listen("showPageDesc",function(e,t){this.showPageDesc=t}),this.Eggshell.listen("selectOnClick",function(e,t){this.selectOnClick=t}),this.Eggshell.listen("limitMaxPages",function(e,t){this.limitMaxPages=t}),this.Eggshell.listen("render",function(e,t){this.render()})},throwNumError:function(e,t){if(!t||"number"!=typeof t)throw"Invalid "+e},destory:function(){e(this.$el).pagination("destroy")}})),n.define("C.Eggshell.window.resize.tracker",{inputs:{"trigger resize":{payload:null}},outputs:["resize"],singleton:!0},function(){this.resize=function(){var t=e(window).width(),s=e(window).height();this.viewportWidth&&this.viewportHeight&&this.viewportWidth==t&&this.viewportHeight==s||(this.viewportWidth=t,this.viewportHeight=s,this.Eggshell.trigger("resize",{width:t,height:s}))},e(window).on("resize",e.proxy(function(e){this.resize()},this)),n.find(this).on("trigger resize",function(){this.resize()},this)}),C.resource.add("C.Eggshell.text.ellipses.more-link","Show more"),n.define("C.Eggshell.text.ellipsis",{inputs:["set text","set lines","get text","change more link copy","display more link","display more link with quotes","always display more link"],outputs:["original text","redrawn","read more clicked"]},r.View.extend({text:null,lines:1,textNodes:[],initialize:function(){this.moreText=C.resource.fetch("C.Eggshell.text.ellipses.more-link"),this.render(),this.registerListeners()},destroy:function(){if(this.textNodes)for(;this.textNodes.length;){var e=this.textNodes.pop();e.unwatch&&e.unwatch()}},render:function(t){if(this.text){var s=this.lines;this.$el.empty();var i=e("<div>").appendTo(this.$el);if(t){if(t&&"a.more-link"==t.after){var r="#";t.link&&(r=t.link);var n=this.text+' <a href="'+r+'" class="more-link">'+this.moreText+"</a>";i.html(n),s++}else if(t&&"span.last-element"==t.after){var r="#";t.link&&(r=t.link);var n='<span class="start-quote"></span> '+this.text+' <span class="last-element"><span class="end-quote"></span> <a href="'+r+'" class="more-link">'+this.moreText+"</a></span>";i.html(n),s++}}else i.html(this.text);var o=this.$el.css("line-height");o&&"0px"!=o||(o=this.$el.css("font-size")),o=parseInt(o);var a=s*o,l={height:a,watch:!0};t&&(l=e.extend(l,t));var c=l.callback;l.callback=e.proxy(function(){e.isFunction(c)&&c.apply(this,arguments),this.Eggshell.trigger("redrawn",arguments)},this),i.addClass("truncated-container"),i.dotdotdot(l),i.css({"line-height":o+"px","max-height":a+"px",overflow:"hidden"}),this.textNodes.push(i)}},registerListeners:function(){this.Eggshell.listen("set text",function(e,t){if("undefined"!=typeof t&&null!=t||(t=""),!t||"string"!=typeof t)throw"Invalid text";this.text=t,this.render()}),this.Eggshell.listen("set lines",function(e,t){if(!t||"number"!=typeof t)throw"Invalid lines";this.lines=t,this.render()}),this.Eggshell.listen("get text",function(e,t){this.Eggshell.trigger("original text",this.text)}),this.Eggshell.listen("display more link",function(e,t){this.opts={after:"a.more-link",callback:function(e,t){0==e&&this.$(".more-link").hide()}},this.options.alwaysDisplayMoreLink&&(this.opts.callback=function(){}),t&&"string"==typeof t&&(this.opts.link=t),this.render(this.opts)}),this.Eggshell.listen("display more link with quotes",function(e,t){this.opts={after:"span.last-element",callback:function(e,t){0==e&&this.$(".more-link").hide()}},this.options.alwaysDisplayMoreLink&&(this.opts.callback=function(){}),t&&"string"==typeof t&&(this.opts.link=t),this.render(this.opts)}),this.Eggshell.listen("change more link copy",function(e,t){if(!t||"string"!=typeof t)throw"Invald payload. needs to be string";this.moreText=t}),this.Eggshell.listen("always display more link",function(e,t){this.options.alwaysDisplayMoreLink=!0}),this.Eggshell.listen("destroy",this.destroy)},events:{"click .more-link":"triggerShowMore"},triggerShowMore:function(t){return"#"!=e(t.currentTarget).attr("href")?void this.Eggshell.trigger("read more clicked"):(t.preventDefault(),t.stopPropagation(),this.$el.html(this.$("div").triggerHandler("originalContent")),this.$el.find(".more-link").hide(),void this.Eggshell.trigger("read more clicked"))}})),C.utility.bookCover=function(t,i,r){r=e.extend({cart:!1,readNowCornerVersion:!1,isOverdue:!1,overdueCornerVersion:!1},r),t=e.extend({},t);var n="",o="",a="",l="",c="";switch(i){case 1:case 2:n=t.imgThumb,l="small",c="tiny";break;case 3:n=t.imgSmall,l="small",c="small";break;case 4:n=t.imgMedium,l="small",c="medium";break;case 5:n=t.imgLarge,l="large",c="large"}if(n&&0!==n.indexOf("http")&&-1===n.indexOf(C.global.coversBaseUrl)&&(n=C.global.coversBaseUrl+n.replace(/^\//,"")),r.hasOwnProperty("type")&&r.type==C.utility.bookCover.tbsType){a='<div class="tbs-book-cover '+c+'"> ';var h;switch(!0){case null!=n:h='<img class="tbs-book-cover-img" src="'+n+'" onerror="this.src=\''+C.global.errorImage+"'\" />";break;default:h='<span class="tbs-title">Solutions</span>'}a+=h,a+='<div class="tbs-bottom-line">by </div></div>'}else{var d="";if(r.cart&&(d="id=book-in-review"),C.utility.isMobile()){var u="";if(s.isObject(r)){switch(r.isSample===!0&&(u="sample "),!0){case r.isOverdue===!0:u+="overdue";break;case r.isRwyw===!0:u+="rwyw";break;case r.isETextbook===!0:u+="etextbook"}"small"==l&&(u+=l)}a='<div class="book-cover '+u+'"><img src="'+n+'" onerror="this.src="'+C.global.errorImage+'"></div>'}else{var p="";"undefined"!=typeof r&&null!==r&&("undefined"!=typeof r.isReadNow&&r.isReadNow?(o='<div class="read-now-strip"></div>',"undefined"!=typeof r.readNowCornerVersion&&r.readNowCornerVersion&&(o='<div class="read-now-corner '+l+'"></div>')):"undefined"!=typeof r.isOverdue&&r.isOverdue?(o='<div class="overdue-strip"></div>',"undefined"!=typeof r.overdueCornerVersion&&r.overdueCornerVersion&&(o='<div class="overdue-corner '+l+'"></div>')):"undefined"!=typeof r.isRwyw&&r.isRwyw?o="undefined"!=typeof r.stripVersion&&r.stripVersion?'<div class="img-courtesy-etextbook-overlay"></div>':'<div class="instant-access">Includes free <span>Instant Access</span></div>':"undefined"!=typeof r.showRwywOverlay&&r.showRwywOverlay&&(p='<div id="rwyw-book-overlay-100" class="icn icon-chegg-etb-courtesy"/>')),a="<div "+d+' class="book-img-'+i,r&&r.noBoxShadow&&(a+=" noBoxShadow"),a+='"><img class="book-cover" src="'+n+'" onerror="this.src=\''+C.global.errorImage+"'\" />",a+=p+o+"</div>"}}return a},C.utility.bookCover.dropdown=1,C.utility.bookCover.thumb=2,C.utility.bookCover.small=3,C.utility.bookCover.medium=4,C.utility.bookCover.large=5,C.utility.bookCover.bookType="book",C.utility.bookCover.tbsType="tbs",n.define("C.common.search",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"jquery",filters:"object",token:"object"}},"render with profile id":{payload:"string"},renderTabs:{payload:{ajaxEndpoint:"object",target:"jquery",filters:"object",token:"object"}},"hide results":{payload:null},"show a single segway":{payload:"string"},"show no segways":{payload:null},"show no categories":{payload:null},"show no bottom content":{payload:null},"set width to size of input field":{payload:null},"position above target":{payload:null},"set query":{payload:"string"},"set bookstore isbns":{payload:{bookstoreIsbns:"object"}}},outputs:{"search result item clicked":{payload:"object"}},strict:!1},function(){var t=r.View.extend({initialize:function(){n.find(this).on("render",this.render).on("render with profile id",this.renderWithProfileId,this).on("hide results",this.hideResults,this).on("show a single segway",this.showSingleSegway,this).on("show no segways",this.showNoSegways).on("show no bottom content",this.showNoBottomContent).on("show no categories",this.showNoCategories).on("set width to size of input field",this.setWidthToSizeOfInputField).on("position above target",this.positionAboveTarget).on("set bookstore isbns",this.setBookstoreIsbns,this).on("set query",this.setQuery,this).on("override action url",this.overrideActionUrl,this).on("disable all overrides",this.disableAllOverrides,this).on("open results in new tab",this.setOpenResultsInNewTab,this).on("show merged results",this.setMergedResults)},setMergedResults:function(e,t){this.mergedResults=!0,this.overriddenDisplayOrder=["tbs-book","questions","tbs-problem"]},overrideActionUrl:function(e,t){this.overridenActionUrl=t},disableAllOverrides:function(){this.overridenActionUrl=null},setOpenResultsInNewTab:function(e,t){this.openResultsInNewTab=t},renderWithProfileId:function(t,s){!this.mergedResults||"questions-auto"!==s.profile&&"tbs-book-auto"!==s.profile||(s.profile="federated-chegg-study-auto"),e.extend({target:null},s),this.layout&&(n.find(this.layout).destroy(),s.target&&(e(s.target).unbind(),"undefined"!=typeof e(s.target.prev())&&e(s.target.prev()).unbind())),n.create("C.search.configuration").on("config values for profile id",function(e,t){var i=t.profile;"federated-chegg-study-auto"===i.odinProfileId&&this.mergedResults&&(t.profile.displayOrder=this.overriddenDisplayOrder),this.overridenActionUrl&&!this.mergedResults&&(t.profile.actionUrl=this.overridenActionUrl),this.query&&(t.query=this.query),this.bookstoreIsbns&&(t.bookstoreIsbns=this.bookstoreIsbns),this.layout=n.create(i.layout,{el:this.$el,config:t,displayOptions:s.displayOptions}),this.openResultsInNewTab&&this.layout.trigger("open results in new tab",!0),this.layout.trigger("render",{target:s.target}),i.immuneToDestroy&&n.immuneToDestroyAll(this.layout)},this).trigger("get config by profile id",s.profile)},render:function(t,s){if(this.layout&&(e(s.target).unbind(),"undefined"!=typeof e(s.target.prev())&&e(s.target.prev()).unbind(),n.find(this.layout).destroy()),"undefined"!=typeof s.filters.type&&"group"==s.filters.type){var i="";switch(s.ajaxEndpoint){case"/_ajax/search/globallist":i=0===s.tbscount?"textbooks-auto":"federated-auto";break;case"/_ajax/search/tbsserp":i="tbs-book-auto";break;case"/_ajax/search/qnaserp":i="questions-auto";break;case"/_ajax/search/tutors/subjects":i="tutors-auto";break;default:i="federated-auto"}return this.renderWithProfileId(null,{target:s.target,profile:i,displayOptions:s.filters}),!1}this.layout=n.create("C.common.search.list",{el:this.$el}),this.openResultsInNewTab&&this.layout.trigger("open results in new tab",!0),this.layout.trigger("render",s),n.immuneToDestroyAll(this.layout)},hideResults:function(){this.layout&&this.layout.trigger("hide")},showSingleSegway:function(e,t){this.layout&&this.layout.trigger("show a single segway",t)},showNoSegways:function(e,t){this.layout&&this.layout.trigger("show no segways",t)},showNoBottomContent:function(e,t){this.layout&&this.layout.trigger("show no bottom content",t)},showNoCategories:function(e,t){this.layout&&this.layout.trigger("show no categories",t)},setWidthToSizeOfInputField:function(e,t){this.layout&&this.layout.trigger("set width to size of input field",t)},positionAboveTarget:function(e,t){this.layout&&this.layout.trigger("position above target",t)},setQuery:function(e,t){this.query=t.query},setBookstoreIsbns:function(e,t){this.bookstoreIsbns=t}});return t}()),C("search"),C.search.config={filters:{},mobile_filters:{all:{title:"All matches",profileId:"mobile-federated-book-srp",queryIntentProfileId:"mobile-federated-question-srp"},books:{title:"Find Books",profileId:"mobile-textbooks-srp"},tbs:{title:"Textbook solutions",profileId:"mobile-tbs-book-srp",queryIntentProfileId:"mobile-tbs-problem-srp",filters:{"tbs-problem":{title:"Problems",profileId:"mobile-tbs-problem-srp"},"tbs-book":{title:"Books",profileId:"mobile-tbs-book-srp"}}},qna:{title:"Expert Q&A",profileId:"mobile-questions-srp"},tutors:{title:"Online Tutors",profileId:"mobile-tutors-srp"}},mobile_filters_intent:{all:{title:"All matches",profileId:"mobile-federated-srp"},books:{title:"Find Books",profileId:"mobile-textbooks-srp"},tbs:{title:"Textbook solutions",profileId:"mobile-tbs-srp",filters:{"tbs-problem":{title:"Problems",profileId:"mobile-tbs-problem-srp"},"tbs-book":{title:"Books",profileId:"mobile-tbs-book-srp"}}},qna:{title:"Expert Q&A",profileId:"mobile-questions-srp"},tutors:{title:"Online Tutors",profileId:"mobile-tutors-srp"}},profiles:{"textbooks-auto":{odinProfileId:"textbooks-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},displayOrder:["textbooks"],suggestionOrder:["books","tbs","qna","tutors"],actionUrl:"/books"},"textbooks-srp":{odinProfileId:"textbooks-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.singlefed",advertising:"chegg_web/chegg_SS/chegg_ss_searchresults",title:"Books",iconClass:"books-icon",filters:"true",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["infobox","textbooks"],actionUrl:"/books"},"bookstore-srp":{odinProfileId:"textbooks-srp",layout:"C.search.serp_bookstore",type:"serp",sublayout:"",advertising:"",title:"Books",iconClass:"books-icon",filters:"true",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["infobox","textbooks"],actionUrl:"/books"},"tbs-book-auto":{odinProfileId:"tbs-book-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},displayOrder:["tbs-book"],suggestionOrder:["tbs","qna","tutors","books"],actionUrl:"/textbook-solutions"},"federated-tbs-srp":{odinProfileId:"federated-tbs-problem-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Textbook solutions",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-book","tbs-problem"],actionUrl:"/textbook-solutions"},"study-srp":{profile:"study-srp",odinProfileId:"study-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-problem","questions","tbs-book"],actionUrl:"/study"},"study-fused-basic-srp":{profile:"study-fused-basic-srp",odinProfileId:"study-fused-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","study","tbs-book"],actionUrl:"/study"},"study-fused-filters-srp":{profile:"study-fused-filters-srp",odinProfileId:"study-fused-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","study","tbs-book"],actionUrl:"/textbook-solutions"},"study-fused-filters-qna-srp":{profile:"study-fused-filters-srp",odinProfileId:"questions-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","questions"],actionUrl:"/textbook-solutions"},"study-fused-filters-tbs-srp":{profile:"study-fused-filters-srp",odinProfileId:"federated-tbs-problem-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-problem","tbs-book"],actionUrl:"/textbook-solutions"},"tbs-srp":{odinProfileId:"tbs-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.singlefed",advertising:"SERP_TextbookSolutions_1",title:"Textbook solutions",iconClass:"tbs-icon",filters:"true",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-book"],actionUrl:"/textbook-solutions"},"tbs-book-srp":{odinProfileId:"tbs-book-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.singlefed",advertising:"SERP_TextbookSolutions_1",title:"Textbook solutions",iconClass:"tbs-icon",filters:"true",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-book"],actionUrl:"/textbook-solutions"},"tbs-problem-srp":{odinProfileId:"tbs-problem-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.singlefed",advertising:"SERP_TextbookSolutions_1",title:"Textbook solutions",iconClass:"tbs-icon",filters:"true",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-problem"],actionUrl:"/textbook-solutions"},"questions-auto":{odinProfileId:"questions-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},displayOrder:["questions"],suggestionOrder:["qna","tbs","tutors","books"],actionUrl:"/questions-and-answers"},"questions-srp":{odinProfileId:"questions-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.singlefed",advertising:"SERP_TextbookSolutions_2",title:"Expert Q&A",iconClass:"qna-icon",filters:"true",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","questions"],actionUrl:"/questions-and-answers"},"federated-auto":{odinProfileId:"federated-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},displayOrder:["textbooks","tbs-book"],suggestionOrder:["books","tbs","qna","tutors"],actionUrl:"/federated"},"federated-srp":{odinProfileId:"federated-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_Tutors",title:"All matches",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["infobox","textbooks","tbs-book"],actionUrl:"/federated"},"federated-book-srp":{odinProfileId:"federated-book-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.booksfed",advertising:"SERP_Tutors",title:"All matches",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["infobox","textbooks","tbs-book"],actionUrl:"/federated"},"federated-question-srp":{odinProfileId:"federated-question-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.qnafed",advertising:"SERP_Tutors",title:"All matches",searchData:{chgsec:"searchsection",
chgsubcomp:"serp"},displayOrder:["infobox","tbs-problem","questions"],actionUrl:"/federated"},"federated-chegg-study-auto":{odinProfileId:"federated-chegg-study-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},actionUrl:{textbooks:"/textbook-solutions",questions:"/questions-and-answers","default":"/textbook-solutions"}},"tutors-srp":{odinProfileId:"",identifier:"tutors-fake-profile",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.singlefed",advertising:"SERP_Tutors",title:"Tutors",iconClass:"tutors-icon",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tutors"],actionUrl:"/tutors"},"tutors-auto":{odinProfileId:"",identifier:"tutors-fake-profile",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},suggestionOrder:["tutors","qna","tbs","books"],actionUrl:"/tutors"},"textbooks-seo-author":{odinProfileId:"textbooks-seo-author",layout:"C.search.serp.singlefed",type:"serp",iconClass:"books-icon",filters:"false",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["textbooks"],actionUrl:"/textbooks"},"mobile-textbooks-srp":{odinProfileId:"textbooks-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"books",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["textbooks"],actionUrl:"/books"},"mobile-federated-book-srp":{odinProfileId:"federated-book-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"all",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["textbooks","tbs-book","questions","tutors"],actionUrl:"/federated"},"mobile-federated-question-srp":{odinProfileId:"federated-question-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"all",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["tbs-problem","questions"],actionUrl:"/federated"},"mobile-questions-srp":{odinProfileId:"questions-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"qna",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["questions"],actionUrl:"/questions-and-answers"},"mobile-tbs-problem-srp":{odinProfileId:"tbs-problem-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"tbs",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["tbs-problem"],actionUrl:"/textbook-solutions"},"mobile-tbs-srp":{odinProfileId:"tbs-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"tbs",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["tbs-book","tbs-problem"],actionUrl:"/textbook-solutions"},"mobile-tbs-book-srp":{odinProfileId:"tbs-book-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"tbs",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["tbs-book"],actionUrl:"/textbook-solutions"},"mobile-tutors-srp":{odinProfileId:"",layout:"C.search.serp_mobile",type:"serp",tabId:"tutors",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["tutors"],actionUrl:"/tutors"},"mobile-federated-srp":{odinProfileId:"federated-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"all",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["textbooks","tbs-book"],actionUrl:"/federated"}},entityMap:{textbooks:{title:"Textbooks",name:"Books",sectionClass:"books-results",iconClass:"books-icon",seeMore:"Books",seeMoreFull:"More Books",seeMoreUrlSuffix:"/books"},"tbs-book":{title:"Textbook Solutions",name:"Textbook Solutions",sectionClass:"tbs-results",iconClass:"tbs-icon",seeMore:"Textbook Solution Manuals",seeMoreFull:"More Textbook solutions",seeMoreUrlSuffix:"/study"},"tbs-problem":{title:"Textbook Solutions",name:"Textbook Solutions",sectionClass:"tbs-problem-results",iconClass:"tbs-icon",seeMore:"Textbook Solutions",seeMoreFull:"More Textbook solutions",seeMoreUrlSuffix:"/study"},questions:{title:"Expert Q&A",name:"Expert Q&A",sectionClass:"qna-results",iconClass:"qna-icon",seeMore:"Expert Q&A",seeMoreFull:"More Expert Q&A",seeMoreUrlSuffix:"/study"},tutors:{title:"Tutors",name:"Tutors",sectionClass:"tutor-results",iconClass:"tutors-icon",seeMore:"Tutors",seeMoreFull:"More Tutors"},study:{title:"Study results",name:"study",sectionClass:"study-results",iconClass:"study-icon",seeMore:"Study results",seeMoreFull:"More Expert Q&A",seeMoreUrlSuffix:"/study"}},suggestionMap:{books:{partialUrl:"/books",type:"Books"},tbs:{partialUrl:"/study",type:"Textbook Solutions"},qna:{partialUrl:"/study",type:"Q&A"},tutors:{partialUrl:"/tutors",type:"Tutors"}}},n.define("C.search.ajax",{inputs:["get search result","set config values"],output:["search result","failed search attempt"]},function(t){this.config=null,this.ajaxUrl=C.global.cheggSiteSecureUrl+"_ajax/federated/search",this.trackId=null,this.strackId=null,this.is_mobile=t&&t.mobile,this.getAjaxData=function(e){var t,s=this.config.profile,i=s.searchData;i.profile=s.odinProfileId;var r=e.extraData?e.extraData:{},n=r.page?r.page:1;if("undefined"!=typeof this.config.profile.type&&"auto-suggest"!==this.config.profile.type&&(i["page-number"]=n),"undefined"!=typeof i.state&&i.state){var o=C.utility.getCookie("stid");i.state=o?o:"NoState"}return this.trackId=r.trackId,this.strackId=r.strackId,t={query:e.query,trackid:this.trackId,strackid:this.strackId,search_data:JSON.stringify(i),token:C.global.csrfToken},this.is_mobile&&(t.m_dot=1),t},this.getTrackedUrl=function(e){return e&&(e+="?trackid="+this.trackId+"&strackid="+this.strackId),e},this.setConfigValues=function(e,t){if("object"!=typeof t)throw"Expected Config type is object, got "+typeof t;this.config=t},this.getSearchResult=function(t,s){if("object"!=typeof s)throw"Expected payload type is object, got"+typeof query;var i=this.getAjaxData(s),r=s.extraData?s.extraData:{};return r.page?parseInt(r.page):1,this.query=s.query,""==this.config.profile.odinProfileId?void this.getTutorsResults(s):void e.ajax({url:this.ajaxUrl,type:"get",dataType:"json",data:i,xhrFields:{withCredentials:!0},context:this,success:function(t){if(null==t)n.find(this).trigger("failed search attempt",{noResults:!0,dataNull:!0});else{var s=!0,i=!1,r=0,o=0,a=["textbooks","tbs-problem","tbs-book","questions","study"];for(var l in t)if(t.hasOwnProperty(l)&&null!==t[l]&&e.inArray(l,a)>-1){s=!1,o++;var c=t[l].responseContent.docs;if(0==c.length)r++;else if(this.trackId&&this.strackId){for(var h in c){var d=this.getTrackedUrl(c[h].url);if(c[h].url=d,"undefined"!=typeof c[h].tbsUrl){var u=this.getTrackedUrl(c[h].tbsUrl);c[h].tbsUrl=u}}t[l].responseContent.docs=c}}r==o&&(i=!0),i||s?t.infobox&&0!=t.infobox.responseContent.docs.length?n.find(this).trigger("failed search attempt",t):n.find(this).trigger("failed search attempt",{noResults:!0}):n.find(this).trigger("search result",t)}},error:function(e){n.find(this).trigger("failed search attempt",{noResults:!0,apiError:!0})}})},this.getTutorsResults=function(t){var s=t.extraData?t.extraData:{},i=s.trackId,r=s.strackId,o=s.page?s.page:1,a=s.source?s.source:"",l=s.count?s.count:void 0;e.ajax({url:C.global.cheggSiteSecureUrl+"_ajax/search/tutors/subjects",type:"get",dataType:"json",data:{query:t.query,trackid:i,strackid:r,page:o,count:l,size:10,source:a,token:C.global.csrfToken},context:this,success:function(e){if(null==e||0==e.count)n.find(this).trigger("failed search attempt",{noResults:!0,dataNull:!0});else{if(e.trackId&&e.strackId)for(var t in e.searchResult.tutors){var s=this.getTrackedUrl(e.searchResult.tutors[t].url);e.searchResult.tutors[t].url=s}n.find(this).trigger("search result",e)}},error:function(e){n.find(this).trigger("failed search attempt",{noResults:!0,apiError:!0})}})},this.setListeners=function(){n.find(this).on("get search result",this.getSearchResult,this).on("set config values",this.setConfigValues,this)},this.initialize=function(){this.setListeners()},this.initialize()}),n.define("C.search.configuration",{inputs:["get config by profile id","get filters","get mobile filters config"],output:["config values for profile id","filters list"]},function(){this.checkAndApplyOverrides=function(e,t){var s=null;if(s&&"undefined"!==s[t]){var i=s[t];for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e},this.getConfigByProfileId=function(e,t){if("string"!=typeof t)throw"profile Id passed must be a string";var s=this.configData.profiles;if("undefined"==typeof s[t])throw"no config found for provided profile id";var i={},r=s[t],o={},a={};r.filters&&(i=r.filters),this.configData.entityMap&&(o=this.configData.entityMap),this.configData.suggestionMap&&(a=this.configData.suggestionMap),r=this.checkAndApplyOverrides(r,t);var l={profile:r,filters:i,entityMap:o,suggestionMap:a};n.find(this).trigger("config values for profile id",l)},this.getFilters=function(){return this.configData.filters},this.getMobileFilters=function(e,t){var s=this.configData.mobile_filters_intent;t(s)},this.loadAndValidateConfig=function(){if("undefined"==typeof C.search||"undefined"==typeof C.search.config||"object"!=typeof C.search.config)throw"Error loading config, please check config.js";if(this.configData=C.search.config,"undefined"==typeof this.configData.profiles)throw"Failed to load profiles from config file";if("undefined"==typeof this.configData.filters)throw"Failed to load filters from config file"},this.setListeners=function(){n.find(this).on("get config by profile id",this.getConfigByProfileId,this).on("get filters",this.getFilters).on("get mobile filters config",this.getMobileFilters)},this.initialize=function(){this.setListeners(),this.loadAndValidateConfig()},this.initialize()}),n.define("C.search.trackid",{inputs:["get track ids","page refreshed","interacting with autosuggest"],output:["track ids"]},function(){this.trackId=null,this.strackId=null,this.pageRefreshed=!1,this.generateTrackId=function(){var e=Math.abs(4294967295*Math.random()<<0).toString(16);return("000000000"+e).slice(-8)},this.pageRefreshed=function(){this.trackId=this.generateTrackId(),this.pageRefreshed=!0},this.interactingWithAutosuggest=function(){this.pageRefreshed&&(this.trackId=this.generateTrackId(),this.strackId=this.generateTrackId(),this.pageRefreshed=!1)},this.getTrackIds=function(){var e={trackid:this.trackId,strackid:this.strackId};n.find(this).trigger("track ids",e)},this.loadInitialTrackIdValues=function(){this.strackId=this.generateTrackId(),this.trackId=this.generateTrackId()},this.setListeners=function(){n.find(this).on("get track ids",this.getTrackIds,this).on("page refreshed",this.pageRefreshed,this).on("interacting with autosuggest",this.interactingWithAutosuggest,this)},this.initialize=function(){this.setListeners(),this.loadInitialTrackIdValues()},this.initialize()}),n.define("C.search.autosuggest",{inputs:["render","open results in new tab","show no segways","show a single segway","show no categories","show no bottom content","set width to size of input field","position above target"],output:[]},function(){var t=r.Model.extend({setData:function(e){if(this.set("searchResults",e),"tutors-fake-profile"===this.config.profile.identifier){this.set("resultSet",e.searchResult);var t=C.utility.getParams(),s=t.no_redirect;e.hasExactMatch&&!s?this.set("urlOverride",this.getTutorsUrl(e.hasExactMatch)):this.set("urlOverride",null)}else this.combineSearchResults()},getTutorsUrl:function(e){var t=e.url,s=C.global.cheggSiteSecureUrl+"tutors/"+t+"-online-tutoring/";return s},combineSearchResults:function(){for(var e=Array(),t=this.get("searchResults"),s=this.config.profile.displayOrder,i=0;i<s.length;i++){var r=s[i];if(t.hasOwnProperty(r)&&null!==t[r]){var n=t[r].responseContent.docs;if(n.length>0){e[r]=Array();for(var o=0;o<n.length;o++)e[r].push(n[o])}}}this.set("resultSet",e)},setConfig:function(e){this.config=e},setDisplayOptions:function(e){this.set("displayOptions",e||{})}}),i=r.View.extend({initialize:function(s){if("undefined"==typeof s.config)throw"Config needs to be passed to the layouts, for it to function";this.config=s.config,this.model=new t,this.model.setConfig(this.config),this.model.setDisplayOptions(s.displayOptions),this.ajaxComponent=n.create("C.search.ajax").on("search result",e.proxy(function(e,t){this.render(t)},this)).on("failed search attempt",e.proxy(function(e,t){this.renderError(t)},this)).trigger("set config values",this.config),this.setListeners(),this.fullWidth=!1,this.singleSegway=null,this.searchResultFormatType=""},setTrackIds:function(){n.find("C.search.trackid").on("track ids",e.proxy(function(e,t){this.trackId=t.trackid,this.strackId=t.strackid},this)).trigger("get track ids")},getEntityInfoByType:function(e){var t=this.config.entityMap;if("undefined"!=typeof t[e])return t[e];throw"Result type missing. Define "+e+"in config.js entityMap"},setListeners:function(){n.find(this).on("render",this.setup,this).on("update",this.load,this).on("show no segways",this.showNoSegways,this).on("show a single segway",this.showASingleSegway,this).on("show no categories",this.showNoCategories,this).on("show no bottom content",this.showNoBottomContent,this).on("set width to size of input field",this.setWidthToSizeOfInputField,this).on("position above target",this.positionAboveTarget,this).on("open results in new tab",this.setOpenResultsInNewTab,this)},setOpenResultsInNewTab:function(e,t){this.openResultsInNewTab=t},showNoSegways:function(e,t){this.hideSegways=!0},showASingleSegway:function(e,t){this.hideSegways=!1;var s="single-";0===t.indexOf(s)?this.singleSegway=t.substring(s.length):this.singleSegway=t},showNoCategories:function(e,t){this.hideCategories=!0},showNoBottomContent:function(e,t){this.hideButtomContent=!0},setWidthToSizeOfInputField:function(e,t){this.fullWidth=!0},positionAboveTarget:function(e,t){this.positionAboveTarget=!0},goToSearchPage:function(e,t){if(n.find("C.global.header.rightsection.usermenu").trigger("hide menu"),n.find("C.global.header.searchbox").trigger("collapse search box"),this.model.get("urlOverride"))return void(location.href=this.model.get("urlOverride"));var s=this.getSERPUrl(),i=encodeURIComponent(e),r=0;this.model.get("resultSet")&&(r=this.model.get("resultSet").length);var o="";this.trackId||this.setTrackIds();var a=C.global.cheggSiteUrl+"search/"+i+s,l="?trackid="+this.trackId+"&strackid="+this.strackId+"&event="+t+o;this.openResultsInNewTab?window.open(a+l,"_blank"):C.utility.navigate(a+l)},getSERPUrl:function(){var e=this.config.profile.actionUrl;if("string"!=typeof e){var t=this.model.get("searchResults")?this.model.get("searchResults").intents:null,s="";t&&(s=t[0].name),e="undefined"!=typeof e[s]?e[s]:"undefined"!=typeof e["default"]?e["default"]:"/federated"}return e},setup:function(t,s){this.target=e(s.target),this.target.prev().click(e.proxy(function(){return this.goToSearchPage(this.target.val(),"button_submit"),!1},this)),this.target.next().click(e.proxy(function(e){this.resetSearch(e,this.target)},this)),this.target.keyup(e.proxy(function(e){this.onKeyUp(e)},this)),this.target.click(e.proxy(function(e){this.onKeyUp(e)},this)),this.target.blur(e.proxy(function(e){this.onTextboxBlur(e,this.target)},this)),this.target.bind("paste",e.proxy(function(t){var s=e(t.target).val();s.length>0&&e(t.target).next().show(),s.length>=2&&this.load({query:s})},this))},resetSearch:function(e,t){e.preventDefault(),t.val(""),t.next().hide(),this.$currentSelectedItem=null},onKeyUp:function(t){n.find("C.search.trackid").trigger("interacting with autosuggest");var s=e(t.target).val();40==t.keyCode?(this.doNextSelection(t),t.preventDefault()):38==t.keyCode?(this.doPrevSelection(t),t.preventDefault()):27==t.keyCode?this.hide():13==t.keyCode?(this.onSelectionClick(t),this.$currentSelectedItem=null):46==t.keyCode||8==t.keyCode?s.length<3?this.hide():0==s.length?e(t.target).next().hide():this.load({query:s}):(s.length>0&&e(t.target).next().show(),s.length>=2&&this.load({query:s}))},onTextboxBlur:function(e,t){this.mouseInDropdown||t.is(":focus")||(this.hide(),this.$currentSelectedItem=null)},load:function(e){this.model.set("query",e.query),this.setTrackIds(),this.ajaxComponent.trigger("get search result",{query:e.query,extraData:{source:"group",trackId:this.trackId,strackId:this.strackId}})},createHandleResize:function(){this.resizeTrackerNS||(this.resizeTrackerNS=n.create("C.Eggshell.window.resize.tracker"),this.resizeTrackerNS.on("resize",this.handleResize,this))},renderSearchResults:function(t){var i=0;for(var r in t){var o=this.getEntityInfoByType(r),a=t[r],l=this.model.get("displayOptions"),c="up"===l.variant,h=l.count;h&&h>0&&(a=a.slice(0,Math.min(a.length,h))),a=c?a.reverse():a,s.each(a,function(t,s){"undefined"!=typeof t.url&&(t.url+=this.getTrackUrl(++i),t.url+="&event=click_submit",t.searchBy=this.model.get("query")),"tutors-fake-profile"===this.config.profile.identifier&&(t.template=t.component);var r=e('<li class="item-result "></li>');0==s&&this.hideCategories!==!0?(this.$searchList.append(e('<li class="category"><div class="category-name"><span>'+o.name+"</span></div></li>")),r.addClass("first"),n.create(t.template,{el:r.appendTo(this.$searchList),query:this.model.get("query")}).trigger("render",t)):n.create(t.template,{el:r.appendTo(this.$searchList),query:this.model.get("query")}).trigger("render",t)},this)}},render:function(t){this.setTrackIds(),this.model.setData(t);var s=this.model.get("resultSet");this.$el.find(".searchList").remove(),this.$el.append(e('<ul class="searchList" tabindex="1"></ul>')),this.$el.addClass(this.searchResultFormatType),this.$searchList=this.$el.find(".searchList"),this.positionAboveTarget===!0?(this.renderSearchResults(s),this.getSearchCategories()):(this.getSearchCategories(),this.renderSearchResults(s)),this.searchListBottomContent&&e(this.searchListBottomContent).appendTo(this.$searchList),this.createHandleResize(),this.addBottomContent(),this.show(),this.searchListHeight=this.$searchList.height(),this.handleResize()},addBottomContent:function(){if(this.hideButtomContent!==!0){var e="?trackid="+this.trackId+"&strackid="+this.strackId,t=encodeURIComponent(this.model.get("query")),s="/search/"+t+this.getSERPUrl()+"/"+e,i=this.openResultsInNewTab?'target="_blank"':"";if(this.model.get("urlOverride")&&(s=this.model.get("urlOverride")+e),"/questions-and-answers"==this.getSERPUrl())var r='<a href="'+s+'&event=filter_submit" class="view-all-link qna-view-all"'+i+'>View all results</a><a class="post-new-question" data-noajax="1" href="/study/qa/post"'+i+'><span class="post-question-icon"></span><span class="post-question-label">Post a new question</span></a>';else var r='<a href="'+s+'&event=filter_submit" class="view-all-link"'+i+">View all results</a>";this.setSearchListBottomContent({html:r})}},getTrackUrl:function(e){return"?trackid="+this.trackId+"&strackid="+this.strackId+"&autosuggest=1&ii="+e+"&uqry="+this.model.get("query")},getSearchCategories:function(){if(this.hideSegways!==!0){var e=this.model.get("query"),t="?trackid="+this.trackId+"&strackid="+this.strackId,s=encodeURIComponent(e),i=this.config.suggestionMap,r=this.config.profile.suggestionOrder,n=[];for(var o in r){var a=i[r[o]];null!==this.singleSegway&&this.singleSegway!==r[o]||(a.url=C.global.liveSiteUrl+"search/"+s+a.partialUrl+t,"Tutors"===a.type&&this.model.get("urlOverride")&&(a.url=this.model.get("urlOverride")+t),n.push(a))}this.createCategory(n,e)}},getNoResultsMsg:function(){if("federated-chegg-study-auto"===this.config.profile.odinProfileId){var e=this.model.get("query");this.$searchList.append(this.noResultMsgTemplate({type:"textbook solutions",query:e}))}},renderCategories:function(t,s){for(var i=0;i<t.length;i++){var r=t[i].url;n.create("C.common.search.result.category",{el:e('<li class="item-result category-result"></li>').appendTo(this.$searchList)}).trigger("render",{url:r,searchBy:s,type:t[i].type})}},createCategory:function(t,s){t.length>0&&(this.positionAboveTarget===!0?(this.$searchList.append(e('<li class="searchDivider"></li>')),this.renderCategories(t,s)):(this.renderCategories(t,s),this.$searchList.append(e('<li class="searchDivider"></li>'))))},getLocation:function(){var e=window.location.pathname,t="";if(-1!==e.indexOf("/")){var s=e.split("/");t=s[3],"homework-help"==s[1]&&void 0!=s[2]&&(t="questions-and-answers"==s[2]?s[2]:"textbook-solutions"),"tutors"==s[1]&&(t="tutors")}return t},handleResize:function(){var t=this.target;this.$searchList=this.$el.find(".searchList"),this.searchListHeight>e(window).height()-100?this.$searchList.height(e(window).height()-100):this.$searchList.css({maxHeight:"566px"}),this.fullWidth?this.$searchList.width(t.outerWidth()):"left-aligned"===this.searchResultFormatType?this.$searchList.width(t.outerWidth()+130):this.$searchList.width(t.outerWidth()+115),this.$(".result-header, .result-sub-header, .result-detail").css("maxWidth",(.8*t.width()|0)+"px")},doNextSelection:function(t){var s=this.$el.find(".searchList").find(".item-result"),i=s.index(this.$el.find(".searchList").find(".selected"));if(s.removeClass("selected"),-1==i||i>=s.length-1)var r=s.eq(0).addClass("selected");else var r=s.eq(i+1).addClass("selected");this.changeSelection(r);var n=this.$currentSelectedItem.offset().top-82;0>n&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+n);var o=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+e(".chg-system-message").height()+e(".chg-header").height());o>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+o)},doPrevSelection:function(t){var s=this.$el.find(".searchList").find(".item-result"),i=s.index(this.$el.find(".searchList").find(".selected"));if(s.removeClass("selected"),-1==i||0===i)var r=s.eq(s.length-1).addClass("selected");else var r=s.eq(i-1).addClass("selected");this.changeSelection(r);var n=this.$currentSelectedItem.offset().top-82;0>n&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+n);var o=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+e(".chg-system-message").height()+e(".chg-header").height());o>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+o)},changeSelection:function(e){this.$currentSelectedItem=e},onMouseEnterBottomContent:function(e){this.$el.find(".searchList").find(".item-result").removeClass("selected")},renderError:function(t){t.noResults&&(this.$el.find(".searchList, .bottom-content").remove(),this.$el.append(e('<ul class="searchList"></ul>')),this.$searchList=this.$el.find(".searchList"),this.getSearchCategories(),this.getNoResultsMsg(),this.$searchList.height("100%"),this.$searchList.width(this.target.outerWidth()+115),this.show())},show:function(){this.$el.css({display:"block"})},hide:function(){this.$el.css({display:"none"})},setSearchListBottomContent:function(e){this.$(".bottom-content").remove(),e&&e.html&&this.$el.append(this.bottomListItemTemplate({opts:{content:e.html}})),this.fullWidth||this.$(".bottom-content").width(this.target.outerWidth()+115)},bottomListItemTemplate:s.template('<div class="bottom-content"><%= opts.content %></div>'),noResultMsgTemplate:s.template('<li class="no-results-msg">We can\'t find any <%- type %> for <span class="chg-suggest-term search-query"><%= query %>.</span> Please double check the ISBN or the spelling.</li>'),events:{"MSPointerDown .item-result a":"onSelectionClick","mouseover .item-result":"onMouseOverSelection","click .item-result a":"onSelectionClick","keydown .searchList":"onKeyUp","mouseenter .searchList, .bottom-content":"onMouseEnter","mouseleave .searchList":"onMouseLeave","mouseenter .bottom-content":"onMouseEnterBottomContent"},onMouseEnter:function(){this.mouseInDropdown||(this.mouseInDropdown=!0)},onMouseLeave:function(){this.mouseInDropdown&&(this.mouseInDropdown=!1),this.$currentSelectedItem=null,this.$el.find(".searchList").find(".item-result").removeClass("selected")},onMouseOverSelection:function(t){var s=e(t.target).closest(".item-result");s.length&&(this.$el.find(".searchList").find(".item-result").removeClass("selected"),s.addClass("selected"))},onSelectionClick:function(t){var s=this.target.attr("class").toString().split(" ");C.logger.doSessionLog({searchLocation:s[0]});var i=(this.model.get("trackId"),e(t.target).closest(".item-result"));if(i.length&&this.changeSelection(i),null==this.$currentSelectedItem)this.goToSearchPage(e(t.target).val(),"enter_submit");else{n.find("C.global.header.searchbox").trigger("collapse search box");var r=this.$currentSelectedItem.find("a").attr("href"),o=C.global.cheggSiteUrl;0!==r.indexOf("http://")&&0!==r.indexOf("https://")||(o=""),this.openResultsInNewTab?window.open(o+r,"_blank"):C.utility.navigate(o+r)}return this.hide(),!1}});return i}()),n.define("C.search.serp.booksfed",{inputs:["render"],output:[]},function(){var t=(r.Model.extend({initialize:function(e){}}),r.View.extend({initialize:function(t){n.find(this).on("render",this.render,this),n.find("C.search.trackid").on("track ids",e.proxy(function(e,t){this.trackId=t.trackid,this.strackId=t.strackid},this)).trigger("get track ids")},render:function(e,t){this.renderResults(t.results,t.config)},renderResults:function(t,s){var i="?trackid="+this.trackId+"&strackId="+this.strackId+"&event=filter_submit";this.$el.append(this.resultsTmpl({query:location.pathname.split("/")[2],tracking:i}));var r=t.textbooks.responseContent,o=t["tbs-book"].responseContent;if(0==r.numFound&&this.$(".books-results").hide(),0==o.numFound&&this.$(".tbs-results").hide(),"six_results"===C.global.tbResults&&r.docs.length>6)var a=6;else var a=r.docs.length;for(var l=1,c=0;a>c;c++){var h=e('<li class="item-result"></li>');r.docs[c].url+="&ii="+l++,r.docs[c].tbsUrl&&(r.docs[c].tbsUrl+="&ii="+l++);var d=r.docs[c].template;n.create(d,{el:h.appendTo(this.$(".book-list"))}).trigger("render",{results:r.docs[c],config:s})}for(var c=0;c<o.docs.length;c++){var h=e('<li class="item-result"></li>');o.docs[c].url+="&ii="+l++,n.create(o.docs[c].template,{el:h.appendTo(this.$(".tbs-list"))}).trigger("render",{results:o.docs[c],config:s})}},resultsTmpl:s.template('<div class="books-results"><span class="icon books-icon"></span><a href="/search/<%-query%>/books<%- tracking %>"><span class="container-title">Books </span></a><ul class="book-list"></ul><a href="/search/<%-query%>/books<%- tracking %>"><span class="more">More Books </span> </a></div><div class="tbs-results"><span class="icon tbs-icon"></span><a href="/search/<%-query%>/textbook-solutions<%- tracking %>"><span class="container-title">Textbook solutions </span></a><ul class="tbs-list"></ul><a href="/search/<%-query%>/textbook-solutions<%- tracking %>"><span class="more">More Textbook solutions </span></a></div>')}));return t}()),n.define("C.search.serp_bookstore",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"jquery",filters:"object",token:"object"}},"set query":{payload:"string"}},output:[],strict:!1},function(){var t=r.Model.extend({initialize:function(e){}}),i=r.View.extend({initialize:function(s){if("undefined"==typeof s.config)throw"Config needs to be passed to the layouts, for it to function";this.config=s.config,this.ajaxComponent=n.create("C.search.ajax").trigger("set config values",this.config),this.model=new t,n.find("C.search.trackid").on("track ids",e.proxy(function(e,t){this.trackId=t.trackid,this.strackId=t.strackid},this)).trigger("get track ids"),this.setListeners()},setListeners:function(){n.find(this).on("render",this.load,this)},load:function(){this.createLoadingIndicator();var e=this.separateBooks();this.getAjaxSearchResults(e)},separateBooks:function(){var e=this.config.bookstoreIsbns.bookstoreIsbns,t=e.isbns,i={},r={},n=null;return s.each(t,function(e){e.is_required?i[e.isbn]=!0:r[e.isbn]=!0}),n={required:i,optional:r}},getAjaxSearchResults:function(t){var i=s.union(s.keys(t.required),s.keys(t.optional)),r=this.config.bookstoreIsbns.bookstoreIsbns.isFinalized;r?e.isEmptyObject(i)?this.renderNoBooks():(this.ajaxComponent.trigger("get search result",{query:i.join(" "),extraData:{trackId:this.trackId,strackId:this.strackId}}),this.ajaxComponent.on("search result",e.proxy(function(e,s){this.render(s,t)},this)),listOfRequiredNotFoundIsbns=[],s.each(s.keys(t.required),function(t){-1!==e.inArray(t,i)&&listOfRequiredNotFoundIsbns.push(t)}),this.ajaxComponent.on("failed search attempt",e.proxy(function(t,s){listOfRequiredNotFoundIsbns.length?(this.clearAndGetClassName(),e(".results").append(this.bookListRequiredTmpl({hasOptional:!1})),this.renderClassHasNoBooksInCatalog(listOfRequiredNotFoundIsbns),e(".bookstore-results").append(this.disclaimerTmpl())):this.renderNoBooks()},this))):this.renderClassNeedsToUpdateBooks()},addBooks:function(t,i){"function"!=typeof C.utility.highlightText&&(C.utility.highlightText=function(e,t){var s='<span class="chg-suggest-term"> $1</span>',i=(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),r=new RegExp("("+i+")","gi"),n=e.replace(r,s);return n});var r=i.required,o=i.optional,a=t.textbooks.responseContent,l=0,c=this;s.each(a.docs,function(t){t.url+="&ii="+ ++l,t.template="C.fed.serp.book";var i=null,a=null;if(r[t.ean]?(i=".books-list-required",a='<div class="book-type">REQUIRED</div>'):o[t.ean]&&(i=".books-list-optional",a='<div class="book-type book-type-optional">Optional</div>'),i){e(i).append(a);var h='<li class="item-result"></li>';e(i).append(h);var d=s.last(e(i).find(".item-result"));n.create(t.template,{el:d}).trigger("render",{results:t,config:c.config})}})},clearAndGetClassName:function(){this.removeLoadingIndicator(),e(".bookstore-results").empty();var t=e(".C-common-bookstore-search").attr("data:course-num"),s=e(".C-common-bookstore-search").attr("data:course-name"),i={courseNumber:t,courseName:s};e(".bookstore-results").append(this.bookListHeader(i))},getBooksNotInCatalog:function(e,t){var i=t.required,r=t.optional,n={required:[],optional:[]},o=e.textbooks.responseContent,a=o.docs.length===i.length+r.length;if(!a){var l={};s.each(o.docs,function(e){l[e.ean]=!0}),s.each(s.keys(i),function(e){l[e]||n.required.push(e)}),s.each(s.keys(r),function(e){l[e]||n.optional.push(e)})}return n},addBooksNotInCatalog:function(t){s.each(t,function(t){e(".books-not-found").append('<div class="family-01 f-size-03 isbn-not-in-catalog"><b>ISBN13:</b> '+t+"</div>")})},render:function(t,s){this.clearAndGetClassName();var i=!e.isEmptyObject(s.required),r=!e.isEmptyObject(s.optional),n=this.getBooksNotInCatalog(t,s);n.optional.length===s.optional.length&&(r=!1),r||i?(i&&(e(".book-serp-results").append(this.bookListRequiredTmpl({hasOptional:r})),n.required.length&&this.renderClassHasNoBooksInCatalog(n.required)),r&&e(".book-serp-results").append(this.bookListOptionalTmpl()),this.addBooks(t,s),e(".bookstore-results").append(this.disclaimerTmpl())):this.noResultsTmpl()},renderNoBooks:function(){this.clearAndGetClassName(),e(".bookstore-results").append(this.noResultsTmpl({notes:this.config.bookstoreIsbns.bookstoreIsbns.notes})),e(".bookstore-results").append(this.disclaimerTmpl())},renderClassNeedsToUpdateBooks:function(t){this.clearAndGetClassName(),e(".bookstore-results").append(this.bookListUpdateTmpl()),e(".bookstore-results").append(this.disclaimerTmpl())},renderClassHasNoBooksInCatalog:function(t){e(".bookstore-results").append(this.booksNotInCatalogTmpl()),this.addBooksNotInCatalog(t)},renderTracking:function(){var e="?trackid="+this.trackId+"&strackId="+this.strackId;return e},renderError:function(t){this.clearAndGetClassName(),e(".bookstore-results").append(this.errorTmpl({separatedBooks:t})),e(".bookstore-results").append(this.disclaimerTmpl())},createLoadingIndicator:function(){e(".bookstore-welcome").hide(),e(".bookstore-loading").show(),e(".bookstore-results").empty(),this.loadingIndicator=n.create("C.Eggshell.loading.inline",{el:e(".bookstore-loading")}),e(".bookstore-loading").append('<div class="finding-books-txt">Finding books</div>'),e(".btn-flat-sm").prop("disabled",!0),e(".bookstore-faq").css("display","none")},removeLoadingIndicator:function(){this.loadingIndicator.destroy(),e(".finding-books-txt").remove(),
e(".btn-flat-sm").prop("disabled",!1),e(".bookstore-faq").css("display","block")},setQuery:function(e,t){this.query=t.query},errorTmpl:s.template('<div class="error-search">There was an error searching for books<br/>These are the erroring Isbns<br/>Required:<br/><%= _.keys(separatedBooks.required) %><br/>Optional:<br/><%= _.keys(separatedBooks.optional) %><div>'),disclaimerTmpl:s.template('<div class="disclaimer">* The materials listed on Chegg.com are subject to change at any time.</div>'),bookListHeader:s.template('<div class="book-serp-results"><div class="result-heading">Results for: <b><%= courseNumber %> - <%= courseName %><sup>&#42;</sup></b></div></div>'),bookListRequiredTmpl:s.template('<div class="books-container books-container-required <%= hasOptional? "last-section" : "" %>"><div class="books-list books-list-required <%= hasOptional? "" : "last-section" %>"></div></div>'),bookListOptionalTmpl:s.template('<div class="books-container books-container-optional"><div class="books-list books-list-optional last-section"></div></div>'),bookListUpdateTmpl:s.template('<div class="update-books"><div class="error-header">Waiting for Book Information</div><div class="error-subheader">Your professor has not provided a book list for this course.</div></div>'),booksNotInCatalogTmpl:s.template('<div class="books-not-in-catalog"><div class="not-in-stock-header">The following book(s) are not currently available.</div><div class="books-not-found"></div></div>'),noResultsTmpl:s.template('<div class="no-results"><div class="error-header">No books required for this course.</div><div class="error-subheader">Your professor does not require any book purchases.</div></div>')});return i}()),n.define("C.search.serp.federated",{inputs:["render"],output:[]},function(){var t=r.View.extend({initialize:function(t){n.find(this).on("render",this.render,this),n.find("C.search.trackid").on("track ids",e.proxy(function(e,t){this.trackId=t.trackid,this.strackId=t.strackid},this)).trigger("get track ids")},render:function(e,t){this.hideSpinner(),this.displayOrder=t.displayOrder,this.renderResults(t.results,t.config),t.config.profile.showPagination&&this.createSerpPagination(t.results,t.config)},renderResults:function(e,t){var s="?trackid="+this.trackId+"&strackId="+this.strackId+"&event=filter_submit";this.renderOrderedResults(e,t,s)},renderOrderedResults:function(e,t,s){var i=this.displayOrder;i instanceof Array&&0!=i.length||(i=["textbooks","tbs-book"]),this.ii=1;for(key in i){var r=i[key];null!=e[r]&&this.renderItems(r,e,t,s)}if("study-fused-filters-srp"===t.profile.profile){this.$(".search-categories").append(this.studyCategoriesTmpl({query:location.pathname.split("/")[2],tracking:s}));var n=C.utility.getParams();"tbsOnly"===n.filter?this.$(".study-categories .tbs-filter").addClass("selected"):"qnaOnly"===n.filter?this.$(".study-categories .qa-filter").addClass("selected"):this.$(".study-categories .all-filter").addClass("selected")}},renderItems:function(t,s,i,r){var o=s[t].responseContent,a=i.entityMap[t];if(o.numFound>0&&null!=a&&o.docs.length>0){var l=e(this.generalResultsTmpl({entity:a,query:location.pathname.split("/")[2],tracking:r,hideSeeMore:!!i.profile.hideSeeMore}));this.$el.append(l);var c=i.profile.profile;"study-fused-basic-srp"===c&&(C.global.simplifiedSearchv2?l.find(".item-list").addClass("study-srp simplified-search-exp"):l.find(".item-list").addClass("study-srp")),"study-fused-filters-srp"===c&&l.find(".item-list").addClass("study-filter-srp");for(var h=0;h<o.docs.length;h++){if(o.docs[h].url+="&ii="+this.ii++,"study-fused-filters-srp"===i.profile.profile&&("C.fed.serp.tbs.problem"!==o.docs[h].template&&"C.fed.serp.qa"!==o.docs[h].template||(o.docs[h].template="C.fed.serp.study"),"C.fed.serp.tbs.book"===o.docs[h].template&&(o.docs[h].template="C.fed.serp.tbs.book.inline")),i.profile.odinProfileId,"C.fed.serp.tbs.book.inline"===o.docs[h].template)var d=e('<li class="item-result inline-tbs-book"></li>');else var d=e('<li class="item-result"></li>');var u=e('<a class="item-anchor" href="'+o.docs[h].url+'"></a>');u.click(function(e){e.stopPropagation()}),d.append(u),d.appendTo(l.find(".item-list")),n.create(o.docs[h].template,{el:u}).trigger("render",{results:o.docs[h],config:i})}}if("federated-tbs-problem-srp"===i.profile.odinProfileId||"study-fused-srp"===i.profile.odinProfileId){var p=this.$el.find(".sectionTitle");p[1]&&e(p[1]).hide()}},createSerpPagination:function(t,s){this.$el.append('<div class="pagination"></div>');var i=0,r=0;for(var o in t)null!=t[o]&&"infobox"!==o&&C.utility.access("responseContent.numFound",t[o])&&(i+=t[o].responseContent.numFound,r+=t[o].responseContent.limit);this.$(".pagination").empty(),i>r&&(this.$pagination=n.create("C.Eggshell.pagination",{el:this.$(".pagination")}).trigger("totalItemsNum",i).trigger("itemsPerPage",r).trigger("currentPage",this.getPageNumber()).trigger("showPageDesc",!0).trigger("limitMaxPages",50).trigger("render"),e(".C-Eggshell-pagination a").click(e.proxy(function(t){return t.stopPropagation(),pageNumber=Math.max(1,parseInt(e(t.target).attr("href"),10)),this.$pagination.trigger("currentPage",pageNumber),this.$pagination.trigger("render"),e(".item-list").empty(),n.find("C.search.serp_v2").trigger("next page",pageNumber),this.showSpinner(),this.scrollToTop(),!1},this)))},getPageNumber:function(){return location.hash&&(page=Number(location.hash.substr(3)),!isNaN(page)&&page>0)?page:1},showSpinner:function(){e(".chg-load").show()},hideSpinner:function(){e(".chg-load").hide()},scrollToTop:function(){e("html, body").stop().animate({scrollTop:0},300)},studyCategoriesTmpl:s.template('<div class="study-categories"><ul><a href="/search/<%-query%>/textbook-solutions<%- tracking %>&filter=all"><li class="all-filter">ALL</li><span class="pipe">|</span></a><a href="/search/<%-query%>/textbook-solutions<%- tracking %>&filter=tbsOnly"><li class="tbs-filter">TEXTBOOK SOLUTIONS</li><span class="pipe">|</span></a><a href="/search/<%-query%>/textbook-solutions<%- tracking %>&filter=qnaOnly"><li class="qa-filter">EXPERT Q&A</li></a></ul></div>'),generalResultsTmpl:s.template('<div class="<%- entity.sectionClass %>"><div class="sectionTitle"><span class="icon <%- entity.iconClass %>"></span><% if(hideSeeMore) {%><span class="container-title"><%- entity.seeMore %></span><div class="search-categories"></div><% }else{ %><a href="/search/<%-query%><%- entity.seeMoreUrlSuffix %><%- tracking %>"><span class="container-title"><%- entity.seeMore %> </span></a><% } %></div><ul class="item-list"></ul><a href="/search/<%-query%><%- entity.seeMoreUrlSuffix %><%- tracking %>"><span class="more"><%- entity.seeMoreFull %> </span> </a></div>')});return t}()),n.define("C.search.serp.qnafed",{inputs:["render"],output:[]},function(){var t=(r.Model.extend({initialize:function(e){}}),r.View.extend({initialize:function(t){n.find(this).on("render",this.render,this),n.find("C.search.trackid").on("track ids",e.proxy(function(e,t){this.trackId=t.trackid,this.strackId=t.strackid},this)).trigger("get track ids")},render:function(e,t){this.renderResults(t.results,t.config)},renderResults:function(t,s){this.$el.append(this.resultsTmpl({query:location.pathname.split("/")[2],tracking:"?trackid="+this.trackId+"&strackId="+this.strackId+"&event=filter_submit"}));var i=t["tbs-problem"].responseContent,r=t.questions.responseContent;0==i.numFound&&this.$(".tbs-results").hide(),0==r.numFound&&this.$(".qna-results").hide();for(var o=1,a=0;a<i.docs.length;a++){var l=i.docs[a],c=e('<li class="item-result"></li>');l.url+="&ii="+o++,n.create(l.template,{el:c.appendTo(this.$(".tbs-list"))}).trigger("render",{results:l,config:s})}for(var a=0;a<r.docs.length;a++){var l=r.docs[a],c=e('<li class="item-result"></li>');l.url+="&ii="+o++,n.create(l.template,{el:c.appendTo(this.$(".qna-list"))}).trigger("fed serp location",s.profile.title).trigger("render",{results:l,config:s})}},resultsTmpl:s.template('<div class="tbs-results"><span class="icon tbs-icon"></span><a href="/search/<%=query%>/textbook-solutions<%= tracking %>"><span class="container-title">Textbook solutions </span></a><ul class="tbs-list"></ul><a href="/search/<%=query%>/textbook-solutions<%= tracking %>&type=tbs-problems"><span class="more">More Textbook Solutions </span> </a></div><div class="qna-results"><span class="icon qna-icon"></span><a href="/search/<%=query%>/questions-and-answers<%= tracking %>"><span class="container-title">Expert Q&A </span></a><ul class="qna-list"></ul><a href="/search/<%=query%>/questions-and-answers<%= tracking %>"><span class="more">More Expert Q&A </span></a></div>')}));return t}()),n.define("C.search.serp.singlefed",{inputs:["render"],output:["single serp location"]},function(){var t=(r.Model.extend({initialize:function(e){}}),r.View.extend({initialize:function(t){n.find(this).on("render",this.render,this),n.find("C.search.trackid").on("track ids",e.proxy(function(e,t){this.trackId=t.trackid,this.strackId=t.strackid},this)).trigger("get track ids")},render:function(e,t){this.hideSpinner(),this.renderResults(t.results,t.config),this.createSerpPagination(t.results,t.config)},getQuery:function(){return decodeURIComponent(location.pathname.split("/")[2])},renderResults:function(t,s){this.$el.append(this.resultsTmpl({icon:s.profile.iconClass,title:s.profile.title}));var i=10*(this.getPageNumber()-1);if("Tutors"==s.profile.title){for(var r=t.searchResult.tutors,o=0;o<r.length;o++)if(r[o].component){r[o].url+="&ii="+ ++i;var a=e('<li class="item-result"></li>');n.create(r[o].component,{el:a.appendTo(".result-list")}).trigger("render",r[o])}}else for(var l in t)if(null!=t[l]&&"infobox"!==l&&C.utility.access("responseContent.docs",t[l]))for(var o=0;o<t[l].responseContent.docs.length;o++){if(t[l].responseContent.docs[o].url+="&ii="+ ++i,"C.fed.serp.book.old"!=t[l].responseContent.docs[o].template){var a=e('<li class="item-result"></li>'),c=e('<a class="item-anchor" href="'+t[l].responseContent.docs[o].url+'"></a>');c.click(function(e){e.stopPropagation()}),a.append(c),a.appendTo(this.$(".result-list"));var h=c}else{var a=e('<li class="item-result"></li>');a.appendTo(this.$(".result-list"));var h=a}n.create(t[l].responseContent.docs[o].template,{el:h}).trigger("single serp location").trigger("render",{results:t[l].responseContent.docs[o],config:s})}},createSerpPagination:function(t,s){if("Tutors"==s.profile.title)var i=(this.getPageNumber(),t.count),r=3;else for(var o in t)if(null!=t[o]&&"infobox"!==o&&C.utility.access("responseContent.numFound",t[o]))var i=t[o].responseContent.numFound,r=t[o].responseContent.limit;this.$(".pagination").empty(),i>r&&(this.$pagination=n.create("C.Eggshell.pagination",{el:this.$(".pagination")}).trigger("totalItemsNum",i).trigger("itemsPerPage",r).trigger("currentPage",this.getPageNumber()).trigger("showPageDesc",!0).trigger("limitMaxPages",50).trigger("render"),e(".C-Eggshell-pagination a").click(e.proxy(function(t){return t.stopPropagation(),pageNumber=Math.max(1,parseInt(e(t.target).attr("href"),10)),this.$pagination.trigger("currentPage",pageNumber),this.$pagination.trigger("render"),e(".result-list").empty(),n.find("C.search.serp_v2").trigger("next page",pageNumber),this.showSpinner(),this.scrollToTop(),!1},this)))},getPageNumber:function(){return location.hash&&(page=Number(location.hash.substr(3)),!isNaN(page)&&page>0)?page:1},scrollToTop:function(){e("html, body").stop().animate({scrollTop:0},300)},showSpinner:function(){e(".chg-load").show()},hideSpinner:function(){e(".chg-load").hide()},resultsTmpl:s.template('<div class="results-container"><div class="subheader-title"><span class="icon <%- icon %>"></span><span class="container-title"><%- title %></span></div><ul class="result-list"></ul></div><div class="pagination"></div>')}));return t}()),n.define("C.search.serp_mobile",{inputs:["render","next page","hide"],output:[]},function(){var t=r.Model.extend({initialize:function(t){var i=t.results,r=t.tabId,n=t.displayOrder;if(i.hasOwnProperty("apiError")&&this.set("apiError",i.apiError),i.noResults===!0)this.set("count",0);else{e.isArray(i.order)&&(n=i.order,this.set("displayOrder",n));var o=[],a=[],l=0,c=0;if("tutors"===r){var h=i.searchResult.tutors;s.each(h,function(e){e.component&&(e.type="tutors",e.template=e.component+".mobile",o.push(e))}),l=i.count,a.push("tutors")}else s.each(n,function(e){if(response=i[e],null!=response&&"infobox"!==e&&"intents"!==e){a.push(e);var t=response.responseContent,r=t.docs;s.each(r,function(t){t.type=e,o.push(t)}),l+=Number(t.numFound),c=t.limit}}),1===a.length&&this.set("limit",c);this.set({items:o,types:a,count:l})}}}),i=r.Model.extend({initialize:function(i){var r=i.config.profile,o=r.tabId,a={},l={},c={},h=n.create("C.search.configuration");h.on("config values for profile id",function(e,t){var t=t.profile,i=t.displayOrder;s.each(i,function(e){c[e]=t.tabId})}).trigger("get mobile filters config",function(e){l=e[o],s.each(e,function(e,t){a[t]=e.title,e.filters?s.each(e.filters,function(e){h.trigger("get config by profile id",e.profileId)}):h.trigger("get config by profile id",e.profileId)})}),e(".without-all-matches").length>0&&delete a.all;var d=["Computer Science","Physics","Economics","Writing","Statistics","Accounting","Chemistry","Calculus","Biology","Finance"];this.set(i),this.set({page:1,profile:r,tabId:o,urlQuery:encodeURIComponent(i.query),filters:a,currentFilter:l,types:c,tutorLinks:d}),this.updateTrackId();var u=function(e,s){var i=new t({results:e,tabId:this.get("tabId"),displayOrder:r.displayOrder,intentDisplayOrder:r.intentDisplayOrder||null});this.set("results",i),this.set("ajaxIsLoading",!1),this.trigger(s,i)};this.ajaxComponent=n.create("C.search.ajax",{mobile:!0}).trigger("set config values",this.get("config")).on("search result",function(e,t){u.call(this,t,"loaded")},this).on("failed search attempt",function(e,t){u.call(this,t,"failToLoad")},this)},updateTrackId:function(){n.find("C.search.trackid").on("track ids",e.proxy(function(e,t){this.set("track",{trackId:t.trackid,strackId:t.strackid})},this)).trigger("get track ids")},loadPage:function(e){if(!this.get("ajaxIsLoading")){this.set("ajaxIsLoading",!0);var t=this.get("page");e&&(t+=1,this.set("page",t));var s=this.get("track");this.ajaxComponent.trigger("get search result",{query:this.get("query"),extraData:{trackId:s.trackId,strackId:s.strackId,page:t}})}},getTabIdByItemType:function(e){return this.get("types")[e]},getTabTitleByItemType:function(e){var t=this.getTabIdByItemType(e);return this.get("filters")[t]}}),o=r.View.extend({initialize:function(e){var t=e.config;if("undefined"==typeof t)throw"Config needs to be passed to the layouts, for it to function";this.model=new i({config:t,query:t.query}),this.model.on("loaded",function(e){this.loader.trigger("hide"),0===e.get("count")?this.renderNoResults(e):(this.render(e),1==this.model.get("page")&&(this.$list.height()<this.$overflow.height()&&this.tryLoadMore(),this.createPagination()))},this).on("failToLoad",function(e){this.loader.trigger("hide"),e.get("apiError")?this.renderError():this.renderNoResults(e)},this),n.find(this).on("render",this.load,this).on("hide",this.hideResults,this).on("destroy",this.destroy,this),this.setClickItemWrappers()},load:function(){this.$el.html(this.serpTmpl()),this.createFilters(),this.$list=this.$(".serp-list"),this.$header=this.$(".serp-headline"),this.$overflow=e(".mobile-overflow"),this.loader=n.create("C.search.mobile.loader",this.$list),this.loader.trigger("show",this.$list),this.model.loadPage()},render:function(e){this.renderHeader(e),this.renderTabButtons(),this.renderResults(e)},renderNoResults:function(t){this.$list.empty(),this.renderHeader(t),"tutors"===this.model.get("tabId")?this.$list.append(e(this.tmplTutorNoResults({searchTerm:this.model.get("query"),links:this.model.get("tutorLinks")}))):(this.renderTabButtons(),this.$list.append(this.noResultsTmpl({searchTerm:this.model.get("query"),tabId:this.model.get("tabId")})))},renderError:function(){this.$list.empty(),this.$list.append(this._ajaxErrorTpl())},renderHeader:function(e){this.$header.empty(),this.$header.append(this.headerTmpl({results:{total:e.get("count"),vertical:this.model.get("title"),query:this.model.get("query"),urlQuery:this.model.get("urlQuery"),tracking:this.renderTracking()}})),this.$header.show()},renderTabButtons:function(){var t=this.model.get("currentFilter"),i=t.filters,r=this.model.get("profile");if(s.isObject(i)&&s.keys(i).length>0){var n=s.keys(i),o=s.intersection(n,r.displayOrder);o=o.length>0?o[0]:n[0];var a=this.model.get("results").get("displayOrder");e.isArray(a)&&a.length>0&&(o=a[0]),this.$header.append(this.tabButtons({filters:i,selected:o}))}},renderTracking:function(e){var t=this.model.get("track");return e=e?"&event="+e:"","?trackid="+t.trackId+"&strackId="+t.strackId+e},createFilters:function(){var e=this.model.get("filters"),t={};s.each(e,function(e,s){t[s]={name:e,url:"javascript:void(0);"}}),n.create("C.common.search.serp.filter",{el:this.$(".serp-filters")}).trigger("set tab options",t).trigger("set selected filter",this.model.get("tabId")).trigger("render")},tryLoadMore:function(){var e=this.model.get("results");if(e){var t=e.get("count"),s=e.get("limit"),i=this.model.get("page");if(t>i*s)return this.model.loadPage(!0),this.loader.trigger("show",this.$list),!0}},createPagination:function(){"all"!==this.model.get("tabId")&&this.$overflow.on("scroll.serp_mobile",function(t){var s=e(t.target),i=s.scrollTop()+s.height(),r=s.get(0).scrollHeight;if(50>r-i){if(this.tryLoadMore())return!0;s.off("scroll.serp_mobile")}}.bind(this))},renderResults:function(t){this.model.updateTrackId();var i=this.$list.find(".item-result").length,r=this.model.get("config"),o=t.get("items"),a=t.get("types"),l=(this.model.get("types"),null),c=this.$list;s.each(o,function(t){var s=t.type;if(a.length>1&&s!==l){l=s;var o=this.model.getTabTitleByItemType(s),h=this.model.getTabIdByItemType(s);c=this.createItemsGroup(h,o)}t.url+="&ii="+ ++i;var d=e('<li class="item-result"></li>'),u=n.create(t.template,{el:d.appendTo(c)});"tutors"===s?u.trigger("render",t):u.trigger("mobile search").trigger("single serp location").trigger("render",{results:t,config:r})},this)},createItemsGroup:function(t,s){var i=s.toLowerCase();"qna"===t?i="expert Q&A":"books"===t&&(i="books");var r=e(this.groupOfItems({title:s,seeAllLink:t,seeAllText:i}));return this.$list.append(r),r.children(".group-list")},hideResults:function(){this.$header.empty(),this.$list.empty()},setClickItemWrappers:function(){this.$el.on("click.serp_mobile",".item-result .tbs-question, .item-result .qna-question",function(t){var s=e(this).find("a").attr("href");return location.href=s,!1})},destroy:function(){this.$overflow&&this.$overflow.off("scroll.serp_mobile"),this.$el.off("click.serp_mobile")},_ajaxErrorTpl:s.template('<div class="ajax-error-outer-box"><h5 class="error-title">Oops, something went wrong!</h5><div class="error-descr">Give us a minute and then try again</div><div class="error-state-hero"></div></div>'),groupOfItems:s.template('<div class="group-items"><div class="group-title"><%- title %></div><div class="group-list"></div><a data-id="<%- seeAllLink %>" class="group-see_all" href="javascript:void(0);">See all <%- seeAllText %> &rsaquo;</a></div>'),tabButtons:s.template('<div class="tab-buttons"><span>View as: <% _.each(filters, function itr(filter, filterId){ %><a href="javascript:void(0)" data-id="<%- filterId %>" ><% if (!(!itr.first && (itr.first = true))) { %>| <% } %><% var cls = (filterId === selected)? "selected": ""; %><span class="tab-button-text <%- cls %>"><%- filter.title %></span> </a><% }) %></span></div>'),serpTmpl:s.template('<div class="row"><div class="col-10 col-first"><div class="serp-container"><div class="serp-filters"></div><div class="serp-content"><div class="serp-headline"></div><ol class="serp-list"></ol></div></div></div><div class="col-2 col-last"><div class="serp-post-new-question-form"></div><div class="serp-advertisment"></div></div></div>'),headerTmpl:s.template('<div class="headerInfo"><span class="total"><%- results.total %> </span><span class="results-label">Results</span></div>'),noResultsTmpl:s.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><% if(tabId === "all") {%><p class="title-2">We can\'t find <span class="search-term"><%- searchTerm %></span></p><p class="title-3">Please double check the ISBN or spelling.</p><% }else if(tabId === "books") {%><p class="title-2">We can\'t find <span class="search-term"><%- searchTerm %></span> in Books</p><p class="title-3">Please double check the ISBN or spelling.</p><% }else if(tabId === "tbs") { %><p class="title-2">We can\'t find <span class="search-term"><%- searchTerm %></span> in textbook solutions</p><p class="title-3">Please double check the ISBN or spelling.</p><% }else if(tabId === "qna") { %><p class="title-2">We can\'t find any questions for <span class="search-term"><%- searchTerm %></span></p><% } %></div></div>'),tmplTutorNoResults:s.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any tutoring for <span class="search-term"><%- searchTerm %></span></p><p class="title-tutor">Try one of these popular tutoring subjects:</p></div><ul class="popular-subjects"><% _.each(links, function(link){ %><li><a data-id="findByQuery" data-query="<%- link %>" href="javascript:void(0);"><%- link %></a></li><% }) %></ul></div>')});return o}()),n.define("C.search.serp_v2",{inputs:["render","next page"],output:[]},function(){var t=r.Model.extend({initialize:function(e){}}),i=r.View.extend({initialize:function(s){if("undefined"==typeof s.config)throw"Config needs to be passed to the layouts, for it to function";this.config=s.config,this.totalFound=0,this.displayOrder=s.config.profile.displayOrder,this.ajaxComponent=n.create("C.search.ajax").trigger("set config values",this.config).on("search result",this.render,this).on("failed search attempt",this.renderError,this),this.model=new t,n.find("C.search.trackid").on("track ids",e.proxy(function(e,t){this.trackId=t.trackid,this.strackId=t.strackid},this)).trigger("get track ids"),this.setListeners()},setListeners:function(){n.find(this).on("render",this.load,this),n.find(this).on("next page",this.getAjaxResults,this)},load:function(){this.$el.html(this.serpTmpl()),this.createFilters(),this.renderAdvertisment(),this.renderPostNewQuestionForm(),this.createLoadingIndicator(),this.getAjaxResults()},getAjaxResults:function(e,t){var s="Tutors"==this.config.profile.title?3:void 0;"undefined"==typeof t&&(t=this.getPageNumber());var i=window.location.href.split("#")[0];window.location.replace(i+"#p="+t),this.ajaxComponent.trigger("get search result",{query:this.getQuery(),extraData:{trackId:this.trackId,strackId:this.strackId,page:t,count:s}})},checkAndRedirect:function(e){if("undefined"!=typeof e&&e.textbooks){var t=e.textbooks.responseContent.docs,s=t.length;if(1===s&&1===e.textbooks.responseContent.numFound){var i=t[0],r=i.url;r&&C.utility.navigate(r,!0)}}var n=C.utility.getParams(),o=n.no_redirect;if("tutors-fake-profile"===this.config.profile.identifier&&e.hasExactMatch&&!o){var a=e.hasExactMatch.url,r=C.global.liveSiteUrl+"tutors/"+a+"-online-tutoring";return location.replace(r),!1}return!0},render:function(t,s){this.checkAndRedirect(s)&&(this.removePlaceholders(),s.infobox&&s.infobox.responseContent.docs.length>0&&s.infobox.responseContent.docs[0].html&&(e(".serp-infobox").remove(),this.createInfoBox(s.infobox.responseContent.docs[0].html)),this.detectDisplayOrder(s),this.totalFound=this.calculateTotal(s),this.totalFound>0?(this.createHeaderInfo(),this.$(".serp-list").empty(),this.addTbsButton(),n.create(this.config.profile.sublayout,{el:this.$(".serp-list")}).trigger("render",{results:s,config:this.config,displayOrder:this.displayOrder})):this.renderError(null,s))},renderError:function(t,s){this.$(".serp-list").empty(),e(".chg-load").hide(),this.removePlaceholders(),this.createHeaderInfo(),s.infobox&&s.infobox.responseContent.docs.length>0&&s.infobox.responseContent.docs[0].html&&(e(".serp-infobox").remove(),this.createInfoBox(s.infobox.responseContent.docs[0].html)),"Tutors"==this.config.profile.title?this.$(".serp-list").append(e(this.tmplTutorNoResults({searchTerm:this.getQuery(),links:["Computer Science","Physics","Economics","Writing","Statistics","Accounting","Chemistry","Calculus","Biology","Finance"],trackParams:this.renderTracking()}))):(this.addTbsButton(),this.$(".serp-list").append(this.noResultsTmpl({searchTerm:this.getQuery(),page:this.config.profile.title})))},addTbsButton:function(){if("Textbook solutions"===this.config.profile.title){var t=location.pathname.split("/")[2],s=C.utility.getParams().type;if(!s)if(e.isArray(this.displayOrder)&&this.displayOrder.length>0)s="tbs-problem"===this.displayOrder[0]?"tbs-problems":"tbs-books";else{var i=decodeURIComponent(t).split(" ").length;i>15&&(s="tbs-problems")}C.global.federatedTbsSerp||this.$(".serp-list").append(this.tbsButton({query:t})),"tbs-problems"===s?(e(".tbs-problems-btn").addClass("selected"),e(".tbs-books-btn").removeClass("selected")):(e(".tbs-books-btn").addClass("selected"),e(".tbs-problems-btn").removeClass("selected"))}},getPageNumber:function(){return location.hash&&(page=Number(location.hash.substr(3)),!isNaN(page)&&page>0)?page:1},renderTracking:function(e){return e=e?"&event="+e:"","?trackid="+this.trackId+"&strackId="+this.strackId+e},createFilters:function(){var e=location.pathname.split("/")[2],t=this.renderTracking("filter_submit"),s="/search/"+e+"/federated"+t+"&filterloc=serp_tab",i="/search/"+e+"/books"+t+"&filterloc=serp_tab",r="/search/"+e+"/study"+t+"&filterloc=serp_tab",o="/search/"+e+"/tutors"+t+"&no_redirect=true&filterloc=serp_tab";"study-fused-filters-srp"==this.config.profile.profile&&(r+="&filter=all"),n.create("C.common.search.serp.filter",{el:this.$(".serp-filters")}).trigger("set tab options",{"All matches":{name:"All matches",url:s,"class":"filter-all-matches"},Books:{name:"Books",url:i,"class":"filter-books"},Study:{name:"Study",url:r,"class":"filter-study"},Tutors:{name:"Tutors",url:o,"class":"filter-tutors"}}).trigger("set selected filter",this.config.profile.title).trigger("render")},createInfoBox:function(e){this.$(".serp-headline").after('<div class="serp-infobox">'+e+"</div>")},detectDisplayOrder:function(t){e.isArray(t.order)&&(this.displayOrder=t.order)},calculateTotal:function(t){var s=0;if(t.noResults===!0)return 0;if("Tutors"==this.config.profile.title)return t?t.count:0;var i=0;for(var r in t)e.inArray(r,this.displayOrder)>-1&&null!=t[r]&&"infobox"!=r&&C.utility.access("responseContent.numFound",t[r])&&(i+=Number(t[r].responseContent.numFound),s+=t[r].responseContent.limit);return i>50*s&&(i=50*s),i},createHeaderInfo:function(){var e=location.pathname.split("/")[2];this.$(".serp-headline").empty(),this.$(".serp-headline").append(this.sunkistHeaderTmpl({results:{total:this.totalFound,vertical:this.config.profile.title,query:this.getQuery(),urlQuery:e,tracking:this.renderTracking()}}))},renderPostNewQuestionForm:function(){var t=this.getQuery(),i=s.contains(["Textbook solutions","Expert Q&A","Study"],this.config.profile.title)||"All matches"==this.config.profile.title&&t.trim().split(/\s+/).length>=16;C.global.SERPQuestionForm&&i&&(n.create("C.common.question.form",{el:e(".serp-post-new-question-form"),source:"serp"}).trigger("set question body",t).trigger("render"),this.$(".serp-advertisment").addClass("no-margin"))},renderAdvertisment:function(){this.$(".serp-advertisment").append(this.advertismentTmpl({advertisment:this.config.profile.advertising})),n.find("C.common.advertisements").trigger("render")},getQuery:function(){return this.query||(this.query=decodeURIComponent(location.pathname.split("/")[2])),this.query},createLoadingIndicator:function(){e(".serp-content").append('<div class="chg-load"></div>'),e(".chg-load").hide()},removePlaceholders:function(){e(".federated-placeholder-content").remove()},tbsButton:s.template('<div class="tbs-button"><span>View as: <a href="/search/<%= query %>/textbook-solutions?trackid=<%= this.trackId %>&strackId=<%= this.strackId %>&type=tbs-problems" ><span class="tbs-problems-btn">Problems</span> </a><a href="/search/<%= query %>/textbook-solutions?trackid=<%= this.trackId %>&strackId=<%= this.strackId %>&type=tbs-books">| <span class="tbs-books-btn selected">Books</span></a></span></div>'),serpTmpl:s.template('<div class="row"><div class="col-10 col-first"><div class="serp-container"><div class="serp-filters"></div><div class="serp-content"><div class="serp-headline"></div><div class="serp-list"></div></div></div></div><div class="col-2 col-last"><div class="serp-post-new-question-form"></div><div class="serp-advertisment"></div></div></div>'),sunkistHeaderTmpl:s.template('<div class="headerInfo"><span class="quotes"><span class="query">"<%- results.query %>"</span></span> <span class="total"><%= results.total %> results</span><span class="vertical"> in <%- results.vertical %></span></div>'),advertismentTmpl:s.template('<div class="chg-ad"><div class="chg-display" data-unit="<%= advertisment %>" data-size="160x600"></div></div>'),noResultsTmpl:s.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><% if(page == "Books" || page == "All matches") {%><p class="title-2 <% if(page == "All matches"){%> title-all-matches <% }else{ %> title-book<% } %>">We can\'t find <span class="search-term"><%- searchTerm %></span></p><p class="title-3">Please double check the ISBN or spelling.</p><% }else if(page == "Textbook solutions") { %><p class="title-2 title-tbs">We can\'t find any textbook solutions for <span class="search-term"><%- searchTerm %></span></p><p class="title-3">Please double check the ISBN or spelling.</p><% }else if(page == "Expert Q&A" || page == "Study") { %><p class="title-2 title-qna">We can\'t find any questions for <span class="search-term"><%- searchTerm %></span></p><% } %></div></div>'),tmplTutorNoResults:s.template('<div class="no-results tutors-no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any tutoring for <span class="search-term"><%- searchTerm %></span></p><p class="title-3">Please select one of the following popular tutoring subjects:</p></div><ul class="popular-subjects"><% _.each(links, function(link){ %><li><a href="/search/<%- link.replace(\' \', \'-\') %>/tutors/<%- trackParams %>"><%- link %></a></li><% }) %></ul></div>')});return i}()),n.define("C.fed.auto.book",{inputs:{render:{payload:{id:"string",template:"C.common.search.result.book",url:"string",thumbnail:"string",title:"string",author:"string",isbn:"string",ean:"string",groupName:"string",isFirst:"boolean",type:"string"}}},outputs:{}},function(){var e=r.View.extend({initialize:function(e){n.find(this).on("render",this.render),this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;",this.query=e.query},render:function(e,t){var s=C.utility.highlightText(t.title,this.query),i=!!t.subtitle&&C.utility.highlightText(t.subtitle,this.query),r="";if(Array.isArray(t.authors))r=t.authors[0]?t.authors[0]:"";else if(t.author){var o=t.author.split(";");r=o[0]}var a=r+this.bulletSeperatorHTML+"ISBN: "+t.isbn+this.bulletSeperatorHTML+"ISBN13: "+t.ean;t.cover||(t.cover="http://c.chegg.com/covers2/imagena.gif"),a=C.utility.highlightText(a,this.query),this.$el.html(this.template({book:{id:t.id,template:"C.fed.auto.book",url:t.url.replace(/^http(s)?:/i,location.protocol),thumbnail:t.cover,title:s+(t["edition-no"]?' <span class="result-header-small">('+C.utility.ordinal(t["edition-no"])+" Edition)</span>":""),subtitle:i,detail:a}})),n.create("C.common.bookcover",{el:this.$el.find(".book-cover-container")}).trigger("set book image",t.cover.replace(/^http(s)?:/i,location.protocol)).trigger("turn off shadow")},template:s.template('<div class="book-result"><div class="result-data"><a href="<%- book.url %>"><span class="book-cover-container small bookcover-seo-mini"></span><div class="result-info"><span class="result-header"><%= book.title %></span><% if(book.subtitle!=false){%><span class="result-sub-header"><%= book.subtitle %></span><% } %><span class="result-detail"><%= book.detail %></span></div></a></div></div>')
});return e}()),n.define("C.fed.auto.qna",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){var e=r.View.extend({initialize:function(e){n.find(this).on("render",this.render),this.query=e.query},render:function(e,t){var s=t,i="question";s.chapterName&&(i="solution"),this.$el.html(this.QNATemplate({qna:{url:C.global.liveSiteUrl+s.url.substring(1),question:C.utility.highlightText(s.question,this.query),type:i}}))},QNATemplate:s.template('<a href="<%- qna.url %>"><div class="qna-question"><div class="question"><strong class="f-size-03">Q:</strong><%= qna.question %></div><% if(qna.type === "solution") { %><span><strong class="f-size-03">S:</strong> <a class="answer" href="<%= qna.url %>">View Solution</a></span><% } else { %><span><strong class="f-size-03">A:</strong> <a class="answer" href="<%= qna.url %>">See Answer</a></span><% } %></div></a>')});return e}()),n.define("C.fed.auto.tbs",{inputs:{render:{payload:{id:"string",component:"string",url:"string",title:"string",ean:"string",isbn:"string",author:"string",subtitle:"string",edition_no:"string",solutioncount:"string",group:"string",isFirst:"string",type:"string"}}},outputs:{},strict:!1},function(){var e=r.View.extend({initialize:function(){n.find(this).on("render",this.render)},render:function(e,t){this.highlightText(t),this.$el.html(this.tbsTemplate({tbs:{id:t.id,component:t.component,searchBy:t.searchBy,url:C.global.liveSiteUrl+t.url.substring(1),cover:C.utility.bookCover(t,C.utility.bookCover.thumb,{type:C.utility.bookCover.tbsType}),isbn:t.isbn,isbn13:t.ean,author:this.truncateAuthors(this.author),subtitle:!!this.subtitle&&this.subtitle,title:this.title,edition:t["edition-no"]?"("+this.toOrdinal(t["edition-no"])+" Edition)":""}}))},events:{mouseenter:"onMouseEnterTBSResult",mouseleave:"onMouseLeaveTBSResult"},truncateAuthors:function(e){var t=e;if("undefined"!=typeof e){var s=e.split(" ; ");t=s[0]}return t},highlightText:function(e){var t='<span class="chg-suggest-term">$1</span>',s=e.searchBy,i=new RegExp("("+this.regExpQuote(s)+")","i");if(e.title){var r=e.title.replace(i," "+t);this.title=r}if(e.subtitle){var n=e.subtitle.replace(i," "+t);this.subtitle=n}if(e.author){var o=e.author.replace(i,t);this.author=o}},regExpQuote:function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},toOrdinal:function(e){var t=e%10;return 1===t&&11!==e?e+"st":2===t&&12!==e?e+"nd":3===t&&13!==e?e+"rd":e+"th"},onMouseEnterTBSResult:function(e){this.$el.addClass("tbs-highlight")},onMouseLeaveTBSResult:function(e){this.$el.removeClass("tbs-highlight")},tbsTemplate:s.template('<div class="result-data"><a href="<%- tbs.url %>"><div class="left-info"><%= tbs.cover %></div><div class="right-info"><span class="result-header"><%= tbs.title %>&nbsp;&nbsp;<span class="result-edition"><%= tbs.edition %></span></span><% if(tbs.subtitle!=false){%><span class="result-sub-header"><%= tbs.subtitle %></span><% } %><span class="result-detail"><%= tbs.author %>&nbsp;&bull;&nbsp;ISBN: <%= tbs.isbn %>&nbsp;&bull;&nbsp;ISBN13: <%= tbs.isbn13 %></span></div></a></div>')});return e}()),n.define("C.fed.serp.book.old",{inputs:{render:{payload:{id:"string",url:"string",title:"string",author:"string",ean:"string",edition:"string","edition-no":"string",hasEbook:"boolean",hasTbs:"boolean",imageUrl:"string",isBundle:"boolean",isDac:"boolean",isEbook:"boolean",isTextbook:"boolean",isbn:"string",lowPrice:"string",highPrice:"string",priceType:"string",listPrice:"string",otherOptions:"object",price:"object",template:"string",hasCourtesyEbook:"boolean"}},"single serp location":{payload:null}},outputs:{},strict:!1},function(){var t=r.View.extend({initialize:function(){this.singleSerp=!1,this.isMobileSearch=!1,n.find(this).on("render",this.render).on("mobile search",e.proxy(function(){this.isMobileSearch=!0},this))},render:function(e,t){var s=this.transformData(t.results),i=t.config.query;i&&"undefined"!=i||(i=decodeURIComponent(location.pathname.split("/")[2]));var r="0"===s["edition-no"]?"1":s["edition-no"],n=this.getPrice(s),o=this.showPriceGuarantee(s),a=this.isMobileSearch?C.utility.bookCover({imgMedium:s.imageUrl},C.utility.bookCover.medium):C.utility.bookCover({imgLarge:s.imageUrl},C.utility.bookCover.large);this.$el.html(this.booksTemplate({book:{id:s.id,cover:a,overlay:C.global.staticBaseUrl+"s/_global/images/book-overlay-100.png",url:s.url.replace(/^http(s)?:\/\//i,"//"),title:C.utility.highlightText(s.title,i)+(r?" ("+C.utility.ordinal(r)+") ":""),author:C.utility.highlightText(this.getAuthors(s.authors),i),subtitle:!!s.subtitle&&C.utility.highlightText(s.subtitle,i),isbn13:s.ean,isbn:s.isbn,priceType:s.priceType,price:n,hasTbs:s.hasTbs,hasEbook:s.hasEbook,isEbook:s.isEbook,isTextbook:s.isTextbook,otherOptions:null!==s.otherOptions&&0!==s.otherOptions.length,canBuy:null!==s.otherOptions&&-1!=s.otherOptions.indexOf("Buy"),canBuyEbook:null!==s.otherOptions&&-1!=s.otherOptions.indexOf("eTextbook"),listPrice:this.getListPrice(s),hasCourtesyEbook:s.hasCourtesyEbook,priceGuarantee:o}})),o&&this.renderGuaranteeBadge(),this.isMobileSearch||this.createTooltips(t.results)},renderGuaranteeBadge:function(){n.create("C.common.guarantee.badge",{el:this.$el.find(".guarantee-badge")})},showPriceGuarantee:function(e){return!(!e.priceGuarantee||!C.global.priceMatchGuarantee)},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++)t+=0==i?e[i]:"; "+e[i];return t},getListPrice:function(e){var t=null,s=null;"undefined"!=typeof e.price?t=e.price:"undefined"!=typeof e.highPrice&&(t=e.highPrice);var i=e.listPrice;return t&&i&&parseInt(t)<parseInt(i)&&(s=i),s},getPrice:function(e){return"undefined"!=typeof e.price&&null!=e.price?"$"+parseFloat(e.price).toFixed(2):"undefined"!=typeof e.lowPrice&&"undefined"!=typeof e.highPrice?"$"+parseFloat(e.lowPrice).toFixed(2)+" - $"+parseFloat(e.highPrice).toFixed(2):""},createTooltips:function(e){e.hasCourtesyEbook&&this.createCourtseyTooltip(),e.hasEbook&&this.createEbookTooltip(),e.hasTbs&&this.createTbsTooltip()},createCourtseyTooltip:function(){n.create("C.common.overlay.tooltip").on("return tooltip content node",function(e,t){var s=t;s.html('<span class="tooltip-text">Courtesy eTextbook (7 days FREE)</span>')}).trigger("set target",this.$(".courtsey-icon")).trigger("get tooltip content node")},createEbookTooltip:function(){n.create("C.common.overlay.tooltip").on("return tooltip content node",function(e,t){var s=t;s.html('<span class="tooltip-text">eTextbook available</span>')}).trigger("set target",this.$(".ebook-icon")).trigger("get tooltip content node")},createTbsTooltip:function(){n.create("C.common.overlay.tooltip").on("return tooltip content node",function(e,t){var s=t;s.html('<span class="tooltip-text">Textbook Solutions available</span>')}).trigger("set target",this.$(".tbs-tick-icon")).trigger("get tooltip content node")},transformData:function(e){var t=e["edition-no"]||e.priceType||"number"==typeof e.price;return t||(e["edition-no"]=e.edition,e.priceType=!!e.price&&e.price.type,e.lowPrice=e.price?e.price.minPrice:void 0,e.highPrice=e.price?e.price.maxPrice:void 0,e.price=e.price?e.price.price:void 0,e.otherOptions=s.compact(s.map(e.otherOptions,function(e,t){return e?t:void 0}))),e},booksTemplate:s.template('<div class="result-data"><a href="<%= book.url %>" class="book-cover-link"><div class="book-cover"><%= book.cover %></div></a><div class="book-info"><a href="<%= book.url %>"><div class="line-item f-size-03 title"><%= book.title %></div></a><% if(book.subtitle){%><span class="subtitle"><%= book.subtitle %></span><% } %><span class="line-item authors"><span class="detail"><strong>Authors: </strong><%= book.author %></span></span><div class="line-item"><span class="isbn"><strong><% if(book.isEbook){ %> <span class="isbn-title">eISBN:</span><% }else{ %> <span class="isbn-title">ISBN:</span><% } %> <%= book.isbn %></strong></span><span class="isbn13"><strong><% if(book.isEbook){ %> <span class="isbn-title">eISBN13:</span><% }else{ %> <span class="isbn-title">ISBN13:</span><% } %> <%= book.isbn13 %></strong></span></div><div class="line-item"><% if(book.hasCourtesyEbook){ %><span class="textbook-icons courtsey-icon"></span><% } %><% if(book.hasEbook){ %><span class="textbook-icons ebook-icon"></span><% } %><% if(book.hasTbs){ %><span class="textbook-icons tbs-tick-icon"></span><% } %></div></div><div class="price-info"><% if(book.priceType){ %><div class="line-item price-type"><span class="price-title"><%= book.priceType %></span><span class="book-price"><a href="<%= book.url %>&preSelection=<%= book.priceType %>"><%= book.price %></a><% if(book.priceGuarantee){%><span class="guarantee-badge"></span><% } %></span></div><div class="line-item price"><% if(book.listPrice){ %><span class="list-price-title">List price:</span><span class="list-price"><span class="amount">$<%= book.listPrice %></span></span><% } %></div><div class="line-item other"><% if(book.otherOptions){ %><span class="other-price">Other:</span><span class="other-options"><% if(book.canBuy){ %><a class="other-buy" href="<%= book.url %>&preSelection=buy">Buy</a><% } %><% if(book.canBuyEbook){ %>| <a href="<%= book.url %>&preSelection=etextbook">eTextbook</a><% } %></span><% } %></div><% }else { %><span class="price-title out-of-stock">Out of stock</span><% } %></div></div>')});return t}()),n.define("C.fed.serp.book",{inputs:{render:{payload:{id:"string",url:"string",title:"string",author:"string",ean:"string",edition:"string","edition-no":"string",hasEbook:"boolean",hasTbs:"boolean",imageUrl:"string",isBundle:"boolean",isDac:"boolean",isEbook:"boolean",isTextbook:"boolean",isbn:"string",lowPrice:"string",highPrice:"string",priceType:"string",listPrice:"string",otherOptions:"object",price:"object",template:"string",hasCourtesyEbook:"boolean"}},"single serp location":{payload:null}},outputs:{},strict:!1},function(){var t=r.View.extend({initialize:function(){this.singleSerp=!1,this.isMobileSearch=!1,n.find(this).on("single serp location",e.proxy(function(){this.singleSerp=!0},this)).on("render",this.render).on("mobile search",e.proxy(function(){this.isMobileSearch=!0},this))},render:function(e,t){var s=this.transformData(t.results),i=t.config.query;i&&"undefined"!=i||(i=decodeURIComponent(location.pathname.split("/")[2]));var r="0"===s["edition-no"]?"1":s["edition-no"],n=this.getPrice(s),o=this.showPriceGuarantee(s),a=this.isMobileSearch?C.utility.bookCover({imgMedium:s.imageUrl},C.utility.bookCover.medium):C.utility.bookCover({imgLarge:s.imageUrl},C.utility.bookCover.large);this.$el.html(this.booksTemplate({book:{id:s.id,cover:a,overlay:C.global.staticBaseUrl+"s/_global/images/book-overlay-100.png",url:s.url,title:C.utility.highlightText(s.title,i)+(r?" ("+C.utility.ordinal(r)+") ":""),subtitle:!!s.subtitle&&C.utility.highlightText(s.subtitle,i),author:C.utility.highlightText(this.getAuthors(s.authors),i),isbn13:s.ean,isbn:s.isbn,priceType:s.priceType,price:n,isEbook:s.isEbook,hasTbs:s.hasTbs,tbsUrl:s.tbsUrl?s.tbsUrl:"",priceGuarantee:o}})),o&&this.renderGuaranteeBadge()},renderGuaranteeBadge:function(){n.create("C.common.guarantee.badge",{el:this.$el.find(".guarantee-badge")})},showPriceGuarantee:function(e){return!(!e.priceGuarantee||!C.global.priceMatchGuarantee)},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++)t+=0==i?e[i]:"; "+e[i];return t},getPrice:function(e){return"undefined"!=typeof e.price&&null!=e.price?"$"+parseFloat(e.price).toFixed(2):"undefined"!=typeof e.lowPrice&&"undefined"!=typeof e.highPrice?"$"+parseFloat(e.lowPrice).toFixed(2)+" - $"+parseFloat(e.highPrice).toFixed(2):""},transformData:function(e){var t=e["edition-no"]||e.priceType||"number"==typeof e.price;return t||(e["edition-no"]=e.edition,e.priceType=!!e.price&&e.price.type,e.lowPrice=e.price?e.price.minPrice:void 0,e.highPrice=e.price?e.price.maxPrice:void 0,e.price=e.price?e.price.price:void 0,e.otherOptions=s.compact(s.map(e.otherOptions,function(e,t){return e?t:void 0}))),e},booksTemplate:s.template('<div class="result-data <% if(this.singleSerp == true){ %>singleSerp<% } %>"><a href="<%= book.url %>"><div class="left-info"><%= book.cover %></div><div class="right-info"><div class="line-item f-size-03 title"><%= book.title %></div><% if(book.subtitle){%><span class="line-item"><span class="subtitle"><%= book.subtitle %></span></span><% } %><span class="line-item"><span class="detail"><%= book.author %></span></span><div class="line-item"><span class="isbn"><strong><span><% if(book.isEbook){ %> eISBN:<% }else{ %> ISBN:<% } %></span> <%= book.isbn %></strong></span></div><div class="line-item"><span class="isbn13"><strong><span><% if(book.isEbook){ %> eISBN13:<% }else{ %> ISBN13:<% } %></span> <%= book.isbn13 %></strong></span></div></div><div class="line-item rent"><% if(book.priceType){ %><span class="rent-title"><%= book.priceType %></span><span class="arrow-right"></span><span class="price"><strong><%= book.price %></strong><% if(book.priceGuarantee){%><span class="guarantee-badge"></span><% } %></span><% }else{ %><span class="rent-title">Out of stock</span><% } %></div></a><div class="tbs-callout"><% if(book.hasTbs){ %><a href="<%= book.tbsUrl %>" class="tbs"><span class="tbs-link">Get Chegg Textbook Solutions</span></a><% } %></div></div>')});return t}()),n.define("C.fed.serp.book2",{inputs:{render:{payload:{id:"string",url:"string",title:"string",author:"string",ean:"string",edition_no:"string",hasEbook:"boolean",hasTbs:"boolean",imageUrl:"string",isBundle:"boolean",isDac:"boolean",isEbook:"boolean",isTextbook:"boolean",isbn:"string",listPrice:"string",otherOptions:"object",price:"object",template:"string"}},"single serp location":{payload:null}},outputs:{},strict:!1},function(){var t=r.View.extend({initialize:function(){this.singleSerp=!1,n.find(this).on("single serp location",e.proxy(function(){this.singleSerp=!0},this)).on("render",this.render)},render:function(e,t){var s=t.results,i=decodeURIComponent(location.pathname.split("/")[2]);i&&"undefined"!=i||(i=t.config.query);var r="0"===s.edition?"1":s.edition,n=this.getPrice(s);this.$el.html(this.booksTemplate({book:{id:s.id,cover:C.global.coversBaseUrl+s.imageUrl,overlay:C.global.staticBaseUrl+"s/_global/images/book-overlay-100.png",url:s.url,title:C.utility.highlightText(s.title,i)+(r?" ("+C.utility.ordinal(r)+") ":""),subtitle:!!s.subtitle&&C.utility.highlightText(s.subtitle,i),author:this.getAuthors(s.authors),isbn13:s.ean,isbn:s.isbn,priceType:!!s.price&&s.price.type,price:n,listPrice:this.getListPrice(s),isEbook:s.isEbook,otherOptions:0!==s.otherOptions.length,canBuy:s.otherOptions.Buy,canBuyEbook:s.otherOptions.eTextbook,hasTbs:s.hasTbs,tbsUrl:s.tbsUrl?s.tbsUrl:""}}))},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++)t+=0==i?e[i]:"; "+e[i];return t},getListPrice:function(e){var t=null,s=null;e.price&&(t="undefined"!=typeof e.price.price?e.price.price:e.price.maxPrice);var i=e.listPrice;return t&&i&&parseInt(t)<parseInt(i)&&(s=i),s},getPrice:function(e){return e.price?"undefined"!=typeof e.price.price?"$"+parseFloat(e.price.price).toFixed(2):"$"+parseFloat(e.price.minPrice).toFixed(2)+" - $"+parseFloat(e.price.maxPrice).toFixed(2):""},booksTemplate:s.template('<div class="result-data <% if(this.singleSerp == true){ %>singleSerp<% } %>"><a href="<%= book.url %>"><div class="left-info"><div  class="book-img-3"><img class="book-cover" src="<%= book.cover %>" onerror="this.src=\'http://c.chegg.com/covers2/imagenalarge.gif\'" /><img  class="book-overlay" src="<%= book.overlay %>" /></div></div><div class="right-info"><div class="line-item f-size-03 title"><%= book.title %></div><% if(book.subtitle){%><span class="line-item"><span class="subtitle"><%= book.subtitle %></span></span><% } %><span class="line-item"><span class="detail"><%= book.author %></span></span><div class="line-item"><span class="isbn"><strong><% if(book.isEbook){ %> eISBN:<% }else{ %> ISBN:<% } %> <%= book.isbn %></strong></span></div><div class="line-item"><span class="isbn13"><strong><% if(book.isEbook){ %> eISBN13:<% }else{ %> ISBN13:<% } %> <%= book.isbn13 %></strong></span></div></div><div class="line-item rent"><% if(book.priceType){ %><span class="rent-title"><%= book.priceType %></span><span class="arrow-right"></span><span class="price"><strong><%= book.price %></strong></span><% if(book.listPrice){ %><span class="list-price"><span class="amount">$<%= book.listPrice %></span></span><% } %><% }else{ %><span class="rent-title">Out of stock</span><% } %></div></a><% if(book.otherOptions){ %><div class="line-item other"><span class="other-title">Options:</span><span class="other-options"><% if(book.canBuy){ %><a class="other-buy" href="<%= book.url %>&preSelection=buy">Buy</a><% } %><% if(book.canBuyEbook){ %>| <a href="<%= book.url %>&preSelection=etextbook">eTextbook</a><% } %></span></div><% } %><div class="tbs-callout"><% if(book.hasTbs){ %><a href="<%= book.tbsUrl %>" class="tbs"><span class="tbs-link">Get Chegg Textbook Solutions</span></a><% } %></div></div>')});return t}()),n.define("C.fed.serp.qa",{inputs:{render:{payload:{url:"string",type:"string",title:"string",question:"string"}}},outputs:{},strict:!1},function(){var e=r.View.extend({initialize:function(){n.find(this).on("render",this.render)},render:function(e,t){searchResult=t.results;var s=t.config.query;s&&"undefined"!=s||(s=decodeURIComponent(location.pathname.split("/")[2])),this.$el.html(this.QNATemplate({qna:{id:searchResult.id,url:searchResult.url,question:searchResult["question-highlight"]?searchResult["question-highlight"]:C.utility.highlightText(searchResult.question||"",s)}}))},QNATemplate:s.template('<div class="qna-question"><div class="question"><strong class="f-size-03">Q:</strong><%= qna.question %></div><span class="answer"><strong class="f-size-03">A:</strong> <a href="<%= qna.url %>">See Answer</a></span></div>')});return e}()),n.define("C.fed.serp.study",{inputs:{render:{payload:{url:"string",type:"string",title:"string",question:"string"}}},outputs:{},strict:!1},function(){var e=r.View.extend({initialize:function(){n.find(this).on("render",this.render)},render:function(e,t){var s=t.results,i=t.config.query;i&&"undefined"!==i||(i=decodeURIComponent(location.pathname.split("/")[2]));var r=this.createTbsBookTitle(s.bookTitle,s.bookEditionNumber,s.chapterName,s.problemName);answer=s.answerDisplay,(answer.toLowerCase().indexOf(".swf")>=0||answer.toLowerCase().indexOf(".png")>=0)&&(answer=""),"study-fused-filters-srp"===t.config.profile.profile?this.$el.html(this.studyV2Template({tbs:{id:s.id,ean:s.ean,answer:answer.length<10?"":answer,title:s.title,bookTitle:"null"!==r||"undefined"!=typeof r?r:"",url:s.url,question:s["question-highlight"]?s["question-highlight"]:C.utility.highlightText(s.question||"",i),source:s.source}})):this.$el.html(this.studyTemplate({tbs:{id:s.id,ean:s.ean,answer:answer.length<10?"":answer,title:s.title,bookTitle:"null"!==r||"undefined"!=typeof r?r:"",url:s.url,question:s["question-highlight"]?s["question-highlight"]:C.utility.highlightText(s.question||"",i),source:s.source}}))},createTbsBookTitle:function(e,t,s,i){return t=t?" ("+C.utility.ordinal(t)+" Edition), ":"",s=s?" Chapter "+s+", ":"",i=i?" Question "+i+" ":"",e+t+s+i},studyV2Template:s.template('<div class="studyV2"><div class="tbs-question"><% if(tbs.question){ %><span class="question"><%= tbs.question %></span><% } %><% if(tbs.bookTitle && tbs.source !== "board"){ %><span class="book"><%- tbs.bookTitle %></span><% } %><% if(tbs.answer){ %><span class="answer"><%= tbs.answer %></span><% }else if(tbs.source !== "board"){ %><span class="answer"><a href="<%= tbs.url %>">Step-by-step solution available</a></span><% }else{ %><span class="answer"><a href="<%= tbs.url %>">Answer available</a></span><% } %></div></div>'),studyTemplate:s.template('<div class="tbs-question"><% if(tbs.question){ %><span class="question"><strong>Q:</strong><span class="question-container"><%= tbs.question %></span></span><% } %><% if(tbs.bookTitle && tbs.source !== "board"){ %><span class="book"><%- tbs.bookTitle %></span><% } %><% if(C.global.simplifiedSearchv2){ %><span class="answer-wrapper"><% if(tbs.source == "board"){ %><% if(tbs.answer){ %><a href="<%= tbs.url %>"><span class="answer shorten"><span class="pre-answer">A:</span><span class="answer-container"> <%= tbs.answer %></span></span> <a href="<%= tbs.url %>" class="see-answer">See answer</a></a><% } else { %><a href="<%= tbs.url %>"><span class="pre-answer">A:</span> <a href="<%= tbs.url %>" class="see-answer answer-container">See answer</a></a><% } %><% }else{ %><% if(tbs.answer){ %><a href="<%= tbs.url %>"><span class="answer shorten"><span class="pre-answer">A:</span><span class="answer-container"> <%- tbs.answer %></span></span> <a href="<%= tbs.url %>" class="see-answer">See solution</a></a><% }else{ %><a href="<%= tbs.url %>"><span class="pre-answer">A:</span> <a href="<%= tbs.url %>" class="see-answer answer-container">Solution available</a></a><% } %><% } %></span><% }else{ %><% if(tbs.source == "board"){ %><% if(tbs.answer){ %><a href="<%= tbs.url %>"><span class="answer shorten"><span class="pre-answer">A:</span> <%= tbs.answer %></span> View Answer</a><% } else { %><a href="<%= tbs.url %>"><span class="pre-answer">A:</span> See Answer</a><% } %><% }else{ %><% if(tbs.answer){ %><a href="<%= tbs.url %>"><span class="answer shorten"><span class="pre-answer">A:</span> <%- tbs.answer %></span> View Solution</a><% }else{ %><a href="<%= tbs.url %>"><span class="pre-answer">A:</span> View Solution</a><% } %><% } %><% } %></div>')});return e}()),n.define("C.fed.serp.tbs.problem",{inputs:{render:{payload:{url:"string",type:"string",title:"string",question:"string"}}},outputs:{},strict:!1},function(){var e=r.View.extend({initialize:function(){n.find(this).on("render",this.render)},render:function(e,t){searchResult=t.results;var s=t.config.query;s&&"undefined"!=s||(s=decodeURIComponent(location.pathname.split("/")[2])),this.$el.html(this.tbsQuestionTemplate({tbs:{id:searchResult.id,ean:searchResult.ean,bookTitle:this.createTbsBookTitle(searchResult.bookTitle,searchResult.bookEditionNumber,searchResult.chapterName,searchResult.problemName),url:searchResult.url,question:searchResult["question-highlight"]?searchResult["question-highlight"]:C.utility.highlightText(searchResult.question||"",s)}}))},createTbsBookTitle:function(e,t,s,i){return t=t?" ("+C.utility.ordinal(t)+" Edition), ":"",s=s?" Chapter "+s+", ":"",i=i?" Question "+i+" ":"",e+t+s+i},tbsQuestionTemplate:s.template('<div class="tbs-question"><% if(tbs.question){ %><span class="question"><strong class="f-size-03">Q:</strong><%= tbs.question %></span><% } %><span class="book"><%- tbs.bookTitle %></span><span class="solution"><strong class="f-size-03">S:</strong> <a href="<%= tbs.url %>">View Solution</a></span></div>')});return e}()),n.define("C.fed.serp.tbs.book",{inputs:{render:{payload:{id:"string",component:"string",url:"string",tbsUrl:"string",title:"string",long_title:"string",author:"string",isbn:"string",ean:"string",edition_no:"string",solutionCount:"string",subtitle:"string"}},"single serp location":{payload:{location:"string"}}},outputs:{},strict:!1},function(){var t=r.View.extend({initialize:function(){this.isMobileSearch=!1,n.find(this).on("render",this.render).on("mobile search",e.proxy(function(){this.isMobileSearch=!0},this))},render:function(e,t){searchResult=t.results;var s=t.config.query;s&&"undefined"!=s||(s=decodeURIComponent(location.pathname.split("/")[2]));var i="0"===searchResult["edition-no"]?"1":searchResult["edition-no"];this.$el.html(this.tbsTemplate({tbs:{id:searchResult.id,url:searchResult.tbsUrl||searchResult.url,title:C.utility.highlightText(searchResult.title,s)+(i?" | "+C.utility.ordinal(i)+" ":""),cover:C.utility.bookCover(searchResult,this.isMobileSearch?C.utility.bookCover.thumb:C.utility.bookCover.small,{type:C.utility.bookCover.tbsType}),author:C.utility.highlightText(this.getAuthors(searchResult.authors),s),isbn13:searchResult.ean?searchResult.ean:"",isbn:searchResult.isbn?searchResult.isbn:"",subTitle:searchResult.subtitle?C.utility.highlightText(searchResult.subtitle,s):"",location:"Textbook solutions"==t.config.profile.title&&"federated-tbs-problem-srp"!=t.config.profile.odinProfileId}}))},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++)t+=0==i?e[i]:"; "+e[i];return t},tbsTemplate:s.template('<a href="<%= tbs.url %>"><div class="result-data <% if(tbs.location){%>single-serp<%}%>"><div class="left-info"><%= tbs.cover %></div><div class="right-info"><div class="line-item f-size-03 title"><%= tbs.title %></div><% if(tbs.subTitle){ %><div class="line-item f-size-02 sub-title"><%= tbs.subTitle %></div><% } %><span class="line-item authors"><span class="detail"><strong>Authors: </strong><%= tbs.author %></span></span><div class="line-item"><span class="isbn13"><strong> ISBN13: </strong><%= tbs.isbn13 %></span><span class="isbn"><strong> ISBN: </strong><%= tbs.isbn %></span></div></div></div></a>')});return t}()),n.define("C.fed.serp.tbs.book.inline",{inputs:{render:{payload:{id:"string",component:"string",url:"string",tbsUrl:"string",title:"string",long_title:"string",author:"string",isbn:"string",ean:"string",edition_no:"string",solutionCount:"string",subtitle:"string"}},"single serp location":{payload:{location:"string"}}},outputs:{},strict:!1},function(){var e=r.View.extend({initialize:function(){n.find(this).on("render",this.render)},render:function(e,t){searchResult=t.results;var s=t.config.query;s&&"undefined"!=s||(s=decodeURIComponent(location.pathname.split("/")[2]));var i="0"===searchResult["edition-no"]?"1":searchResult["edition-no"];this.$el.html(this.tbsTemplate({tbs:{id:searchResult.id,url:searchResult.tbsUrl||searchResult.url,title:C.utility.highlightText(searchResult.title,s)+(i?" | "+C.utility.ordinal(i)+" ":""),cover:C.utility.bookCover(searchResult,C.utility.bookCover.small,{type:C.utility.bookCover.tbsType}),author:C.utility.highlightText(this.getAuthors(searchResult.authors),s),isbn13:searchResult.ean?searchResult.ean:"",isbn:searchResult.isbn?searchResult.isbn:"",subTitle:searchResult.subtitle?C.utility.highlightText(searchResult.subtitle,s):"",location:"Textbook solutions"==t.config.profile.title&&"federated-tbs-problem-srp"!=t.config.profile.odinProfileId}}))},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++)t+=0==i?e[i]:"; "+e[i];return t},tbsTemplate:s.template('<a href="<%= tbs.url %>"><div class="result-data <% if(tbs.location){%>single-serp<%}%>"><div class="left-info"><%= tbs.cover %></div><div class="right-info"><div class="line-item f-size-03">Solutions for:</div><div class="line-item f-size-03 title"><%= tbs.title %></div><span class="line-item authors"><span class="detail">Authors: <%= tbs.author %></span></span></div></div></a>')});return e}()),n.define("C.common.search.serp",{inputs:{render:{payload:{ajaxEndpoint:"string",filters:"object",page:"number",size:"number"}}},outputs:{"search result item clicked":{payload:"object"},rendered:{payload:null}},strict:!1},function(){var t=r.Model.extend({load:function(){var t=this.get("payload"),s=t.ajaxEndpoint,i=10,r=t.page?t.page:1;e.ajax({url:s,type:"get",dataType:"json",data:{query:t.query,filters:{},page:r,size:i,trackid:t.trackid,strackid:t.strackid,token:C.global.csrfToken},context:this,success:function(e){return null==e||0==e.count?(this.trigger("failToLoad"),void this.set("searchResult",e)):(this.set("searchResult",e),void this.trigger("loaded"))},error:function(e){this.trigger("failToLoad")}})}}),i=r.View.extend({rank:1,initialize:function(){this.model=new t,this.model.on("loaded",this.render,this),this.model.on("failToLoad",this.renderError,this),n.find(this).on("render",this.load)},load:function(t,s,i){location.hash&&"undefined"==typeof i&&(i=location.hash.substr(3)),"undefined"!=typeof i&&(s.page=Number(i),location.hash="#p="+i,this.scrollToTop(),e(".serp-content").remove(),this.showSpinner()),this.rank=i>0?10*(i-1)+1:1,n.find("C.search.trackid").on("track ids",e.proxy(function(e,t){this.trackid=t.trackid,this.strackid=t.strackid,this.model.set("trackid",this.trackid),this.model.set("strackid",this.strackid)},this)).trigger("get track ids"),this.trackid&&(s.trackid=this.trackid),this.strackid&&(s.strackid=this.strackid),s.query=this.getQuery(),this.model.set("payload",s),this.model.load()},render:function(){var t=this.model.get("payload");this.$el.html(this.template({advertisment:t.advertisment}));var s=n.find("C.common.advertisements");n.trigger(s,"render"),this.createSerpHeader(),this.createSerpPagination(),this.createLoadingIndicator(),e(".serp-content").remove(),this.$(".serp-list").append(e('<ul class="serp-content"></ul>')),$serpContent=e(".serp-content");var i=this.model.get("searchResult").searchResult;"undefined"==typeof t.page&&(t.page=1);var r=10*(t.page-1);for(var o in i)for(var a=0;a<i[o].length;a++)this.rank+=a,"undefined"!=typeof i[o][a].url&&(i[o][a].url+=this.getTrackUrl(i[o][a],++r)),i[o][a].component&&n.create(i[o][a].component,{el:e('<li class="item-result" id='+i[o][a].id+"></li>").appendTo($serpContent)}).trigger("render",i[o][a]);this.Eggshell.trigger("rendered")},generateTrackId:function(){var e=Math.abs(4294967295*Math.random()<<0).toString(16);return("000000000"+e).slice(-8)},getTrackUrl:function(e,t){return this.trackid&&this.strackid?"?trackid="+this.trackid+"&strackid="+this.strackid+"&ii="+t:(this.trackid=e.trackid,"?trackid="+e.trackid+"&strackid="+this.strackid+"&ii="+t)},getTrackParams:function(){var e=C.utility.json2UriParams(s.pick(this.model.get("payload"),"trackid","strackid"));return e?"?"+e:""},getPopularSubjects:function(){return["Computer Science","Physics","Economics","Writing","Statistics","Accounting","Chemistry","Calculus","Biology","Finance"]},scrollToTop:function(){e("html, body").stop().animate({scrollTop:0},300)},showSpinner:function(){this.loadingIndicator&&this.loadingIndicator.show()},hideSpinner:function(){this.loadingIndicator&&this.loadingIndicator.hide()},getQuery:function(){var e=window.location.pathname,t=e.split("/"),s=t[2];return s},getQuery2:function(){var e=new RegExp("[\\?&]q=([^&#]*)"),t="";return query_array=e.exec(location.search),Array.isArray(query_array)&&(t=query_array.pop()),t},renderError:function(){var e=this.model.get("payload");this.$el.html(this.template({advertisment:e.advertisment}));var t=n.find("C.common.advertisements");n.trigger(t,"render"),this.createSerpHeader(),this.showNoResults()},template:s.template('<div class="row"><div class="col-10 col-first"><div class="serp-container"><div class="serp-headline"></div><div class="serp-subheadline"></div><div class="serp-list"></div><div class="serp-pagination"></div></div></div><div class="col-2 col-last"><div class="chg-ad"><div class="chg-display" data-unit="<%= advertisment %>" data-size="160x600"></div></div></div></div>'),createLoadingIndicator:function(){this.loadingIndicator=e('<div class="chg-search-loading"><canvas height="30" width="30"></canvas><br/>Loading</div>'),this.$el.append(this.loadingIndicator),this.spinner=new C.widget.spinner({canvas:e(".chg-search-loading canvas"),color:"#ffffff"}),this.hideSpinner()},createSerpPagination:function(){var t=this.model.get("payload"),s=this.model.get("searchResult");"undefined"==typeof t.page&&(t.page=1),this.$pagination=n.create("C.Eggshell.pagination",{el:this.$(".serp-pagination")}).trigger("totalItemsNum",s.count).trigger("itemsPerPage",10).trigger("currentPage",t.page).trigger("showPageDesc",!0).trigger("render"),e(".C-Eggshell-pagination a").click(e.proxy(function(s){var i=e(s.target);return pageNumber=Math.max(1,parseInt(i.attr("href"),10)),this.load(s,t,pageNumber),!1},this))},createSerpHeader:function(){if(e=this.model.get("searchResult"),"undefined"==typeof e)var e={count:0};this.$header=n.create("C.common.search.serp.header",{el:this.$(".serp-headline")}).trigger("render",{count:e.count,trackid:this.trackid,strackid:this.strackid})},onMouseOverSelection:function(t){var s=e(t.target).closest(".item-result");s.length&&(e(".serp-content").find(".item-result").removeClass("selected"),
s.addClass("selected"))},onMouseLeaveSelection:function(t){e(".serp-content").find(".item-result").removeClass("selected")},parseLink:function(e){var t=/^https?:\/\//,s=/^[^\/]/;return t.test(e)?e=e:s.test(e)&&(e="/"+e),e},onTutorSelectionClick:function(t){var s=e(t.target).closest(".tutor-card").find("a").attr("href");return s&&C.utility.navigate(this.parseLink(s)),!1},onSelectionClick:function(t){var s=e(t.target).closest(".item-result").find("a").attr("href");return s&&C.utility.navigate(this.parseLink(s)),!1},showNoResults:function(){if(this.hideSpinner(),0===this.$(".no-results").length){var t=this.getQuery();t=decodeURIComponent(t);var s=window.location.pathname;if(-1!==s.indexOf("/")){var i=s.split("/"),r=i[3],n={searchTerm:t},o=null,a=".serp-container";"books"===r?o=this.tmplNoResults:"textbook-solutions"===r?o=this.tmplTBSNoResults:"questions-and-answers"===r?o=this.tmplQNANoResults:"tutors"===r?(o=this.tmplTutorNoResults,a=".serp-list",e("#tutors-search-content .placeholder").hide(),n.links=this.getPopularSubjects(),n.trackParams=this.getTrackParams()):a=null,o&&a&&this.$(a).append(e(o(n)))}}},showNoResults2:function(){if(this.hideSpinner(),0===this.$(".no-results").length){var t=this.getQuery();t=decodeURIComponent(t);var s=window.location.pathname;if(-1!==s.indexOf("/")){var i=s.split("/");if(Array.isArray(i)&&i[2]){var r=i[2];"books"==r?this.$(".serp-container").append(e(this.tmplNoResults({searchTerm:t}))):"textbook-solutions"==r?this.$(".serp-container").append(e(this.tmplTBSNoResults({searchTerm:t}))):"questions-and-answers"==r?this.$(".serp-container").append(e(this.tmplQNANoResults({searchTerm:t}))):"tutors"==r&&(e("#tutors-search-content .placeholder").hide(),this.$(".serp-list").append(e(this.tmplTutorNoResults({searchTerm:t,links:this.getPopularSubjects(),trackParams:this.getTrackParams()}))))}}}},events:{"mouseover .item-result":"onMouseOverSelection","mouseleave .serp-content":"onMouseLeaveSelection","click .item-result .tutor-card a":"onTutorSelectionClick","click .item-result a":"onSelectionClick"},tmplNoResults:s.template('<div class="no-results"><div class="no-results-img"><img src="/s/search/images/gary_no_serp_results.png"/></div><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find <span class="search-term"><%- searchTerm %></span></p><p class="title-3"><span class="title-bold">Double check the ISBN or spelling.</span><span> You can search title, ISBN or author\'s name.</span></p></div></div>'),tmplTBSNoResults:s.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any textbook solutions for <span class="search-term"><%- searchTerm %></span></p><p class="title-2">Please double check the ISBN or spelling.<br><span class="subtext"> You can search title, ISBN or author\'s name.</span></p></div></div>'),tmplQNANoResults:s.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any questions for <span class="search-term"><%- searchTerm %></span></p></div></div>'),tmplTutorNoResults:s.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any tutoring for <span class="search-term"><%- searchTerm %></span></p><p class="title-2">Please select one of the following popular tutoring subjects:</p></div><ul class="popular-subjects"><% _.each(links, function(link){ %><li><a href="/search/<%- link.replace(\' \', \'-\') %>/tutors/<%- trackParams %>"><%- link %></a></li><% }) %></ul></div>')});return i}()),n.define("C.common.search.tabs",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"object",filters:"object"}},"position below target automatically":{payload:null}},outputs:{},strict:!1},function(){var t=r.Model.extend({load:function(t){this.set("uqry",t.query);var s=this.ajaxUrls[t.type];this.filters.count="tbs"==t.type||"qna"==t.type?5:null,e.ajax({url:s,type:"get",dataType:"json",timeout:3e3,data:{query:t.query,filters:this.filters,bookcount:"undefined"!=typeof this.bookcount?this.bookcount:5,tbscount:"undefined"!=typeof this.tbscount?this.tbscount:0,count:this.filters.count?this.filters.count:9,source:"group",destination:this.filters.destination,trackid:this.trackid,strackid:this.sessionTrackid,token:C.global.csrfToken},context:this,success:function(t){this.set("searchResult",e.extend(t,{})),this.set("trackId",t.trackId),null==t||0==t.count?this.trigger("failToLoad"):this.trigger("loaded")},error:function(e){this.trigger("failToLoad")}})},setup:function(e){this.target=e.target,this.filters=e.filters,this.ajaxUrls={books:"/_ajax/search/globallist",tbs:"/_ajax/search/tbsserp",qna:"/_ajax/search/qnaserp",tutors:"/_ajax/search/tutors/subjects",careers:"/_ajax/search/careers",colleges:"/_ajax/search/colleges"},"undefined"!=typeof e.filters.destination?this.set("currentTab",e.filters.destination):this.set("currentTab","books"),this.tabSearchTerm={books:null,tbs:null,qna:null,tutors:null,careers:null,colleges:null},this.set("tabSearchTerm",this.tabSearchTerm),this.set("filters",this.filters),this.set("target",this.target)},initialize:function(){this.trackid=this.generateTrackId(),this.sessionTrackid=this.generateTrackId(),this.set("strackid",this.sessionTrackid),this.set("trackId",this.trackid)},generateTrackId:function(){var e=Math.abs(4294967295*Math.random()<<0).toString(16);return("000000000"+e).slice(-8)}}),i=r.View.extend({template:s.template('<div id="tabs-example"><div class="tab-navs"><div class="tab-nav" id="books" data-anchor="books" >Books</div><div class="tab-nav" id="tbs" data-anchor="tbs">Textbook Solutions</div><div class="tab-nav" id="qna" data-anchor="qna">Q&A</div><div class="tab-nav" id="tutors" data-anchor="tutors">Tutors</div><div class="tab-nav" id="careers" data-anchor="careers">Careers</div><div class="tab-nav" id="colleges" data-anchor="colleges">Colleges</div></div><div class="books-content tab-content selected"></div><div class="tbs-content tab-content"></div><div class="qna-content tab-content"></div><div class="tutors-content tab-content"></div><div class="careers-content tab-content"></div><div class="colleges-content tab-content"></div></div>'),initialize:function(){this.model=new t,this.model.on("loaded",this.render,this),this.model.on("failToLoad",this.renderError,this),this.positionAutomaticallyEnabled=!1,n.find(this).on("render",this.setup).on("show",this.show).on("hide",this.hide).on("position below target automatically",this.positionAutomatically),this.sessionTrackid=this.model.get("strackid")},setup:function(e,t){this.model.setup(t),this.currentTab=this.model.get("currentTab");var s=t.target;this.listenInputKeyEvents(s),this.listenForInputFocus(s),this.listenMagnifyingGlassClick(s),this.listenClearBtnClick(s),this.listenForInputBlur(s),this.$el.append(this.template()),this.buildTabs(s)},buildTabs:function(t){var s=n.create("C.Eggshell.tabs",{el:e("#tabs-example"),needHashTag:!1});s.listen("tab switch",e.proxy(function(e,s){this.currentTab=s.type,this.initialTabSelection||(t.click(),t.focus()),this.initialTabSelection=!1},this)),s.trigger("build tabs"),this.selectTab()},selectTab:function(){this.initialTabSelection=!0,this.$el.find(".tab-nav[data-anchor="+this.currentTab+"]").click()},render:function(){var t=this.model.get("searchResult").searchResult;this.$el.find(".searchList").remove(),this.currentTab||(this.currentTab=this.model.get("currentTab"));var s="."+this.currentTab+"-content";this.$el.find(s).append(e('<ul class="searchList" tabindex="1"></ul>')),this.$searchList=this.$el.find(s).find(".searchList");var i=0;for(result in t)for(var r=0;r<t[result].length;r++)"undefined"!=typeof t[result][r].url&&(t[result][r].url+=this.getTrackUrl(t[result][r],++i),t[result][r].searchBy=this.model.get("uqry")),n.create(t[result][r].component,{el:e('<li class="item-result" id='+t[result][r].id+"></li>").appendTo(this.$searchList)}).trigger("render",t[result][r]);this.show()},renderError:function(){this.$el.find(".searchList").remove(),this.$el.append(e('<ul class="searchList"></ul>')),this.$searchList=this.$el.find(".searchList"),this.model.get("target"),this.$searchList.height("100%"),this.$searchList.append(e('<li class="no-results">No matching results</li>')),this.show()},show:function(){if(this.$el.width(this.model.target.outerWidth()),this.$el.find(".result-header, .result-sub-header, .result-detail").css("maxWidth",(.8*this.model.target.outerWidth()|0)+"px"),this.positionAutomaticallyEnabled){var t=this.model.get("target"),s=t.offset().top-e(window).scrollTop(),i=t.offset().left-e(window).scrollLeft();this.$el.css({display:"block",top:s+"px",left:i+"px"})}else this.$el.css({display:"block",top:"50px",position:"absolute"})},load:function(e){this.model.load(e)},hide:function(){this.$el.css({display:"none"})},getTrackUrl:function(e,t){return"?trackid="+e.trackid+"&strackid="+this.sessionTrackid+"&autosuggest=1&ii="+t+"&uqry="+this.model.get("uqry")},listenInputKeyEvents:function(t){t.keyup(e.proxy(function(e){this.onKeyUp(e)},this))},listenForInputFocus:function(t){t.click(e.proxy(function(e){this.onKeyUp(e)},this))},listenForInputBlur:function(t){t.blur(e.proxy(function(e){this.onTextboxBlur(e,t)},this))},listenMagnifyingGlassClick:function(t){t.prev().click(e.proxy(function(e){var s=encodeURIComponent(t.val().replace(/<(?:.|\n)*?>/gm,"")),i=this.model.generateTrackId();if(this.model.get("searchResult")&&"undefined"!=typeof this.model.get("searchResult").count)var r=this.model.get("searchResult").count;else r=0;return C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+s+"&destination="+this.currentTab+"&count="+r+"&trackid="+i+"&strackid="+this.sessionTrackid+"&event=button_submit"),!1},this))},listenClearBtnClick:function(t){t.next().click(e.proxy(function(e){this.resetSearch(e,t)},this))},onTextboxBlur:function(e,t){this.mouseInDropdown||t.is(":focus")||(this.hide(),this.$currentSelectedItem=null)},onMouseEnter:function(){this.mouseInDropdown||(this.mouseInDropdown=!0)},onMouseLeave:function(){this.mouseInDropdown&&(this.mouseInDropdown=!1),this.$currentSelectedItem=null,this.$el.find(".searchList").find(".item-result").removeClass("selected")},onKeyUp:function(t){var s=e(t.target).val().replace(/<(?:.|\n)*?>/gm,"");this.currentTab||(this.currentTab=this.model.get("currentTab"));var i=this.model.get("tabSearchTerm");t.stopPropagation(),40==t.keyCode?(this.doNextSelection(t),t.preventDefault()):38==t.keyCode?(this.doPrevSelection(t),t.preventDefault()):27==t.keyCode?this.hide():13==t.keyCode?(this.onSelectionClick(t),e(t.target).blur(),this.$currentSelectedItem=null):46==t.keyCode||8==t.keyCode?s.length<3?this.hide():0==s.length?e(t.target).next().hide():this.load({type:this.currentTab,query:s}):(s.length>0&&e(t.target).next().show(),s.length>=2&&(null==i[this.currentTab]?this.load({type:this.currentTab,query:s}):i[this.currentTab]!==s&&this.load({type:this.currentTab,query:s})))},onSelectionClick:function(t){if(this.model.get("trackId"),null==this.$currentSelectedItem){var s=encodeURIComponent(e(t.target).val().replace(/<(?:.|\n)*?>/gm,"")),i=this.model.generateTrackId();if(this.model.get("searchResult")&&"undefined"!=typeof this.model.get("searchResult").count)var r=this.model.get("searchResult").count;else r=0;C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+s+"&destination="+this.currentTab+"&count="+r+"&trackid="+i+"&strackid="+this.sessionTrackid+"&event=enter_submit")}else{var n=this.$currentSelectedItem.find("a").attr("href");C.utility.navigate(C.global.cheggSiteUrl+n+"&event=click_submit")}return this.hide(),!1},doNextSelection:function(t){var s=this.$el.find(".searchList").find(".item-result"),i=s.index(this.$el.find(".searchList").find(".selected"));if(s.removeClass("selected"),-1==i||i>=s.length-1)var r=s.eq(0).addClass("selected");else var r=s.eq(i+1).addClass("selected");this.changeSelection(r);var n=this.$currentSelectedItem.offset().top-82;0>n&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+n);var o=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+e(".chg-system-message").height()+e(".chg-header").height());o>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+o)},doPrevSelection:function(t){var s=this.$el.find(".searchList").find(".item-result"),i=s.index(this.$el.find(".searchList").find(".selected"));if(s.removeClass("selected"),-1==i||0===i)var r=s.eq(s.length-1).addClass("selected");else var r=s.eq(i-1).addClass("selected");this.changeSelection(r);var n=this.$currentSelectedItem.offset().top-82;0>n&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+n);var o=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+e(".chg-system-message").height()+e(".chg-header").height());o>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+o)},changeSelection:function(e){this.$currentSelectedItem=e},positionAutomatically:function(){this.positionAutomaticallyEnabled=!0},resetSearch:function(e,t){e.preventDefault(),e.stopPropagation(),t.val(""),t.next().hide(),this.$currentSelectedItem=null},onMouseOverSelection:function(t){var s=e(t.target).closest(".item-result");s.length&&(this.$el.find(".searchList").find(".item-result").removeClass("selected"),s.addClass("selected")),this.changeSelection(s)},events:{"MSPointerDown .item-result a":"onSelectionClick","mouseover .item-result":"onMouseOverSelection","click .item-result a":"onSelectionClick","keydown .searchList":"onKeyUp","mouseenter .searchList":"onMouseEnter","mouseenter .tab-navs":"onMouseEnter","mouseleave .searchList":"onMouseLeave"}});return i}()),n.define("C.common.search.group",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"object",filters:"object"}},show:{payload:null},hide:{payload:null},update:{payload:{query:"string"}},"go to the next search result":{payload:null},"go to the previous search result":{payload:null},"disable auto resize":{payload:null},"position below target automatically":{payload:null}},outputs:{},strict:!1},function(){var i=r.Model.extend({load:function(t){this.set("uqry",t.query),e.ajax({url:this.url,type:"get",dataType:"json",timeout:3e3,data:{query:t.query,filters:this.filters,bookcount:"undefined"!=typeof this.bookcount?this.bookcount:4,tbscount:"undefined"!=typeof this.tbscount?this.tbscount:3,count:this.filters.count?this.filters.count:null,source:"group",destination:this.filters.destination,trackid:this.trackid,strackid:this.sessionTrackid},context:this,success:function(t){this.set("searchResult",e.extend(t,{})),this.set("trackId",t.trackId),null==t||0==t.count?this.trigger("failToLoad"):this.trigger("loaded")},error:function(e){this.trigger("failToLoad")}})},setup:function(e){this.url=e.ajaxEndpoint,s.has(e,"bookcount")&&(this.bookcount=e.bookcount),s.has(e,"tbscount")&&(this.tbscount=e.tbscount),this.target=e.target,this.filters=e.filters,this.set("filters",this.filters),this.set("target",this.target)},initialize:function(){this.trackid=this.generateTrackId(),this.sessionTrackid=this.generateTrackId(),this.set("strackid",this.sessionTrackid),this.set("trackId",this.trackid)},generateTrackId:function(){var e=Math.abs(4294967295*Math.random()<<0).toString(16);return("000000000"+e).slice(-8)}}),o=r.View.extend({initialize:function(){this.positionAutomaticallyEnabled=!1,this.model=new i,this.model.on("loaded",this.render,this),this.model.on("failToLoad",this.renderError,this),n.find(this).on("update",this.load).on("render",this.setup).on("show",this.show).on("hide",this.hide).on("show a single segway",e.proxy(function(e,t){this.singleCategory=t},this)).on("position below target automatically",this.positionAutomatically);var t=n.create("C.Eggshell.window.resize.tracker");t.on("resize",this.handleResize,this),this.mouseInDropdown=!1,this.sessionTrackid=this.model.get("strackid")},render:function(){var t=this.model.get("searchResult").searchResult;e(".searchList").remove(),this.$el.append(e('<ul class="searchList" tabindex="1"></ul>')),this.$searchList=e(".searchList"),this.getSearchCategories();var s=0;for(result in t)for(var i=0;i<t[result].length;i++)"undefined"!=typeof t[result][i].url&&(t[result][i].url+=this.getTrackUrl(t[result][i],++s),t[result][i].searchBy=this.model.get("uqry")),0==i?(this.$searchList.append(e('<li class="searchDivider"></li>')),this.$searchList.append(e('<li class="category"><div class="category-name"><span>'+t[result][i].type+"</span></div></li>")),n.create(t[result][i].component,{el:e('<li class="item-result first" id='+t[result][i].id+"></li>").appendTo(this.$searchList)}).trigger("render",t[result][i])):n.create(t[result][i].component,{el:e('<li class="item-result" id='+t[result][i].id+"></li>").appendTo(this.$searchList)}).trigger("render",t[result][i]);this.show(),this.searchListHeight=this.$searchList.height(),this.handleResize()},getTrackUrl:function(e,t){return"?trackid="+e.trackid+"&strackid="+this.sessionTrackid+"&autosuggest=1&ii="+t+"&uqry="+this.model.get("uqry")},getSearchCategories:function(){var e=this.model.generateTrackId(),t=this.model.get("uqry"),s="?trackid="+e+"&strackid="+this.sessionTrackid,i=encodeURIComponent(t.replace(/<(?:.|\n)*?>/gm,"")),r={url:"search/"+i+"/books/"+s,type:"Books"},n={url:"search/"+i+"/textbook-solutions/"+s,type:"Textbook Solutions"},o={url:"search/"+i+"/questions-and-answers/"+s,type:"Q&A"},a={url:"search/"+i+"/tutors/"+s,type:"Tutors"},l={"textbook-solutions":function(){return[n,o,r]},"questions-and-answers":function(){return[o,n,r]},tutors:function(){return[a,o,n,r]},"single-books":function(){return[r]},"single-tbs":function(){return[n]},"single-qna":function(){return[o]}};if(this.singleCategory)var c=this.singleCategory;else var c=this.getLocation();var h=l[c]&&l[c]()||[r,n,o];this.createCategory(h,t)},createCategory:function(t,s){for(var i=0;i<t.length;i++)n.create("C.common.search.result.category",{el:e('<li class="item-result category-result"></li>').appendTo(this.$searchList)}).trigger("render",{url:t[i].url,searchBy:s,type:t[i].type})},getLocation:function(){var e=window.location.pathname,t="";if(-1!==e.indexOf("/")){var s=e.split("/");t=s[3],"homework-help"==s[1]&&void 0!=s[2]&&(t="questions-and-answers"==s[2]?s[2]:"textbook-solutions"),"tutors"==s[1]&&(t="tutors")}return t},handleResize:function(){var t=this.model.get("target");this.$searchList=e(".searchList"),this.searchListHeight>e(window).height()-100?this.$searchList.height(e(window).height()-100):this.$searchList.height("100%"),this.$searchList.width(t.outerWidth()+115),this.$(".result-header, .result-sub-header, .result-detail").css("maxWidth",(.8*t.width()|0)+"px")},show:function(){if(this.positionAutomaticallyEnabled){var t=this.model.get("target"),s=t.offset().top-e(window).scrollTop(),i=t.offset().left-e(window).scrollLeft();this.$el.css({display:"block",top:s+"px",left:i+"px"})}else this.$el.css({display:"block",top:"50px",position:"absolute"})},hide:function(){e(".C-common-search-group").css({display:"none"})},setup:function(s,i){var r={},o=this.model.generateTrackId();t.extend(r,i),r.target.prev().click(e.proxy(function(e){n.find("C.global.header.rightsection.usermenu").trigger("hide menu"),n.find("C.global.header.searchbox").trigger("collapse search box");var t=encodeURIComponent(r.target.val().replace(/<(?:.|\n)*?>/gm,""));if("undefined"!=typeof this.model.get("filters").destination){if("undefined"==typeof this.model.get("searchResult").count)var s=0;C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+t+"&destination="+this.model.get("filters").destination+"&count="+s+"&trackid="+o+"&strackid="+this.sessionTrackid)}else C.utility.navigate(C.global.cheggSiteUrl+"search/"+t+"/books/?trackid="+o+"&strackid="+this.sessionTrackid);return!1},this)),r.target.next().click(e.proxy(function(e){this.resetSearch(e,r.target)},this)),r.target.keyup(e.proxy(function(e){this.onKeyUp(e)},this)),r.target.click(e.proxy(function(e){this.onKeyUp(e)},this)),r.target.blur(e.proxy(function(e){this.onTextboxBlur(e,r)},this)),this.model.setup(r);var a=this.model.get("target");e(a).bind("paste",e.proxy(function(t){var s=e(t.target).val().replace(/<(?:.|\n)*?>/gm,"");s.length>0&&e(t.target).next().show(),s.length>=2&&this.load({query:s})},this))},renderError:function(){e(".searchList").remove(),this.$el.append(e('<ul class="searchList"></ul>')),this.$searchList=e(".searchList"),this.getSearchCategories(),this.searchListHeight=this.$searchList.height();var t=this.model.get("target");this.$searchList.height("100%"),this.$searchList.width(t.width()+105+30-2),this.show()},load:function(e){this.model.load(e)},resetSearch:function(e,t){e.preventDefault(),t.val(""),t.next().hide(),this.$currentSelectedItem=null},onMouseOverSelection:function(t){var s=e(t.target).closest(".item-result");s.length&&(e(".searchList").find(".item-result").removeClass("selected"),s.addClass("selected")),this.changeSelection(s)},onSelectionClick:function(t){if(this.model.get("trackId"),null==this.$currentSelectedItem){var s=encodeURIComponent(e(t.target).val().replace(/<(?:.|\n)*?>/gm,"")),i=this.model.generateTrackId();if("undefined"!=typeof this.model.get("filters").destination){if("undefined"==typeof this.model.get("searchResult").count)var r=0;C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+s+"&destination="+this.model.get("filters").destination+"&count="+r+"&trackid="+i+"&strackid="+this.sessionTrackid)}else C.utility.navigate(C.global.cheggSiteUrl+"search/"+s+"/books/?trackid="+i+"&strackid="+this.sessionTrackid)}else{var n=this.$currentSelectedItem.find("a").attr("href");C.utility.navigate(C.global.cheggSiteUrl+n)}return this.hide(),!1},onKeyUp:function(t){var s=e(t.target).val().replace(/<(?:.|\n)*?>/gm,"");40==t.keyCode?(this.doNextSelection(t),t.preventDefault()):38==t.keyCode?(this.doPrevSelection(t),t.preventDefault()):27==t.keyCode?this.hide():13==t.keyCode?(this.onSelectionClick(t),this.$currentSelectedItem=null):46==t.keyCode||8==t.keyCode?s.length<3?this.hide():0==s.length?e(t.target).next().hide():this.load({query:s}):(s.length>0&&e(t.target).next().show(),s.length>=2&&this.load({query:s}))},events:{"MSPointerDown .item-result a":"onSelectionClick","mouseover .item-result":"onMouseOverSelection","click .item-result a":"onSelectionClick","keydown .searchList":"onKeyUp","mouseenter .searchList":"onMouseEnter","mouseleave .searchList":"onMouseLeave"},onTextboxBlur:function(e,t){this.mouseInDropdown||t.target.is(":focus")||(this.hide(),this.$currentSelectedItem=null)},onMouseEnter:function(){this.mouseInDropdown||(this.mouseInDropdown=!0)},onMouseLeave:function(){this.mouseInDropdown&&(this.mouseInDropdown=!1),this.$currentSelectedItem=null,e(".searchList").find(".item-result").removeClass("selected")},doNextSelection:function(t){var s=e(".searchList").find(".item-result"),i=s.index(e(".searchList").find(".selected"));if(s.removeClass("selected"),-1==i||i>=s.length-1)var r=s.eq(0).addClass("selected");else var r=s.eq(i+1).addClass("selected");this.changeSelection(r);var n=this.$currentSelectedItem.offset().top-82;0>n&&e(".searchList").scrollTop(e(".searchList").scrollTop()+n);var o=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(e(".searchList").outerHeight()+e(".chg-system-message").height()+e(".chg-header").height());o>0&&e(".searchList").scrollTop(e(".searchList").scrollTop()+o)},doPrevSelection:function(t){var s=e(".searchList").find(".item-result"),i=s.index(e(".searchList").find(".selected"));if(s.removeClass("selected"),-1==i||0===i)var r=s.eq(s.length-1).addClass("selected");else var r=s.eq(i-1).addClass("selected");this.changeSelection(r);var n=this.$currentSelectedItem.offset().top-82;0>n&&e(".searchList").scrollTop(e(".searchList").scrollTop()+n);var o=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(e(".searchList").outerHeight()+e(".chg-system-message").height()+e(".chg-header").height());o>0&&e(".searchList").scrollTop(e(".searchList").scrollTop()+o)},changeSelection:function(e){this.$currentSelectedItem=e},positionAutomatically:function(){this.positionAutomaticallyEnabled=!0}});return o}()),n.define("C.common.search.groupV1_6",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"object",filters:"object"}},show:{payload:null},hide:{payload:null},update:{payload:{query:"string"}},"go to the next search result":{payload:null},"go to the previous search result":{payload:null},"disable auto resize":{payload:null},"show a single segway":{payload:"string"},"show no segways":{payload:null},"set width to size of input field":{payload:null},"position above target":{payload:null},"set search result format type":{payload:"string"},"set search list bottom content":{payload:"object"}},outputs:{rendered:{payload:null}},strict:!1},function(){var i=function(){var e=window.location.pathname,t="";if(-1!==e.indexOf("/")){var s=e.split("/");t=s[3],"homework-help"==s[1]&&void 0!=s[2]&&(t="questions-and-answers"==s[2]?s[2]:"textbook-solutions"),"tutors"==s[1]&&(t="tutors")}return t},o=r.Model.extend({load:function(t){this.set("uqry",t.query),e.ajax({url:this.url,type:"get",dataType:"json",timeout:3e3,data:{query:t.query,filters:this.filters,bookcount:"undefined"!=typeof this.bookcount?this.bookcount:4,tbscount:"undefined"!=typeof this.tbscount?this.tbscount:3,count:this.filters.count?this.filters.count:null,source:"group",destination:this.filters.destination,trackid:this.trackid,strackid:this.sessionTrackid,token:C.global.csrfToken},context:this,success:function(t){this.set("searchResult",e.extend(t,{})),null==t||0==t.count?this.trigger("failToLoad"):(this.set("trackId",t.trackId),this.trigger("loaded"))},error:function(e){this.trigger("failToLoad")}})},setup:function(e){this.url=e.ajaxEndpoint,s.has(e,"bookcount")&&(this.bookcount=e.bookcount),s.has(e,"tbscount")&&(this.tbscount=e.tbscount),this.target=e.target,this.filters=e.filters,this.set("filters",this.filters),this.set("target",this.target)},setTrackIds:function(){n.find("C.search.trackid").on("track ids",e.proxy(function(e,t){this.trackid=t.trackid,this.sessionTrackid=t.strackid,this.set("strackid",this.sessionTrackid),this.set("trackId",this.trackid)},this)).trigger("get track ids")},initialize:function(){}}),a=r.View.extend({initialize:function(){this.fullWidth=!1,this.positionResultsAbove=!1,this.searchResultFormatType="",this.model=new o,this.model.on("loaded",this.render,this),this.model.on("failToLoad",this.renderError,this),n.find(this).on("update",this.update).on("render",this.setup).on("show",this.show).on("hide",this.hide).on("show a single segway",e.proxy(function(e,t){this.singleCategory=t},this)).on("show no segways",e.proxy(function(){this.singleCategory="none"},this)).on("set width to size of input field",e.proxy(function(e,t){this.fullWidth=!0},this)).on("position above target",e.proxy(function(e,t){this.positionResultsAbove=!0},this)).on("set search result format type",this.setSearchResultFormatType,this).on("set search list bottom content",this.setSearchListBottomContent);var t=n.create("C.Eggshell.window.resize.tracker");t.on("resize",this.handleResize,this),this.mouseInDropdown=!1},render:function(){this.model.setTrackIds(),this.sessionTrackid=this.model.get("strackid"),this.trackid=this.model.get("trackId");var t=this.model.get("searchResult").searchResult;e(".searchList").remove(),this.$el.append(e('<ul class="searchList" tabindex="1"></ul>')),this.$el.addClass(this.searchResultFormatType),this.$searchList=this.$el.find(".searchList"),this.getSearchCategories();var s=0;this.rank=this.singleCategory?1:4;for(result in t)if("up"===this.model.get("filters").variant)for(var i=t[result].length-1;i>=0;i--)this.renderSearchResult(result,t,i,s);else for(var i=0;i<t[result].length;i++)this.renderSearchResult(result,t,i,s);this.searchListBottomContent&&e(this.searchListBottomContent).appendTo(this.$searchList),this.show(),this.searchListHeight=this.$searchList.height(),this.handleResize(),n.find(this).trigger("rendered")},renderSearchResult:function(t,s,i,r){"undefined"!=typeof s[t][i].url&&(s[t][i].url+=this.getTrackUrl(s[t][i],++r),s[t][i].url+="&event=click_submit",s[t][i].searchBy=this.model.get("uqry")),s[t][i].type.replace(" ","_"),this.rank++,0==i?(this.$searchList.append(e('<li class="searchDivider"></li>')),this.$searchList.append(e('<li class="category"><div class="category-name"><span>'+s[t][i].type+"</span></div></li>")),n.create(s[t][i].component,{el:e('<li class="item-result first" id='+s[t][i].id+"></li>").appendTo(this.$searchList)}).trigger("render",s[t][i])):n.create(s[t][i].component,{el:e('<li class="item-result" id='+s[t][i].id+"></li>").appendTo(this.$searchList)}).trigger("render",s[t][i])},getTrackUrl:function(e,t){return"?trackid="+e.trackid+"&strackid="+this.sessionTrackid+"&autosuggest=1&ii="+t+"&uqry="+this.model.get("uqry")},getSearchCategories:function(){var e=this.trackid,t=this.model.get("uqry"),s="?trackid="+e+"&strackid="+this.sessionTrackid,r=encodeURIComponent(t),n={url:"search/"+r+"/books/"+s,type:"Books"},o={url:"search/"+r+"/textbook-solutions/"+s,type:"Textbook Solutions"},a={url:"search/"+r+"/questions-and-answers/"+s,type:"Q&A"},l={url:"search/"+r+"/tutors/"+s,type:"Tutors"},c={"textbook-solutions":function(){return[o,a,l,n]},"questions-and-answers":function(){return[a,o,l,n]},tutors:function(){return[l,a,o,n]},"single-books":function(){return[n]},"single-tbs":function(){return[o]},"single-qna":function(){return[a]},"single-tutors":function(){return[l]},none:function(){return[]}};if(this.singleCategory)var h=this.singleCategory;else var h=i();var d=c[h]&&c[h]()||[n,o,a,l];this.createCategory(d,t)},createCategory:function(t,s){for(var i=0;i<t.length;i++)rank=i+1,n.create("C.common.search.result.category",{el:e('<li class="item-result category-result"></li>').appendTo(this.$searchList)}).trigger("render",{url:t[i].url,searchBy:s,type:t[i].type})},handleResize:function(){var t=this.model.get("target");this.$searchList=this.$el.find(".searchList"),this.searchListHeight>e(window).height()-100?this.$searchList.height(e(window).height()-100):this.$searchList.height("100%"),this.fullWidth?this.$searchList.width(t.outerWidth()):"left-aligned"===this.searchResultFormatType?this.$searchList.width(t.outerWidth()+130):this.$searchList.width(t.outerWidth()+115),this.$(".result-header, .result-sub-header, .result-detail").css("maxWidth",(.8*t.width()|0)+"px")},show:function(){this.$el.css({display:"block"})},hide:function(){e(".C-common-search-groupV1_6").css({display:"none"})},setup:function(s,i){var r={};this.trackid||(this.model.setTrackIds(),this.sessionTrackid=this.model.get("strackid"),this.trackid=this.model.get("trackId")),this.trackid,t.extend(r,i),r.target.prev().click(e.proxy(function(e){n.find("C.global.header.rightsection.usermenu").trigger("hide menu"),n.find("C.global.header.searchbox").trigger("collapse search box");var t=encodeURIComponent(r.target.val());if("undefined"!=typeof this.model.get("filters").destination){if(this.model.get("searchResult")&&"undefined"!=typeof this.model.get("searchResult").count)var s=this.model.get("searchResult").count;else var s=0;C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+t+"&destination="+this.model.get("filters").destination+"&count="+s+"&trackid="+this.trackid+"&strackid="+this.sessionTrackid+"&event=button_submit")}else C.utility.navigate(C.global.cheggSiteUrl+"search/"+t+"/books/?trackid="+this.trackid+"&strackid="+this.sessionTrackid+"&event=button_submit");return!1},this)),r.target.next().click(e.proxy(function(e){this.resetSearch(e,r.target)},this)),r.target.keyup(e.proxy(function(e){this.onKeyUp(e)},this)),r.target.click(e.proxy(function(e){this.onKeyUp(e)},this)),r.target.blur(e.proxy(function(e){this.onTextboxBlur(e,r)},this)),this.model.setup(r);
var o=this.model.get("target");e(o).bind("paste",e.proxy(function(t){var s=e(t.target).val();s.length>0&&e(t.target).next().show(),s.length>=2&&this.load({query:s})},this))},renderError:function(){this.$el.find(".searchList").remove(),this.$el.append(e('<ul class="searchList"></ul>')),this.$searchList=this.$el.find(".searchList"),this.getSearchCategories(),this.searchListHeight=this.$searchList.height();var t=this.model.get("target");this.$searchList.height("100%"),this.fullWidth?this.$searchList.width(t.outerWidth()):this.$searchList.width(t.width()+105+30-2),this.show()},load:function(e){this.model.load(e)},update:function(e,t){this.model.setup(t)},resetSearch:function(e,t){e.preventDefault(),t.val(""),t.next().hide(),this.$currentSelectedItem=null},onMouseOverSelection:function(t){var s=e(t.target).closest(".item-result");s.length&&(this.$el.find(".searchList").find(".item-result").removeClass("selected"),s.addClass("selected")),this.changeSelection(s)},onSelectionClick:function(t){if(this.trackid||(this.model.setTrackIds(),this.sessionTrackid=this.model.get("strackid"),this.trackid=this.model.get("trackId")),this.model.get("trackId"),null==this.$currentSelectedItem){var s=encodeURIComponent(e(t.target).val()),i=this.trackid;if("undefined"!=typeof this.model.get("filters").destination){if(this.model.get("searchResult")&&"undefined"!=typeof this.model.get("searchResult").count)var r=this.model.get("searchResult").count;else var r=0;C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+s+"&destination="+this.model.get("filters").destination+"&count="+r+"&trackid="+i+"&strackid="+this.sessionTrackid+"&event=enter_submit")}else C.utility.navigate(C.global.cheggSiteUrl+"search/"+s+"/books/?trackid="+i+"&strackid="+this.sessionTrackid+"&event=enter_submit")}else{var n=this.$currentSelectedItem.find("a").attr("href"),o="",a=/^https?:\/\//;o=a.test(n)?n:C.global.cheggSiteUrl+n,C.utility.navigate(o)}return this.hide(),!1},onKeyUp:function(t){n.find("C.search.trackid").trigger("interacting with autosuggest");var s=e(t.target).val();40==t.keyCode?(this.doNextSelection(t),t.preventDefault()):38==t.keyCode?(this.doPrevSelection(t),t.preventDefault()):27==t.keyCode?this.hide():13==t.keyCode?(this.onSelectionClick(t),this.$currentSelectedItem=null):46==t.keyCode||8==t.keyCode?s.length<3?this.hide():0==s.length?e(t.target).next().hide():this.load({query:s}):(s.length>0&&e(t.target).next().show(),s.length>=2&&this.load({query:s}))},bottomListItemTemplate:s.template('<li class="bottom-content"><%= opts.content %></li>'),events:{"MSPointerDown .item-result a":"onSelectionClick","mouseover .item-result":"onMouseOverSelection","click .item-result a":"onSelectionClick","keydown .searchList":"onKeyUp","mouseenter .searchList":"onMouseEnter","mouseleave .searchList":"onMouseLeave","click .view-all-link":"onClickViewAll","mouseenter .bottom-content":"onMouseEnterBottomContent"},onTextboxBlur:function(e,t){this.mouseInDropdown||t.target.is(":focus")||(this.hide(),this.$currentSelectedItem=null)},onMouseEnter:function(){this.mouseInDropdown||(this.mouseInDropdown=!0)},onMouseLeave:function(){this.mouseInDropdown&&(this.mouseInDropdown=!1),this.$currentSelectedItem=null,this.$el.find(".searchList").find(".item-result").removeClass("selected")},doNextSelection:function(t){var s=this.$el.find(".searchList").find(".item-result"),i=s.index(this.$el.find(".searchList").find(".selected"));if(s.removeClass("selected"),-1==i||i>=s.length-1)var r=s.eq(0).addClass("selected");else var r=s.eq(i+1).addClass("selected");this.changeSelection(r);var n=this.$currentSelectedItem.offset().top-82;0>n&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+n);var o=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+e(".chg-system-message").height()+e(".chg-header").height());o>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+o)},doPrevSelection:function(t){var s=this.$el.find(".searchList").find(".item-result"),i=s.index(this.$el.find(".searchList").find(".selected"));if(s.removeClass("selected"),-1==i||0===i)var r=s.eq(s.length-1).addClass("selected");else var r=s.eq(i-1).addClass("selected");this.changeSelection(r);var n=this.$currentSelectedItem.offset().top-82;0>n&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+n);var o=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+e(".chg-system-message").height()+e(".chg-header").height());o>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+o)},onClickViewAll:function(e){var t=this.model.get("target"),s=encodeURIComponent(t.val()),i=this.sessionTrackid;C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+s+"&destination="+this.model.get("filters").destination+"&trackid="+i+"&strackid="+this.sessionTrackid+"&event=click_submit")},onMouseEnterBottomContent:function(e){this.$el.find(".searchList").find(".item-result").removeClass("selected")},changeSelection:function(e){this.$currentSelectedItem=e},setSearchResultFormatType:function(e,t){if(!t||"string"!=typeof t)throw"Invalid format type. Format type must be of type string";"left-aligned"===t&&(this.searchResultFormatType="left-aligned")},setSearchListBottomContent:function(e,t){this.searchListBottomContent=null,t&&t.html&&(this.searchListBottomContent=this.bottomListItemTemplate({opts:{content:t.html}}))}});return a}()),n.define("C.common.search.list",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"object",filters:"object",source:"string",token:"string"}},show:{payload:null},hide:{payload:null},update:{payload:{query:"string"}},"go to the next search result":{payload:null},"go to the previous search result":{payload:null},"disable auto resize":{payload:null}},outputs:{},strict:!1},function(){var s=r.Model.extend({load:function(t){this.set("uqry",t.query),e.cjax({url:this.url,type:"get",dataType:"json",timeout:3e3,data:{query:t.query,filters:this.filters,source:this.source,format:this.filters.format,token:this.token},context:this,success:function(e){this.set("searchResult",e),"undefined"!=typeof e.trackId&&(C.global.pageObject.opts.searchTrackId=e.trackId),this.trigger("loaded")},error:function(e){this.trigger("failToLoad")}})},setup:function(e){this.url=e.ajaxEndpoint,this.target=e.target,this.filters=e.filters,this.source=e.source?e.source:null,this.token=e.token,this.set("target",this.target)}}),i=r.View.extend({initialize:function(){this.model=new s,this.model.on("loaded",this.render,this),this.model.on("failToLoad",this.renderError,this),this.model.on("list loaded",this.postRender,this),n.find(this).on("update",this.load).on("render",this.setup).on("show",this.show).on("hide",this.hide);var e=n.create("C.Eggshell.window.resize.tracker");e.on("resize",this.handleResize,this),this.mouseInDropdown=!1},postRender:function(){var e=this.model.get("searchResult").trackId,t=encodeURIComponent(this.model.target.val());if("tbsglass"===this.model.source){var s=C.global.cheggSiteUrl+"search/"+t+"/textbook-solutions?trackid="+e;this.$searchlist.append('<li><a href="'+s+'"><div class="tbs-view-all">View all search results</div></a></li>')}else if("qnaglass"===this.model.source){var s=C.global.cheggSiteUrl+"search/"+t+"/questions-and-answers?trackid="+e;this.$searchlist.append('<li class="qna-view-all"><a href="'+s+'">View all search results</a><input type="button" class="btn-secondary-sm post-question-button" value="Post new question"/></li>')}this.show()},render:function(){var t="",s=this.model.source;if(t="tbsglass"===s?"tbs":"qnaglass"===s?"qna":"textbooks"===s?"textbooks":"tutor","textbooks"==t)var i=this.model.get("searchResult");else var i=this.model.get("searchResult").searchResult[t];e(".search-list").remove(),this.$el.append('<ul class="search-list"></ul>'),this.$searchlist=e(".search-list");for(var r=this.model.filters.count?this.model.filters.count:5,o=i.length<r?i.length:r,a=0;o>a;a++)0==a&&e(".item-result").addClass("first"),"qnaglass"===s&&this.trimText(i[a]),"tutorsglass"===s&&(i[a].component="C.common.search.result.subject"),i[a].searchBy=this.model.get("uqry"),n.create(i[a].component,{el:e('<li class="item-result" id='+i[a].id+"></li>").appendTo(this.$searchlist)}).trigger("render",i[a]);this.handleResize(),this.trigger("list loaded")},trimText:function(e){e.transcribedData?e.transcribedData.length>130&&(e.transcribedData=e.transcribedData.substring(0,130)+"..."):e.text.length>130&&(e.text=e.text.substring(0,130)+"...")},handleResize:function(){var e=this.model.get("target");this.$searchlist&&(void 0!==this.model.filters.listPadding?this.$searchlist.width(e.width()+this.model.filters.listPadding):"textbooks"==this.model.source?this.$searchlist.width(e.width()+32):this.$searchlist.width(e.width()+20)),this.$(".result-header, .result-sub-header, .result-detail").css("maxWidth",e.width()-70+"px")},show:function(){e(".C-common-search-list").css({visibility:"visible",opacity:"1",display:"block"})},hide:function(){e(".C-common-search-list").css({visibility:"hidden"})},setup:function(s,i){var r={};t.extend(r,i),r.target.prev().click(e.proxy(function(e){var t=this.getDestination(),s=encodeURIComponent(r.target.val());return C.utility.navigate(C.global.cheggSiteUrl+"search/"+s+"/"+t),!1},this)),r.target.next().click(e.proxy(function(e){this.resetSearch(e,r.target)},this)),r.target.keyup(e.proxy(function(e){this.onKeyUp(e)},this)),r.target.click(e.proxy(function(e){this.onKeyUp(e)},this)),r.target.blur(e.proxy(function(e){this.onTextboxBlur(e,r)},this)),this.model.setup(r)},renderError:function(){e(".search-list").remove(),this.$el.append(e('<ul class="search-list"></ul>')),this.$searchlist=e(".search-list"),this.getSearchCategories();var t=this.model.get("target");this.$searchlist.height(115),this.$searchlist.width(t.width()+105+30+15+20)},load:function(e){this.model.load(e)},resetSearch:function(e,t){e.preventDefault(),e.stopPropagation(),t.val(""),t.next().hide(),this.$currentSelectedItem=null},onMouseOverSelection:function(t){var s=e(t.target).closest(".item-result");s.length&&(e(".search-list").find(".item-result").removeClass("selected"),s.addClass("selected")),this.changeSelection(s)},onMouseOutSelection:function(t){var s=e(t.target).closest(".item-result");s.removeClass("selected")},generateTrackId:function(){var e=Math.abs(4294967295*Math.random()<<0).toString(16);return("000000000"+e).slice(-8)},onSelectionClick:function(t){if(this.hide(),null==this.$currentSelectedItem){if("tutorsglass"!==this.model.source){var s=encodeURIComponent(e(t.target).val()),i=this.getDestination(),r=this.model.get("searchResult").trackId;"undefined"==typeof r&&(r=this.generateTrackId()),C.utility.navigate(C.global.cheggSiteUrl+"search/"+s+"/"+i+"?trackid="+r)}return!1}var n=this.$currentSelectedItem.find("a").attr("href");return n&&C.utility.navigate(C.global.cheggSiteUrl+n),!1},onKeyUp:function(t){var s=e(t.target).val();t.stopPropagation(),40==t.keyCode?(this.doNextSelection(t),t.preventDefault(),this.trigger("go to the next search result")):38==t.keyCode?(this.doPrevSelection(t),t.preventDefault(),this.trigger("go to the previous search result")):27==t.keyCode?(this.hide(),this.trigger("hide")):13==t.keyCode?(this.onSelectionClick(t),this.hide(),this.$currentSelectedItem=null):46==t.keyCode||8==t.keyCode?s.length<3?(this.hide(),0==s.length&&e(t.target).next().hide()):(this.load({query:s}),this.show()):(s.length>0&&e(t.target).next().show(),s.length>=2&&(this.load({query:s}),this.show()))},events:{"mouseover .item-result":"onMouseOverSelection","mouseout .item-result":"onMouseOutSelection","click .item-result a":"onSelectionClick","keydown .search-list":"onKeyUp","mouseenter .search-list":"onMouseEnter","mouseleave .search-list":"onMouseLeave"},hideResults:function(){e(".search-list").hide()},onTextboxBlur:function(e,t){this.mouseInDropdown||t.target.is(":focus")||(this.hide(),this.$currentSelectedItem=null)},onMouseEnter:function(){this.mouseInDropdown||(this.mouseInDropdown=!0)},onMouseLeave:function(){this.mouseInDropdown&&(this.mouseInDropdown=!1),this.$currentSelectedItem=null,e(".search-list").find(".item-result").removeClass("selected")},doNextSelection:function(t){var s=e(".search-list").find(".item-result"),i=s.index(e(".search-list").find(".selected"));if(s.removeClass("selected"),-1==i||i>=s.length-1)var r=s.eq(0).addClass("selected");else var r=s.eq(i+1).addClass("selected");this.changeSelection(r)},doPrevSelection:function(t){var s=e(".search-list").find(".item-result"),i=s.index(e(".search-list").find(".selected"));if(s.removeClass("selected"),-1==i||0===i)var r=s.eq(s.length-1).addClass("selected");else var r=s.eq(i-1).addClass("selected");this.changeSelection(r)},changeSelection:function(e){this.$currentSelectedItem=e},getDestination:function(){switch(this.model.source){case"tbsglass":return"textbook-solutions";case"qnaglass":return"questions-and-answers";case"textbooks":return"books"}return!1}});return i}()),n.define("C.common.search.serp.book",{inputs:{render:{payload:{id:"string",component:"C.common.search.serp.book",url:"string",thumbnail:"string",title:"string",author:"string",isbn:"string",isbn13:"string",groupName:"string",isFirst:"boolean",type:"string"}}},outputs:{},strict:!1},function(){var e=r.View.extend({initialize:function(){n.find(this).on("render",this.render),this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(e,t){this.$el.html(this.template({book:{id:t.id,url:t.url,title:t.title+(t.editionNo?" ("+this.toOrdinal(t.editionNo)+" Edition)":""),subtitle:!!t.subtitle&&t.subtitle,author:t.author,isbn13:t.isbn13,isbn:t.isbn}})),n.create("C.common.bookcover",{el:this.$el.find(".book-cover-container")}).trigger("set book image",t.thumbnail).trigger("set book cover size","medium")},toOrdinal:function(e){var t=e%10;return 1==t&&11!=e?e+"st":2==t&&12!=e?e+"nd":3==t&&13!=e?e+"rd":e+"th"},template:s.template('<div class="book-result"><div class="result-data"><a href="<%= book.url %>"><span class="book-cover-container"></span><div class="result-info"><div class="left-info"><span class="result-title"><%= book.title %></span><% if(book.subtitle!=false){%><span class="result-sub-header"><%= book.subtitle %></span><% } %><span class="result-detail author"><strong>Author: </strong><%= book.author %></span><span class="result-detail"><strong>ISBN: </strong><span class="isbn"><%= book.isbn %></span><span class="result-detail-isbn13"><strong> ISBN13: </strong><%= book.isbn13 %></span></span><% if(typeof(meta)!= "undefined" && _.size(meta) != 0){ %><div class="results-meta"><%= meta %></div><% } %></div><div class="price-info"><span class="result-title"><strong>Rent </strong><span class="price">$54.49</span></span><span class="result-sub-header">List price: $229.95</span><span class="result-detail">Other: <strong>Buy | eTextbbok </span></div></div></a></div></div>')});return e}()),n.define("C.common.search.serp.filter",{inputs:{"set tab options":{payload:"object"},"set selected filter":{payload:"string"},render:{payload:null}},outputs:{"filter selected":{payload:"string"},rendered:{payload:null}}},function(){var t=r.Model.extend({initialize:function(){this.set("currentTab",null),this.set("tabs",[])}}),i=r.View.extend({tmpl:s.template('<ul><li class="title"><%- title %></li><% _.each(tabs, function(tab, key) { %> <li class="<% if(tab.class){ %><%-tab.class%><% } %><% if(currentTab == key){ %> active<% } %>" data-id="<%- key %>"><a href="<%- tab.url %>"><%- tab.name %></a></li><%}) %></ul>'),events:{"click ul li[data-id] a":"tabClick"},initialize:function(){this.model=new t,n.find(this).on("set tab options",this.setTabOptions).on("set selected filter",this.setSelectedFilter).on("render",this.render)},render:function(e,t){this.$el.prepend(this.tmpl({title:C.resource.fetch("C.common.search.serp.filter.title"),tabs:this.model.get("tabs"),currentTab:this.model.get("currentTab")})),n.find(this).trigger("rendered")},setTabOptions:function(e,t){if(!t)throw"Empty payload";this.model.set("tabs",t),s.size(t)>0&&this.model.set("currentTab",s.pairs(t)[0])},setSelectedFilter:function(e,t){this.model.set("currentTab",t),this.$("ul li[data-id]").removeClass("active"),this.$('ul li[data-id="'+t+'"]').addClass("active")},tabClick:function(t){var s=e(t.currentTarget).parent("li[data-id]").data("id");this.model.get("currentTab")!=s&&(this.setSelectedFilter(t,s),n.find(this).trigger("filter selected",s))}});return i}()),n.define("C.common.search.serp.header",{inputs:{render:{payload:{count:"string",trackid:"string",strackid:"string"}}},outputs:{"search result item clicked":{payload:"object"}},strict:!1},function(){var t=r.View.extend({initialize:function(){n.find(this).on("render",this.render)},render:function(e,t){var s=this.getQuery();t.count>500&&(t.count="500+"),this.$el.prepend(this.template({headline:{count:t.count,trackid:t.trackid,strackid:t.strackid,query:decodeURIComponent(s),urlquery:s}})),this.getSelectedTab()},onTabClick:function(t){t.preventDefault();var s=e(t.target).find("a").attr("href");return C.utility.navigate(C.global.cheggSiteUrl+s),!1},getSelectedTab:function(){var e=window.location.pathname;if(-1!==e.indexOf("/")){var t=e.split("/"),s=t[3];"books"==s?this.$el.find(".books").addClass("selected"):"textbook-solutions"==s?this.$el.find(".textbook-solutions").addClass("selected"):"questions-and-answers"==s?this.$el.find(".questions-and-answers").addClass("selected"):"tutors"==s&&this.$el.find(".tutors").addClass("selected")}},getQuery:function(){var e=window.location.pathname,t="";if(-1!==e.indexOf("/")){var s=e.split("/");t=s[2]}return t},events:{"click .serp-single-tab a":"onTabClick"},template:s.template('<div class="serp-header"><div class="serp-tabs"><a href="/search/<%-headline.urlquery%>/books?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>&event=filter_select" class="serp-single-tab books"><h2>Books</h2></a><a href="/search/<%-headline.urlquery%>/textbook-solutions?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>&event=filter_select" class="serp-single-tab textbook-solutions"><h2>Textbook Solutions</h2></a><a href="/search/<%-headline.urlquery%>/questions-and-answers?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>&event=filter_select" class="serp-single-tab questions-and-answers"><h2>Q&A</h2></a><a href="/search/<%-headline.urlquery%>/tutors?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>&event=filter_select" class="serp-single-tab tutors"><h2>Tutors</h2></a></div><div class="result-details"><h2><span class="result-count"><%- headline.count %> </span>results for<span class="result-query"> <%- headline.query %></span></h2></div></div>')});return t}()),n.define("C.common.search.serp.qna",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){var t=r.View.extend({initialize:function(){n.find(this).on("render",this.render),this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(e,t){var s="undefined"!=typeof t.transcribedData?t.transcribedData:t.text,i=s.length>440?s.slice(0,440)+"...":s,r=this.getHighlightedText(i,t.searchBy);this.$el.html(this.qnaTemplate({qna:{id:t.id,text:r,answerCountText:t.answerCount+" Answer"+(t.answerCount<=1?"":"s"),url:t.url,title:t.title,itemId:t.itemId}}))},getHighlightedText:function(e,t){var s=t?t:decodeURIComponent(location.pathname.split("/")[2]),i=new RegExp(s,"i");return e.replace(i,"<span class='highlighted-text'>"+s+"</span>")},qnaTemplate:s.template('<div class="qna-item"><p class="qna-text"><%= qna.text %></p><p class="answer-count"><a href="<%= qna.url %> "><%= qna.answerCountText %></a></p></div>'),onClickSerpItem:function(t){var s=t.currentTarget,i=e(s).find(".answer-count a").attr("href");C.utility.navigate(i)},events:{"click .qna-item":"onClickSerpItem"}});return t}()),n.define("C.common.search.serp.tbs",{inputs:{render:{payload:{id:"string",component:"string",url:"string",title:"string",long_title:"string",author:"string",isbn:"string",ean:"string",edition_no:"string",solutionCount:"string",subtitle:"string"}}},outputs:{},strict:!1},function(){var t=r.View.extend({initialize:function(){n.find(this).on("render",this.render),this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(e,t){this.highlightText(t),this.$el.html(this.tbsTemplate({tbs:{id:t.id,url:t.url.substring(1,t.url.length),coverTitle:t.title,title:this.title+(t.edition_no?" ("+this.toOrdinal(t.edition_no)+" Edition)":""),subtitle:!!this.subtitle&&this.subtitle,author:this.truncateAuthors(t.author),isbn:t.isbn,long_title:!!t.long_title&&t.long_title,isbn13:!!t.ean&&t.ean}})),this.adjustBookCoverTitleLength()},truncateAuthors:function(e){if(null==e)return"";var t=e.split(" ; "),s=t[0];return s+=t[1]?"; "+t[1]:""},adjustBookCoverTitleLength:function(){for(var t=this.$(".book-title-text"),s=this.$(".book-title").height();e(t).outerHeight()>s;)e(t).text(function(e,t){return t.replace(/\W*\s(\S)*$/,"...")})},highlightText:function(e){var t='<span class="chg-suggest-term"> $1</span>',s=decodeURIComponent(location.pathname.split("/")[2]),i=new RegExp("("+this.regExpQuote(s)+")","i");if(e.title){var r=e.title.replace(i,t);this.title=r}if(e.subtitle){var n=e.subtitle.replace(i,t);this.subtitle=n}},regExpQuote:function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},toOrdinal:function(e){var t=e%10;return 1==t&&11!=e?e+"st":2==t&&12!=e?e+"nd":3==t&&13!=e?e+"rd":e+"th"},tbsTemplate:s.template('<div class="result-data"><a class="row" href="<%= tbs.url %>"><div class="left-info"><div class="book-cover"><div class="book-title"><span class="book-title-text"><%= tbs.coverTitle %></span></div></div></div><div class="right-info"><div class="line-item f-size-05 title"><%= tbs.title %></div><div class="f-size-03 line-item detail"><% if(tbs.subtitle!=false){ %><%= tbs.subtitle %><% } %></div><span class="line-item f-size-02 "><strong>Author: </strong><span class="detail"><%= tbs.author %></span></span><div class="line-item"><span class="isbn f-size-02"><strong>ISBN: </strong><span class="detail margin-left"><%= tbs.isbn %></span></span><span class="isbn13 f-size-02"><strong> ISBN13: </strong><span class="detail margin-left"><%= tbs.isbn13 %></span></span></div></div></a></div>')});return t}()),n.define("C.common.search.serp.tutor",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){var t=r.Model.extend({urlRoot:"/_ajax/tutors",getTutorsBySubject:function(e){var t="undefined"!=typeof e.count?e.count:3,s="undefined"!=typeof e.noSubjectCheck?e.noSubjectCheck:1;return this.fetch({data:{token:C.global.csrfToken,subjectId:e.subjectId,subjectName:e.subjectName,campaign:"Chegg_SERP-tutor-page",limit:t,noSubjectCheck:s}})}}),i=r.View.extend({templates:{tutorCard:s.template('<div class="col-4 <%= cssClassName %>"><%= result %></div>'),viewAll:s.template('<div class="view-all col-4 col-last"><a href="<%= url %>">View All</a></div>'),tutorList:s.template('<div class="tutor-list row"><%= result %></div>'),noTutorAvailable:s.template('<div class="msg-info-lg"><div class="msg-icon"><div class="msg-header">No Tutors Available</div><div class="msg-text">All tutors are offline for this subject currently, please check back later.</div></div></div>')},render:function(t){if(s.isNull(t))var i=this.templates.noTutorAvailable();else{var r=e("<div></div>"),o=t.tutors||[],a=C.utility.getParamsByUrl(t.subjectURL),l=a.trackid,c=a.strackid,h=a.ii;s.each(o,s.bind(function(t,s){var i=s%2==0?"col-first":"col-last",o=e('<div class="tutor-card tutor-row col-4 '+i+'"></div>');n.create("C.common.tutors.tutor",{el:o}).trigger("get tbs tutor",t),tutorLink=o.find("a").attr("href"),o.find("a").attr("href",tutorLink+"&trackid="+l+"&strackid="+c+"&ii="+h),r.append(o)},this)),r.append(this.templates.viewAll({url:t.subjectURL}));var i=this.templates.tutorList({result:r.html()});this.$el.html(i)}}}),o=r.View.extend({subjectTemplate:s.template('<div class="serp-tutor-subject-container row" data-name="<%= subject.nameOriginal %>" id="<%= subject.id %>"><div class="col-4 col-first subject-name"><a href="/tutors/<%= subject.url %>" ><%= subject.name %></a></div><div class="col-8 tutor_list_<%= subject.id %>"><div class="tutor-list row"><div class="view-all tutor-card tutor-row col-4 col-first"></div><div class="view-all tutor-card tutor-row col-4 col-last"></div><div class="view-all tutor-card tutor-row col-4 col-first"></div><div class="view-all col-4 col-last"></div></div></div></div>'),noSubjectTemplate:s.template('<div class="serp-tutor-subject-container row""><div class="msg-info-lg"><div class="msg-icon"><div class="msg-header">Subject not exist ?</div><div class="msg-text">Please try use another subject keyword to search your tutors.</div></div></div></div>'),initialize:function(){n.find(this).on("render",this.render),this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(e,t){t&&t.id&&t.name?(this.$el.html(this.subjectTemplate({subject:{id:t.id,nameOriginal:t.name,name:t.name,url:t.url.replace("?","-online-tutoring/?")}})),this.getTutorsBySubject(t)):this.$el.html(this.noSubjectTemplate())},getTutorsBySubject:function(e){var r=new t,n=r.getTutorsBySubject({subjectId:e.id,subjectName:e.name}),o=new i({el:this.$(".tutor_list_"+e.id)});n.success(s.bind(function(e){s.has(e,"tutors")?o.render({tutors:e.tutors,url:e.url,subjectURL:this.$(".subject-name a").attr("href")}):o.render(null)},this)),n.fail(function(){o.render(null)})}});return o}()),n.define("C.common.search.serp.tutor.mobile",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){var t=r.Model.extend({urlRoot:C.global.cheggSiteSecureUrl+"_ajax/tutors",getTutorsBySubject:function(e){var t="undefined"!=typeof e.count?e.count:3,s="undefined"!=typeof e.noSubjectCheck?e.noSubjectCheck:1,i=this;this.fetch({data:{token:C.global.csrfToken,subjectId:e.subjectId,subjectName:e.subjectName,campaign:"Chegg_SERP-tutor-page",limit:t,noSubjectCheck:s},success:function(e,t){i.trigger("loaded",t)},error:function(){i.trigger("failToLoad")}})}}),i=r.View.extend({temp:{list:s.template('<div class="serp-tutor-subject-container"><div href="/tutors/<%- url %>"><a class="subject-name"><%= name %></a><span class="see_all">See all &rsaquo;</span></div><ul class="tutor-list"></ul></div>'),item:s.template('<li class="tutor-card"></li>')},initialize:function(t){this.$list=e(this.temp.list(t.subject)),this.$el.html(this.$list),this.$list=this.$list.find(".tutor-list")},append:function(t){var s=e(this.temp.item());n.create("C.common.tutors.tutor",{el:s}).trigger("get tbs tutor",t),this.$list.append(s)}}),o=(r.View.extend({temp:{list:s.template('<div class="list"></div>'),item:s.template('<div class="item"></div>')},initialize:function(){this.$list=e(this.temp.list(opts.subject)),this.$el.html(this.$list)},append:function(e){this.$list.append(this.temp.item(e))}}),r.View.extend({initialize:function(){n.find(this).on("render",this.render)},render:function(e,r){if(r&&r.id&&r.name){var n=this.$el.append("<li></li>"),o=new i({el:n,subject:{id:r.id,nameOriginal:r.name,name:r.name,url:r.url.replace("?","-online-tutoring/?")}}),a=new t;a.on("loaded",function(e){"tutors"in e&&s.each(e.tutors,function(e){o.append(e)})}),a.on("failToLoad",function(){}),a.getTutorsBySubject({subjectId:r.id,subjectName:r.name})}}}));return o}()),n.define("C.common.search.result.book",{inputs:{render:{payload:{id:"string",component:"C.common.search.result.book",url:"string",thumbnail:"string",title:"string",author:"string",isbn:"string",ean:"string",groupName:"string",isFirst:"boolean",type:"string"}}},outputs:{},strict:!1},function(){var e=r.View.extend({initialize:function(){n.find(this).on("render",this.render),this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(e,t){this.hightLightText(t),this.$el.html(this.template({book:{id:t.id,component:"C.common.search.result.book",url:t.url,thumbnail:t.cover,title:this.title+(t.edition_no?' <span class="result-header-small">('+this.toOrdinal(t.edition_no)+" Edition)</span>":""),subtitle:!!this.subtitle&&this.subtitle,detail:this.renderAuthor(t.author)+this.bulletSeperatorHTML+"ISBN: "+t.isbn+this.bulletSeperatorHTML+"ISBN13: "+t.ean}})),n.create("C.common.bookcover",{el:this.$el.find(".book-cover-container")}).trigger("set book image",t.cover).trigger("turn off shadow")},renderAuthor:function(e){if("undefined"!=typeof e){var t=e.split(";"),s=t[0];return s}return""},hightLightText:function(e){var t='<span class="chg-suggest-term">$1</span>',s=e.searchBy,i=new RegExp("("+this.regExpQuote(s)+")","i");if(e.title){var r=e.title.replace(i,t);this.title=r}if(e.subtitle){var n=e.subtitle.replace(i,t);this.subtitle=n}if(this.details){var o=this.details.replace(i,t);this.details=o}},regExpQuote:function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},toOrdinal:function(e){var t=e%10;return 1==t&&11!=e?e+"st":2==t&&12!=e?e+"nd":3==t&&13!=e?e+"rd":e+"th"},template:s.template('<div class="book-result"><div class="result-data"><a href="<%= book.url %>"><span class="book-cover-container small bookcover-seo-mini"></span><div class="result-info"><span class="result-header"><%= book.title %></span><% if(book.subtitle!=false){%><span class="result-sub-header"><%= book.subtitle %></span><% } %><span class="result-detail"><%= book.detail %></span></div></a></div></div>')});return e}()),n.define("C.common.search.result.category",{inputs:{render:{payload:{component:"string",id:"string",searchBy:"string",type:"string",url:"string"}}},outputs:{},strict:!1},function(){var t=r.View.extend({initialize:function(){n.find(this).on("render",this.render)},render:function(t,s){var i=s.searchBy.charAt(0).toUpperCase()+s.searchBy.slice(1);i=e("<div/>").text(i).html();var r=s.url+"&event=filter_submit&filterloc=segue";this.$el.append(e('<a href="'+r+'"><div class="search-link"><div class="icon-chegg-search"></div><span class="chg-suggest-term search-query">'+i+'</span><span class="search-type"> in '+s.type+"</span></div></a>"))}});return t}()),n.define("C.common.search.result.default",{inputs:{render:{payload:{id:"string",component:"C.common.search.list.default",url:"string",type:"string",thumbnail:"string",title:"string",desc:"string"}}},outputs:{},strict:!0},function(){var e=r.View.extend({initialize:function(){n.find(this).on("render",this.render)},render:function(){},events:{}});return e}()),n.define("C.common.search.result.qna",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){var t=r.View.extend({initialize:function(){n.find(this).on("render",this.render),this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(e,t){var s="undefined"!=typeof t.transcribedData?t.transcribedData:t.text,i=this.getHighlightedText(s,t.searchBy);this.$el.html(this.qnaTemplate({qna:{id:t.id,text:i,answerCountText:t.answerCount+" Answer"+(t.answerCount<=1?"":"s"),url:t.url,title:t.title,itemId:t.itemId}})),this.$el.find(".qna-text").dotdotdot()},getHighlightedText:function(e,t){return regex=new RegExp(t,"gi"),e.replace(regex,"<span class='highlighted-text'>"+t+"</span>")},qnaTemplate:s.template('<div class="qna-item"><p class="qna-text f-size-03"><%= qna.text %></p><p class="answer-count"><a href="<%= qna.url %> "><%= qna.answerCountText %></a></p></div>'),onClickSerpItem:function(t){var s=t.currentTarget,i=e(s).find(".answer-count a").attr("href");C.utility.navigate(i)},events:{"click .qna-item":"onClickSerpItem"}});return t}()),n.define("C.common.search.result.tbs",{inputs:{render:{payload:{id:"string",component:"string",url:"string",title:"string",ean:"string",isbn:"string",author:"string",subtitle:"string",edition_no:"string",solutioncount:"string",group:"string",isFirst:"string",type:"string"}}},outputs:{},strict:!1},function(){var e=r.View.extend({initialize:function(){n.find(this).on("render",this.render)},render:function(e,t){this.highlightText(t),this.$el.html(this.tbsTemplate({tbs:{id:t.id,component:t.component,searchBy:t.searchBy,
url:t.url.substring(1,t.url.length),isbn:t.isbn,isbn13:t.ean,author:this.truncateAuthors(this.author),subtitle:!!this.subtitle&&this.subtitle,title:this.title,edition:t.edition_no?"("+this.toOrdinal(t.edition_no)+" Edition)":""}}))},events:{mouseenter:"onMouseEnterTBSResult",mouseleave:"onMouseLeaveTBSResult"},truncateAuthors:function(e){var t=e;if("undefined"!=typeof e){var s=e.split(" ; ");t=s[0]}return t},highlightText:function(e){var t='<span class="chg-suggest-term">$1</span>',s=e.searchBy,i=new RegExp("("+this.regExpQuote(s)+")","i");if(e.title){var r=e.title.replace(i," "+t);this.title=r}if(e.subtitle){var n=e.subtitle.replace(i," "+t);this.subtitle=n}if(e.author){var o=e.author.replace(i,t);this.author=o}},regExpQuote:function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},toOrdinal:function(e){var t=e%10;return 1===t&&11!==e?e+"st":2===t&&12!==e?e+"nd":3===t&&13!==e?e+"rd":e+"th"},onMouseEnterTBSResult:function(e){this.$el.addClass("tbs-highlight")},onMouseLeaveTBSResult:function(e){this.$el.removeClass("tbs-highlight")},tbsTemplate:s.template('<div class="result-data"><a href="<%= tbs.url %>"><div class="left-info"><div class="book-cover"></div></div><div class="right-info"><span class="result-header"><%= tbs.title %>&nbsp;&nbsp;<span class="result-edition"><%= tbs.edition %></span></span><% if(tbs.subtitle!=false){%><span class="result-sub-header"><%= tbs.subtitle %></span><% } %><span class="result-detail"><%= tbs.author %>&nbsp;&bull;&nbsp;ISBN: <%= tbs.isbn %>&nbsp;&bull;&nbsp;ISBN13: <%= tbs.isbn13 %></span></div></a></div>')});return e}()),n.define("C.common.search.result.tutor",{inputs:{render:{payload:{id:"string",url:"string",name:"string",searchBy:"string"}}},outputs:{},strict:!1},function(){var t=r.View.extend({initialize:function(){n.find(this).on("render",this.render)},render:function(t,s){var i=this.renderUrl(s.url);this.$el.html(this.subjectTemplate({subject:{id:s.id,url:i,nameOriginal:s.name,name:this.highlightText(s)}})),e(".C-common-search-groupV1_6 .category-name").css("padding-top","10px")},renderUrl:function(e){var t=e.substr(0,e.indexOf("?")),s=e.substr(e.indexOf("?"));return e=C.global.instaEdu?"tutors/"+t+"-online-tutoring/"+s:"search/"+t+"/tutors"+s,e=C.global.liveSiteUrl+e},highlightText:function(e){var t='<span class="highlighted-text">$1</span>',s=e.searchBy,i=new RegExp("("+this.regExpQuote(s)+")","i");return e.name.replace(i,t)},regExpQuote:function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},subjectTemplate:s.template('<a href="<%= subject.url %>"><div class="tutor-subject-result" data-name="<%= subject.nameOriginal %>" id="<%= subject.id %>"><%= subject.name %></div></a>')});return t}()),n.define("C.search.mobile.FederatedSearch",{inputs:{find:{query:"string",filter:"string",page:"string"},reset:{},recover:{}},output:{"before find":{query:"string",filter:"string",page:"string"}}},function(){var t=r.View.extend({search:null,track:null,query:null,lastFilter:null,lastPage:null,withoutFed:!1,initialize:function(e){this.$el=e.el,this.withoutFed=e.withoutAllMathes,this.search=n.create("C.common.search",{el:this.$el}),this.track=n.create("C.search.trackid");var t=this;n.create("C.search.configuration").trigger("get mobile filters config",function(e){t.filters=e}),this.Eggshell.listen("find",this.find),this.Eggshell.listen("reset",this.reset),this.Eggshell.listen("recover",this.setFilterListeners),this.Eggshell.listen("destroy",this.destroy),this.setFilterListeners()},find:function(e,t){this.query=t.query;var s=t.filter||this.lastFilter||"all",i=t.page||this.lastPage||null;this.withoutFed&&"all"==s&&(s="books"),this.Eggshell.trigger("before find",{query:this.query,filter:s,page:i});var r=this.getProfile(this.query,s,i);this.search.trigger("set query",{query:this.query}).trigger("render with profile id",{profile:r})},reset:function(){this.lastFilter=null,this.search&&this.search.trigger("hide results")},getProfile:function(e,t,s){var i=e.split(" ").length,r=i>15,n=this.filters[t];return null!==s&&n.filters&&n.filters[s]&&(n=n.filters[s]),r&&n.queryIntentProfileId?n.queryIntentProfileId:n.profileId},setFilterListeners:function(){var t=this,i=s.keys(t.filters);s.each(i,function(e){if(t.$el.on("click.FederatedSearch",'[data-id="'+e+'"]',function(){return n.find(t).trigger("find",{query:t.query,filter:e}),t.lastFilter=e,t.lastPage=null,!1}),s.isObject(t.filters[e].filters)){var i=s.keys(t.filters[e].filters);s.each(i,function(s){t.$el.on("click.FederatedSearch",'[data-id="'+s+'"]',function(){return n.find(t).trigger("find",{query:t.query,filter:e,page:s}),t.lastFilter=e,t.lastPage=s,!1})})}}),t.$el.on("click.FederatedSearch",'[data-id="findByQuery"]',function(){var s=e(this).data("query");return n.find(t).trigger("find",{query:s,filter:t.lastFilter,page:t.lastPage}),!1})},destroy:function(){this.$el.off("click.FederatedSearch"),null!==this.search&&this.search.trigger("destroy"),null!==this.track&&this.track.trigger("destroy")}});return t}()),n.define("C.search.mobile.FederatedSearchbar",{input:["open","close"],output:["opened","closed"]},function(){var t=r.View.extend({actions:["open","close"],current_value:"",init_first:!0,focus_input:!0,history_id:"FederatedSearch",search_title:"Search",active:!1,first_open:!0,history:{name:"federated-search-dialog",set:"open",unset:"close",setEvent:"opened",unsetEvent:"closed"},_searchTpl:s.template('<form class="form" action="javascript:;"><input type="search" class="input" name="search" placeholder="Search by title, author or ISBN"><span class="cancel">Cancel</span></form><div class="results-outer-box"></div>'),test:function(){return!!document.querySelector(".FederatedSearchbar")},initialize:function(){this.$el.html(this._searchTpl()),this.$el.hide(),this.generate(),this.searchDialog=n.create("C.search.mobile.SearchDialog"),this.searchDialog.trigger("set elements",this.elements),n.find(this).on("close search",this.closeSearch).on("on search open",this.onSearchOpen).on("on search close",this.onSearchClose).on("fetch data",this.fetchData),this.attach()},closeSearch:function(){this.active=!1,this.elements.background.show()},generate:function(){var t=this;this.elements={body:e("body"),background:e("section.Page, header.Toolbar"),search_dialog:this.$el,search:e('input[name="search"]',this.$el),results:e(".results-outer-box",this.$el),form:e("form",this.$el),search_icon:e(".Toolbar .search"),cancel:e(".cancel",this.$el),close:e(""),search_handle:e(".open-chegg-oc-search"),search_field:e(".page-searchbar input.open-search")},this.filter=this.elements.search_field.length&&this.elements.search_field.data("filter")?this.elements.search_field.data("filter"):"",this.isNotApp=!this.elements.body.hasClass("in-app"),this.elements.form.attr("action","javascript:;"),this.should_be_hidden=this.$el.hasClass("hidden"),this.federatedSearch=n.create("C.search.mobile.FederatedSearch",{el:this.elements.results,withoutAllMathes:this.$el.hasClass("without-all-matches")}),this.federatedSearch.on("before find",function(e,s){t.elements.results.removeClass("empty-results"),t.elements.search.val(s.query)}),e(this.elements.search_handle).click(function(e){t.active=!0})},onSearchOpen:function(){this.$el.show();var t=this.elements.search.val();this.active&&(this.isNotApp===!0&&this.elements.background.hide(),this.elements.body.css("overflow","hidden"),e(".native-dialog").css("position","absolute"),this.elements.results.addClass("mobile-overflow").addClass("empty-results")),this.Eggshell.trigger("opened"),this.first_open||this.federatedSearch.trigger("recover"),t&&this.federatedSearch.trigger("find",{query:t,filter:this.filter}),this.first_open=!1},onSearchClose:function(){this.elements.body.css("overflow","auto"),e(".native-dialog").css("position","fixed"),this.Eggshell.trigger("closed"),this.elements.results.removeClass("mobile-overflow")},reset:function(){this.federatedSearch.trigger("reset")},fetchData:function(e,t){this.elements.results.removeClass("empty-results"),this.federatedSearch.trigger("find",{query:t,filter:this.filter})},attach:function(){this.searchDialog.trigger("attach search"),e(this.elements.search_handle).keyup(function(e){e.preventDefault()})}});return t}()),n.define("C.search.mobile.dialog",{},function(){var t=r.Model.extend({defaults:{hidden:!0,headline:"Search",baseLine:"",isFullPage:!0,closeTitle:"Cancel"}}),i=r.View.extend({_dialogTpl:s.template('<div class="native-dialog hidden"><div class="wrapper"><div class="content"></div></div></div>'),initialize:function(e){this.$el.html(this._dialogTpl()),this.model=new t(e),this.elements={back:this.$el.find(".cancel"),title:this.$el.find(".title"),right:this.$el.find(".right"),wrapper:this.$el.find(".wrapper"),content:this.$el.find(".content")},this.stack=[],this.attach()},attach:function(){n.find(this).on("push",this.push).on("show",this.show).on("hide",this.close),this.elements.back.on("click",this.back.bind(this)),this.elements.right.on("click",this.right.bind(this))},show:function(){n.find("C.search.mobile.FederatedSearchbar").trigger("on search open");var e=this.stack[this.stack.length-1];this.open=!0,this.elements.wrapper.css("top",window.innerHeight),this.$el.find(".native-dialog").removeClass("hidden"),this.elements.wrapper.animate({top:0},function(){this.elements.top_element=e.element}.bind(this))},close:function(){this.open=!1,this.elements.wrapper.animate({top:window.innerHeight},e.proxy(function(){this.$el.find(".native-dialog").addClass("hidden")},this))},updateRightButton:function(e){e.right_button?(this.elements.right.html(e.right_button),this.elements.right.removeClass("hidden")):this.elements.right.addClass("hidden")},updateLeftButton:function(e){var t=e.left_button||"cancel";1==this.stack.length?(this.elements.back.html(t),this.elements.back.removeClass("back")):(this.elements.back.html("back"),this.elements.back.addClass("back"))},updateTitle:function(e){this.elements.title.html(e.title)},createWrapper:function(t){var s=e('<div class="wrapper"></div>');s.append(t.element),t.element=s,t.element.attr("data-index",this.stack.length),t.index=this.stack.length},push:function(e,t){var s=this.elements.top_element?this.$el.find(".native-dialog").width():0;this.createWrapper(t),this.stack.push(t),this.updateRightButton(t),this.updateLeftButton(t),this.updateTitle(t),t.element.css({left:s,"z-index":this.stack.length}),this.elements.content.append(t.element),this.elements.top_element?t.element.animate({left:0},function(){var e=this.elements.top_element.attr("data-index");this.elements.top_element.detach(),this.elements.top_element=t.element,helpers.call(this.stack[e],"onHide"),this.open&&helpers.call(t,"onShow")}.bind(this)):this.show()},replace:function(e){var t=this.stack.pop(),s=this.elements.top_element?this.$el.find(".native-dialog").width():0;this.createWrapper(e),this.stack.push(e),this.updateRightButton(e),this.updateLeftButton(e),this.updateTitle(e),e.element.css({left:s,"z-index":this.stack.length}),t&&t.element.css({"z-index":this.stack.length-1}),this.elements.content.append(e.element),this.elements.top_element?e.element.animate({left:0},function(){this.elements.top_element.attr("data-index"),this.elements.top_element.remove(),this.elements.top_element=e.element,helpers.call(t,"onHide"),helpers.call(e,"onShow")}.bind(this)):this.show()},pop:function(){var e=this.stack.pop(),t=this.stack[this.stack.length-1];return 0==this.stack.length?(helpers.call(e,"onHide"),void this.close()):(this.elements.content.append(t.element),void e.element.animate({left:window.innerWidth},function(){e.element.remove(),this.elements.top_element=t.element,this.updateRightButton(t),this.updateLeftButton(t),this.updateTitle(t),helpers.call(e,"onHide"),helpers.call(t,"onShow")}.bind(this)))},back:function(){this.pop()},right:function(){var e=this.elements.top_element.attr("data-index");helpers.call(this.stack[e],"onButtonClick")},setTitle:function(e,t){var s=this.stack[this.stack.length-1];s&&(s.title=e,this.updateTitle(s),t&&t())},setRightButton:function(e,t,s){var i=this.stack[this.stack.length-1];i&&(i.right_button=e,this.updateRightButton(i),s&&s())}});return i}()),n.define("C.search.mobile.loader",{inputs:{show:null,hide:null},output:{}},function(){var t=r.View.extend({options:{target:null},initialize:function(){this.element=e('<span class="Loader"></span>'),n.find(this).on("show",this.show).on("hide",this.hide).on("destroy",this.destroy)},show:function(e,t){return this.$el.append(this.element),t.append(this.$el),this.$el.show(),this},hide:function(){return this.$el.hide(),this},destroy:function(){this.element&&this.element.remove()}});return t}()),n.define("C.search.mobile.SearchDialog",{inputs:{"attach search":{},"set elements":{}},output:{}},function(){var t=r.View.extend({initialize:function(e){n.find(this).on("attach search",this.attachSearch).on("set elements",this.setElements)},setElements:function(e,t){this.elements=t,this.min_chars=3,this.should_be_hidden=this.elements.search_dialog.hasClass("hidden")},onHide:function(){this.$search_opened=!1,this.elements.search.val(""),this.current_value="",this.elements.search_dialog.removeClass("fs-dialog"),this.should_be_hidden&&this.elements.search_dialog.addClass("hidden"),n.find("FederatedSearch").trigger("reset"),this.onSearchClose&&this.onSearchClose()},openSearch:function(){return this.$search_opened?void 0:(this.$search_opened=!0,this.elements.search_dialog.addClass("fs-dialog"),document.activeElement.blur(),this.elements.search_handle.blur(),n.create("C.search.mobile.dialog").trigger("push",{element:this.elements.search_dialog}),this.should_be_hidden&&this.elements.search_dialog.removeClass("hidden"),this.focus_input&&(e(this.elements.search).focus(),setTimeout(function(){e(this.elements.search).focus()}.bind(this),1e3),window.scrollTo(0,1)),this.attachSearchInternals(),this)},closeSearch:function(t){if(this.$search_opened){this.$search_opened=!1,n.find("C.search.mobile.dialog").trigger("hide"),n.find("C.search.mobile.FederatedSearchbar").trigger("close search"),this.elements.search.blur();var s=e(".back.cancel");return s.length?void s.click().off("click"):this}},attachSearch:function(){var t=this;return this.$delegates={itemClick:function(e){t.itemClick(this,e)},submit:function(e){t.search(e),t.elements.search.blur()},paste:function(e){setTimeout(function(){t.search({})},20)}},e(this.elements.search_handle).click(e.proxy(this.openSearch,this)),e(this.elements.search_handle).keyup(e.proxy(this.typingIntoHandle,this)),e(this.elements.cancel).click(e.proxy(this.closeSearch,this)),this},attachSearchInternals:function(){var t=this;e(this.elements.search).on("keyup",e.proxy(this.search,this)),e(this.elements.results).on("touchstart",e.proxy(this.closeKeyboard(),this)),this.elements.results.on("click",".result",this.$delegates.itemClick),e.each(this.elements.search,function(){this.addEventListener("paste",t.$delegates.paste)}),this.elements.form&&this.elements.form.on("submit",this.$delegates.submit)},syncInputText:function(){var e=this.elements.search_handle.val();e&&(this.elements.search.val(e),this.elements.search_handle.val(""))},typingIntoHandle:function(){this.openSearch(),this.syncInputText(),this.search()},closeKeyboard:function(){this.elements.search.blur()},detachSearch:function(){return this.element.off("click",".close",this.closeSearch),this.elements.results.off("click",".result",this.$delegates.itemClick),this.elements.form&&this.elements.form.off("submit",this.$delegates.submit),this},search:function(e){var t=this.elements.search.val();return e&&27==e.keyCode?this.closeSearch():t.length<this.min_chars||t==this.current_value?void 0:(this.current_value=t,n.find("C.search.mobile.FederatedSearchbar").trigger("fetch data",t),this)}});return t}())};