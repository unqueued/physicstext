function postForm(t,e,i,o){i=i||"post",o=o||"_self";var s=document.createElement("form");s.setAttribute("method",i),s.setAttribute("action",t),s.setAttribute("target",o);for(var n in e)if(e.hasOwnProperty(n)){var a=document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name",n),a.setAttribute("value",e[n]),s.appendChild(a)}document.body.appendChild(s),s.submit()}Eggshell.define("C.common.csrestartmodal",{inputs:["render","show"],outputs:["primary_cta_clicked","restart_success"]},function(){var t=Backbone.Model.extend({restartSubscription:function(t){$.ajax({type:"post",dataType:"json",url:"/_ajax/hwh/undocancel",data:{token:C.global.csrfToken,apiData:{subId:t,uuid:C.global.userUuid}},context:this,success:function(t){this.triggerSuccess()}})},triggerSuccess:function(){this.trigger("restart_success")}}),e=Backbone.View.extend({initialize:function(e){this.data=$.extend({},e),this.model=new t,this.model.on("restart_success",this.triggerRestartSuccess,this),Eggshell.find(this).on("render",this.render,this).on("show",this.show,this)},render:function(){this.popupRestart?this.popupRestart.trigger("show"):this.popupRestart=Eggshell.create("C.common.dialog").trigger("set headline","Welcome back").trigger("set content html",this.restartModalTemplate(this.data.subscription)).trigger("set id","uncancel-modal").trigger("enable default control").trigger("set primary button","Restart membership").trigger("set secondary button","Go back").on("primary button clicked",this.onCtaClick,this).on("secondary button clicked",this.hide,this)},show:function(){this.popupRestart&&this.popupRestart.trigger("show")},hide:function(){this.popupRestart&&this.popupRestart.trigger("hide")},onCtaClick:function(){this.triggerCtaClick(),this.model.restartSubscription(this.data.subscription.subscription.id)},triggerCtaClick:function(){Eggshell.find(this).trigger("primary_cta_clicked")},triggerRestartSuccess:function(){Eggshell.find(this).trigger("restart_success")},restartModalTemplate:_.template('<div class="resume-dialog"><% if(subscription.suspended) {%>Welcome back. It\'s only $<%- subscription.price %> per <%- (subscription.renewalPeriod === "yr") ? "year" : "month" %> to resume your Chegg Study membership. <% if (billing.paypal) { %><strong><%- billing.paypal %></strong><% } else { %>Your <%- billing.type %> ending in <strong><%- billing.last4 %></strong><% } %> will be charged today.<% } else { %><% if (subscription.subscriptionState.isCancelPending) { %>Your subscription will no longer be cancelled on <%- subscription.renewalDate %>. It will auto-renew and <% } else { %>Your subscription will no longer be paused on <%- subscription.suspendDate %>. It will auto-renew and <% } %><% if (billing.paypal) { %><strong><%- billing.paypal %></strong><% } else { %>your <%- billing.type %> ending in <strong><%- billing.last4 %></strong><% } %> will be charged $<%- subscription.price %> at that time.<% } %> </div> ')});return e}()),Eggshell.define("C.common.twilio",{inputs:["render twilio inline","render twilio field","set placeholder text","send text","listen for enter submit","set submit listener","set send text data","set input size","set auto focus"],outputs:["send text success","send text failure","input submitted"]},function(){var t=Backbone.View.extend({initialize:function(t){this.placeholderText="888-888-8888",this.sendTextData=null,this.inputSize="sm",this.autofocus_enabled=!0,Eggshell.find(this).on("render twilio inline",this.renderTwilioInline,this).on("render twilio field",this.renderTwilioField,this).on("set placeholder text",this.setPlaceholderText,this).on("set send text data",this.setSendTextData,this).on("set input size",this.setInputSize,this).on("listen for enter submit",this.setupEnterListener,this).on("set submit listener",this.setupSubmitListener,this).on("send text",this.sendText,this).on("set auto focus",this.setAutoFocus,this)},renderTwilioInline:function(t,e){this.$el.html('<div class="mobile-location-checkout"><div class="mobile-number-label">Mobile number (optional)</div><div class="mobile-number-container"><input maxlength="12" name="mobile_num" type="text" placeholder="'+this.placeholderText+'" value="" /></div><div class="mobile-number-desc"><div class="mobile-number-header">Get the Chegg mobile app texted to you</div><div class="mobile-number-details">Message and data rates may apply. Message may be sent using an automatic telephone dialing system. Consent not required to purchase goods or services. For help, reply HELP to any text. Read <a href="/mobiledisclosures" target="_blank">Chegg\'s Mobile Disclosures</a>.</div></div></div>'),$(e.container).append(this.$el)},twilioInlineTmpl:_.template('<div class="mobile-location-postcheckout"><div class="mobile-number-container"><input class="form-input-<%- inputSize %>" maxlength="12" name="mobile_num" type="text" placeholder="<%- placeholderText %>" value="" <%- autofocus %>/></div></div>'),renderTwilioField:function(t,e){var i=this.autofocus_enabled?"autofocus":"";this.$el.html(this.twilioInlineTmpl({inputSize:this.inputSize,placeholderText:this.placeholderText,autofocus:i})),$(e.container).append(this.$el)},setPlaceholderText:function(t,e){if(!e||"string"!=typeof e)throw"Invalid placeholder text!";this.placeholderText=e},onMobileNumberKeyUp:function(t){var e=$(t.currentTarget),i=e.val();i=i.replace(/\D/g,""),i=i.replace(/(\d{3})(\d{1,3})(\d*)/,"$1-$2-$3"),i=i.replace(/\-$/,""),e.val(i)},setupEnterListener:function(t,e){$("input[name=mobile_num]").on("keydown",$.proxy(function(t){13===t.keyCode&&this.sendText()},this))},setupSubmitListener:function(t,e){if(!e||"string"!=typeof e)throw"Invalid submit class name for twilio";$("."+e).on("click",$.proxy(function(t){t.preventDefault(),this.sendText()},this))},setSendTextData:function(t,e){this.sendTextData=e},setInputSize:function(t,e){("sm"===e||"lg"===e)&&(this.inputSize=e)},sendText:function(t){this.Eggshell.trigger("input submitted");var e=$("input[name=mobile_num]").val(),i=this.sendTextData?$.extend(this.sendTextData,{token:C.global.csrfToken,phoneNum:e}):null;i.phoneNum&&/\d{3}-\d{3}-\d{4}/.test(i.phoneNum)?$.ajax({url:"/_ajax/hwh/twilio/",type:"POST",data:i,context:this,success:function(t){this.Eggshell.trigger("send text success")},error:function(t){this.Eggshell.trigger("send text failure"),this.showSendTextFailureMsg("Error sending message. Please try again.")}}):(this.Eggshell.trigger("send text failure"),this.showSendTextFailureMsg("Please enter a valid phone number."))},setAutoFocus:function(t,e){this.autofocus_enabled=e.enabled},showSendTextFailureMsg:function(t){$(".twilio-error-msg").remove(),this.$el.append('<div class="twilio-error-msg">'+t+"</div>")},events:{"keyup [name=mobile_num]":"onMobileNumberKeyUp"}});return t}()),Eggshell.define("C.cs.apppromomodal",{inputs:["render"],outputs:[],strict:!1},function(){var t=Backbone.View.extend({initialize:function(t){this.opts=$.extend(t,{}),this.Eggshell.on("render",this.render,this)},render:function(){this.dialog=Eggshell.create("C.common.dialog").trigger("hide control").trigger("hide close button").trigger("disable screen blocker click").trigger("set content html",this.modalTemplate());var t=this.dialog.getId().replace(".","-");$("#"+t).addClass("apppromomodal-dialog"),this.renderTwilio(),$(".apppromomodal-skip-link").on("click",$.proxy(function(t){this.storeModalViewKvp()},this))},renderTwilio:function(){this.twilioComponent=Eggshell.create("C.common.twilio").trigger("render twilio field",{container:".apppromomodal-twilio-input"}).trigger("set send text data",{type:"study_adjust"}).trigger("listen for enter submit").trigger("set submit listener","apppromomodal-send-btn"),Eggshell.find(this.twilioComponent).on("input submitted",function(){$(".apppromomodal-send-btn").attr("disabled","disabled")}),Eggshell.find(this.twilioComponent).on("send text failure",$.proxy(function(){$(".apppromomodal-send-btn").attr("disabled",!1)},this)),Eggshell.find(this.twilioComponent).on("send text success",$.proxy(function(){this.storeModalViewKvp()},this))},modalTemplate:_.template('<div class="apppromomodal"><div class="apppromomodal-app-stars"><span class="appromomodal-star-icons"></span>4,000+ five star reviews. | Available on iOS and Android</div><div class="apppromomodal-header">Take Chegg Study with you on-the-go</div><div class="apppromomodal-content"><div class="apppromomodal-image"></div><div class="apppromomodal-valueprop"><div class="apppromomodal-subheader">We\'ll send you a one time download link</div><div class="apppromomodal-proofpoints"><ul class="chg-list"><li><span>Take your textbook solutions on-the-go</span></li><li><span>Ask questions anywhere with your phone camera</span></li><li><span>Get notified right away when your questions are answered</span></li></div></div><div class="apppromomodal-twilio-input"></div><div class="apppromomodal-actions"><button class="apppromomodal-send-btn btn-primary-sm">Text me</button><div class="apppromomodal-skip-link"><a href="#">No thanks</a></div></div><div class="apppromomodal-disclaimer">Your number won\'t be shared or stored. <a href="/mobiledisclosures">Chegg\'s Mobile Disclosures.</a><div></div></div>'),storeModalViewKvp:function(){$.ajax({url:"/_ajax/common/userkvp/set",type:"GET",data:{token:C.global.csrfToken,key:"showAppPromoModal",value:!1},context:this,success:function(t){Eggshell.find(this.dialog).trigger("hide").trigger("destroy")},error:function(t){Eggshell.find(this.dialog).trigger("hide").trigger("destroy"),console.log("Error storing user kvp value "+JSON.stringify(t))}})}});return t}()),Eggshell.define("C.common.tutors",{inputs:["set opportunity modal data","show tutors","set_quick_chat_data","set entity id"],outputs:["error","ready"],singleton:!0},function(){var t=Backbone.Model.extend({getTutors:function(t){var e="undefined"!=typeof t.count?t.count:3,i="undefined"!=typeof t.noSubjectCheck?t.noSubjectCheck:0;$.ajax({context:this,type:"GET",dataType:"JSON",url:"/_ajax/tutors",data:{token:C.global.csrfToken,subjectId:t.subjectId,subjectName:t.subjectName,campaign:t.campaign,limit:e,noSubjectCheck:i},success:function(t){$.isEmptyObject(t)?this.trigger("errored"):(this.set("response",t),this.trigger("loaded"))},error:function(){this.trigger("errored")}})},getSessionVariable:function(t){$.ajax({url:"/_ajax/common/session/get",type:"get",dataType:"json",data:{key:t,token:C.global.csrfToken},context:this,success:function(e){this.set(t,e)},error:function(){this.set(t,{value:"0"})}})},setSessionVariable:function(t,e){$.ajax({url:"/_ajax/common/session/set",type:"get",dataType:"json",data:{key:t,value:e,token:C.global.csrfToken},context:this})},getAccessCode:function(t,e){$.ajax({url:"/_ajax/hwh/grantaccess",type:"get",dataType:"json",data:{assetId:t.assetId,assetType:t.assetType,offer:t.offer,userAgent:t.userAgent,token:C.global.csrfToken},context:this,complete:function(t){var i=$.parseJSON(t.responseText);i&&i.accessCode&&"string"==typeof i.accessCode?this.set("accessCode",i.accessCode):this.set("accessCode",null),this.trigger(e)}})}}),e=Backbone.View.extend({tutorTemplate:_.template('<div class="tutor-container <%= variant %> clearfix"><div class="tutor-headline"></div><div class="tutor-content"></div><div class="tutors-footer"></div></div>'),initialize:function(){this.model=new t,this.setUpListeners()},setUpListeners:function(){this.model.on("loaded",this.render,this),this.model.on("errored",this.renderError,this),this.model.on("do_tbs_opportunity_flow",this.doTbsOpportunityFlow,this),Eggshell.find(this).on("set opportunity modal data",this.setOpportunityModalData).on("show tutors",this.showTutors).on("set entity id",this.setEntityId).on("set_quick_chat_data",this.setupQuickChat)},setEntityId:function(t,e){this.entityId=e},setupQuickChat:function(t,e){this.$quickChatContainerElem=e.elem,this.quickChatExperience=e.experience,this.quickChatOcUrl=e.quickChatOcPath,this.doQuickChat="quickchat"==e.experience?!0:!1,this.doQuickChat&&this.insertQuickChatComponent()},setOpportunityModalData:function(t,e){this.modalContext=e.modalContext,this.modalBody=e.modalBody},showTutors:function(t,e){this.model.getTutors(e),this.source=e.type,this.product=e.product,this.variant=e.variant?e.variant:"",this.subject=e.subjectName,this.subjectId=e.subjectId,this.userHasCsSubscription=e.userHasCsSubscription,this.entityId=e.entityId},render:function(){var t=this.model.get("response"),e=this.tutorTemplate;this.$el.empty(),this.$el.html(e({variant:this.variant})),this.renderTutors(t)},renderTutors:function(t){var e=t.tutors,i=t.url,o=t.exception||null===this.model.get("subjectId")?"Top":this.subject,s='<span class="subject">'+o+"</span> Chegg tutors who can help right now",n='<a href="'+i+'" data-noajax><button class="tutors-cta btn-flat-sm">See more Chegg tutors</button></a>',a=0,r=$(".tutor-content");switch(this.source){case"rightrail":for(this.$(".tutor-headline").html(s),this.$(".tutors-footer").html(n),this.$(".tutors-cta").addClass("rightrail-cta"),a=0;a<e.length;a++)this.displayQnaTutors(e[a],r,"qna");t.exception&&$(".online-indicator ").addClass("hidden"),this.modalContext?($(".tutors-cta").text("Find me a tutor"),this.listenToOpportunityClick()):this.setupDefaultListeners();break;case"tbs":for(this.$(".tutor-headline").html(s),this.$(".tutors-footer").html(n),this.$(".tutors-footer").addClass("tbs-footer"),$(".tutor-container").css({padding:"20px"}),e.length%2==0&&e.splice(e.length-1,1),a=0;a<e.length-1;a+=2)this.displayleftTutor(e[a],r),this.displayRightTutor(e[a+1],r);e.length%2!==0&&this.displayleftTutor(e[a],r),this.modalContext?($(".tutors-cta").text("Find me a tutor"),this.listenToOpportunityClick()):this.setupDefaultListeners();break;case"cshp":for(s="Find an online tutor who can help with your toughest classes. Connect instantly or schedule a convenient time to meet.",a=0;a<e.length-1;a+=2)this.displayleftTutor(e[a],r),this.displayRightTutor(e[a+1],r);$(".tutor-container").addClass("cshp-container"),$(".tutor-card").addClass("cshp-card"),$(".tutor-headline").html(s),$(".tutors-footer").html(n),$(".tutors-cta").html("Find a tutor"),this.setupDefaultListeners()}Eggshell.find(this).trigger("ready")},listenToOpportunityClick:function(){$(".tutor-row, .tutors-cta").on("click",$.proxy(function(t){if(t.preventDefault(),t.stopPropagation(),$(t.currentTarget).hasClass("tutor-row")){var e={tutor_clicked:1};this.tutorsRedirectUrl=$(t.currentTarget).find("a").attr("href")}else{var e={tutors_button_clicked:1};this.tutorsRedirectUrl=$(t.currentTarget).parent().attr("href")}var i="TBS"==this.product?this.doTbsOpportunityClickBehavior(t):this.doGenericOpportunityFlow(t);C.logger.doSessionLog(e,i,{logSubscription:1})},this))},doTbsOpportunityClickBehavior:function(t){if(t.preventDefault(),t.stopPropagation(),this.userHasCsSubscription){var e=this.getGrantAccessData();this.model.getAccessCode(e,"do_tbs_opportunity_flow")}else this.doTbsOpportunityFlow()},doTbsOpportunityFlow:function(){var t=this.model.get("accessCode");"undefined"!=typeof t&&(this.modalBody+="?access_code="+t),this.setOpportunityModalCookie(),C.utility.navigate(this.tutorsRedirectUrl)},doGenericOpportunityFlow:function(t){if(this.doQuickChat){var e=$(t.currentTarget).find("a").data("id");this.openQuickChat(e)}else this.setOpportunityModalCookie(),C.utility.navigate(this.tutorsRedirectUrl)},setOpportunityModalCookie:function(){var t=this.model.get("response"),e=t&&t.instaEduSubjectId?t.instaEduSubjectId:this.subjectId,i=new Date,o=i.getTime();i.setTime(o+6e5);var s=i.toGMTString(),n=".chegg",a=window.location.host.split(n),r=n+a[1],l="control"==this.quickChatExperience?this.modalContext+"_CONTROL":this.modalContext,c='{"formData":{"body":"'+this.modalBody+'","modalContext":"'+l+'","subject":"'+this.subject+'","subjectID":"'+e+'","priority":1,"isBlast":true,"timestamp": '+o+"}}";document.cookie="messageData="+c+";domain="+r+";path=/; expires="+s},setupDefaultListeners:function(){$tutor=$(".tutor-content .C-common-tutors-tutor"),$tutorsCta=$(".tutors-cta"),$tutor.on("click",$.proxy(function(t){var e=$(t.currentTarget);t.preventDefault(),C.logger.doSessionLog({tutor_clicked:1},function(){location.href=e.find("a").attr("href")},{logSubscription:1})},this)),$tutorsCta.on("click",$.proxy(function(t){t.preventDefault(),C.logger.doSessionLog({tutors_button_clicked:1},function(){location.href=$tutorsCta.parent().attr("href")},{logSubscription:1})},this))},getGrantAccessData:function(){return{assetId:this.entityId,assetType:"TBS",offer:"TBS_SOLUTION_2H_ACCESS",userAgent:"WEB"}},insertQuickChatComponent:function(){this.$quickChatContainerElem.append('<oc-component href="'+this.quickChatOcUrl+'"></oc-component>'),oc.renderUnloadedComponents()},openQuickChat:function(t){var e=this.model.get("response"),i=e&&e.instaEduSubjectId?e.instaEduSubjectId:this.subjectId,o="QNA"==this.product?"QnA":this.product,s={subjectId:i,tutorId:t?t:null,asset:{type:o,id:this.entityId}};window.startQuickChat(s)},displayQnaTutors:function(t,e,i){var o=$('<div class="tutor-row"></div>');Eggshell.create("C.common.tutors.tutor",{el:o}).trigger("get "+i+" tutor",t),e.append(o)},displayleftTutor:function(t,e){var i=$('<div class="tutor-card left-card tutor-row"></div>');Eggshell.create("C.common.tutors.tutor",{el:i}).trigger("get tbs tutor",t),e.append(i)},displayRightTutor:function(t,e){var i=$('<div class="tutor-card right-card tutor-row"></div>');Eggshell.create("C.common.tutors.tutor",{el:i}).trigger("get tbs tutor",t),e.append(i)},renderError:function(){Eggshell.find(this).trigger("error")}});return e}()),Eggshell.define("C.common.tutors.tutor",{inputs:["get qna tutor","get tbs tutor","get mystuff tutor"],outputs:[]},Backbone.View.extend({tutorTemplate:_.template('<a href="<%= uri %>" data-noajax data-id=<%= id %>><div class="online-indicator <%= hidden %>"><div class="circle-icn"></div><div class="check-icn"></div></div><img class="tutor-img" src="<%= picture %>" onError="this.onerror=null;this.src=\'<%= default_picture %>\'"><div class="tutor-info"><div class="name"><%= name %></div><div class="school"><%= school %></div></div><div class="tutor-likes"><div class="thumbs-icn"><div class="reviews"><%= reviews %></div></div></div></a>'),initialize:function(){this.setUpListeners()},setUpListeners:function(){Eggshell.find(this).on("get qna tutor",this.renderQnaTutor,this).on("get tbs tutor",this.renderTbsTutor,this).on("get mystuff tutor",this.renderMyStuffTutor,this)},renderQnaTutor:function(t,e){var i=e.last_name.charAt(0)+".",o=e.first_name+" "+i;this.$el.html(this.tutorTemplate({uri:e.uri,hidden:"",picture:e.image_thumb_small,default_picture:e.default_images.image_thumb_small,name:o,school:e.school,reviews:e.positive_reviews,id:e.id})),e.available_now?this.$(".circle-icn").hide():this.$(".check-icn").hide()},renderTbsTutor:function(t,e){var i=e.last_name.charAt(0)+".",o=e.first_name+" "+i;this.$el.html(this.tutorTemplate({uri:e.uri,hidden:"hidden",picture:e.image_thumb_medium,default_picture:e.default_images.image_thumb_medium,name:o,school:e.school,reviews:e.positive_reviews,id:e.id}))},renderMyStuffTutor:function(t,e){var i=e.last_name.charAt(0)+".",o=e.first_name+" "+i;this.$el.html(this.tutorTemplate({uri:e.uri,hidden:"",picture:e.image_thumb_small,default_picture:e.default_images.image_thumb_small,name:o,school:e.school,reviews:e.positive_reviews,id:e.id})),this.$(".tutor-info").append(this.$(".tutor-likes")),this.$(".check-icn").hide(),e.available_now||3===e.chat_availability||this.$(".circle-icn").hide()}})),Eggshell.define("C.common.viewlimitmodal",{inputs:[],outputs:[]},C.View.extend({initialize:function(){this.model=new C.viewlimitmodal.model,this.model.on("couponDataRetrieved",this.createPopup,this)},viewLimitContent:{dialogId:"view-limit-dialog",primaryBtnText:"Create new account",headline:"UH-OH! WE'VE DETECTED MULTIPLE USERS."},limitMessageTemplate:_.template('<div class="limit-msg-wrapper"><div class="limit-msg">Our system detects multiple users on this account. You can continue to access your existing Textbook Solution books, but access to new books will be blocked for up to 30 days. If you are not the primary account holder, create a new account to immediately regain access. <a href="http://www.chegg.com/contactus/Returns/50994120">Contact us</a> if you have questions or think this is a mistake.</div></div><img class="avatar" src="<%= avatarPath %>">'),couponTemplate:_.template('<div class="coupon-wrapper"><div class="header">Get <%= couponSavings %> off your first month</div><input type="text" class="coupon-code" value="<%= couponCode %>" autofocus readonly /><div class="fineprint">Coupon valid for 7 days. Paste code at checkout.</div></div>'),createPopup:function(){this.popup=Eggshell.create("C.common.dialog");var t=this.limitMessageTemplate({avatarPath:C.global.assetUrl+"site/avatars/img-avatar-gry-60x60.png"})+this.couponTemplate({couponSavings:this.model.get("couponSavings"),couponCode:this.model.get("couponCode")});this.popup.trigger("hide sub headline").trigger("hide icon").trigger("enable default control").trigger("set primary button",this.viewLimitContent.primaryBtnText).trigger("set id",this.viewLimitContent.dialogId).trigger("set headline",this.viewLimitContent.headline).trigger("set content",t).trigger("hide close button").trigger("disable screen blocker click").trigger("show"),$("#"+this.viewLimitContent.dialogId).find(".coupon-code").select(),C.logger.doSessionLog({viewlimitmodal_seen:1}),this.listenToPrimaryBtnClick()},listenToPrimaryBtnClick:function(){$("#"+this.viewLimitContent.dialogId).find(".main-button").on("click",$.proxy(function(t){t.preventDefault(),C.logger.doSessionLog({viewlimitmodal_cta_click:1}),$.ajax({url:C.global.cheggSiteUrl+"signout",data:{token:C.global.csrfToken},context:this}).done(function(){window.location.href=this.model.get("addToCartUrl")})},this))}})),C("viewlimitmodal"),C.viewlimitmodal.model=C.Model.extend({objName:"C.viewlimitmodal.model",initialize:function(){this.getSubsData(),this.getCouponCode()},getSubsData:function(){$.ajax({url:"/_ajax/hwh/subscription/",data:{token:C.global.csrfToken},context:this,success:function(t){if(t){var t=t.subsPriceData,e="undefined"!=typeof t.monthly?t.monthly.catalogId:null,i="undefined"!=typeof t.monthly?t.monthly.priceId:null,o=e&&i?this.buildAddToCartUrl(e,i):"";this.set("addToCartUrl",o)}}})},getCouponCode:function(){$.ajax({url:"/_ajax/hwh/coupon/",data:{token:C.global.csrfToken},context:this,success:function(t){t&&(this.set("couponSavings","undefined"!=typeof t.couponSavings?t.couponSavings:""),this.set("couponCode","undefined"!=typeof t.couponCode?t.couponCode:""))},error:function(){C.utility.refresh()}}).done(function(t){this.trigger("couponDataRetrieved")})},buildAddToCartUrl:function(t,e){return"/shoppingcart/add/?redirect=hwh&command="+t+","+e+",1"}}),Eggshell.define("C.common.cspricemodal",{inputs:["show cs price modal","set type","update price","set headline","set list content","destroy on close"],outputs:[]},C.View.extend({initialize:function(t){this.data=$.extend({type:"",alcItemId:""},t),this.model=new C.cspricemodal.model(this.data),this.model.on("subsDataCaptured",this.createComponent,this),this.fireAdobePaywallEvent()},fireAdobePaywallEvent:function(){C.adobeAnalytics.setData("page",{pageInfo:{pageType:"promotion",pageName:"CS Paywall"},category:{primaryCategory:"Chegg",subCategory1:"Web",subCategory2:"cs"}}),C.adobeAnalytics.track("pageView")},createComponent:function(){this.setUpListeners(),this.Eggshell.trigger("loaded")},priceTemplate:_.template('<div class="radio-input"><input type="radio" name="cs-radio" <%= checked %> id="<%= option %>" data-priceid="<%= priceId %>" data-catalogid="<%= catalogId %>" data-catalogsource="<%= catalogItemSource %>"/><label class="form-radio <%= hide %>" for="<%= option %>">&nbsp;</label><label for="<%= option %>"><span class="radio-label">$<%= label %></span> <div class="radio-term"><%= term %></div></label></div>'),createPopup:function(){if("undefined"==typeof this.popup){this.popup=Eggshell.create("C.Eggshell.dialog");var t="chkout"===this.data.page?"Update":"Continue";this.popup.trigger("hide sub headline").trigger("hide icon").trigger("enable default control").trigger("set primary button",t).trigger("set id","cspricemodal"),this.displayPopupContent()}this.popup.trigger("show"),"chkout"!==this.data.page&&this.setInitialState();var e=C.global.userUuid||this.data.userSignedIn;e||this.popup.trigger("set secondary button","Sign In"),this.setDialogListeners()},displayPopupContent:function(){var t={el:"#"+this.popup.getId(),priceTemplate:this.priceTemplate,trialPeriod:this.model.getTrialPeriod(),page:this.data.page,type:this.data.type};this.model.get("alcOptionExists")&&Eggshell.create("C.common.cspricemodal.alacarte",{subsPriceData:this.model.get("subsPriceData")}).trigger("render",t),Eggshell.create("C.common.cspricemodal.subscription",{subsPriceData:this.model.get("subsPriceData"),alcOptionExists:this.model.get("alcOptionExists")}).trigger("render",t)},setDialogListeners:function(){this.listenToPrimaryBtnClick(),this.listenToSecondaryBtnClick(),this.listenToRadioBtnChange(),this.destroyOnClose&&this.listenToCloseBtnClick()},listenToCloseBtnClick:function(){this.popup.listen("hidden",$.proxy(function(t){Eggshell.find(this.popup).trigger("destroy")},this))},listenToPrimaryBtnClick:function(){this.popup.listen("primary button clicked",$.proxy(function(){"chkout"!==this.data.page?window.location.href=this.model.getAddToCartUrl(this.catalogId,this.priceId,this.catalogItemSource):(this.popup.trigger("hide"),this.Eggshell.trigger("update price"))},this)),C.adobeAnalytics.track("cs_paywall")},listenToSecondaryBtnClick:function(){var t=this;this.popup.listen("secondary button clicked",function(){C.logger.doSessionLog({signup_flow:"hwhv1"},function(){C.utility.navigate("/auth?redirect="+window.location.pathname)})})},listenToRadioBtnChange:function(){$("input[type=radio]").on("change",$.proxy(function(t){this.Eggshell.trigger("option selected",{priceId:$(t.target).data("priceid"),catalogId:$(t.target).data("catalogid"),catalogItemSource:$(t.target).data("catalogsource")})},this))},setUpListeners:function(){this.Eggshell.on("show cs price modal",this.createPopup).on("set type",this.setType).on("option selected",this.updateSelection).on("set headline",this.setHeadline).on("set list content",this.setListContent).on("destroy on close",this.setDestroyOnClose)},setDestroyOnClose:function(t,e){this.destroyOnClose=!0},setHeadline:function(t,e){this.headline=e},setListContent:function(t,e){this.listContent=e},setInitialState:function(){var t=$(".cs-wrapper").find("input[name=cs-radio]").data("priceid"),e=$(".cs-wrapper").find("input[name=cs-radio]").data("catalogid"),i=$(".cs-wrapper").find("input[name=cs-radio]").data("catalogsource");this.updateSelection(this,{priceId:t,catalogId:e,catalogItemSource:i}),this.model.get("alcOptionExists")||C.utility.setCookie("alcItemId",null,0),C.utility.setCookie("csPriceModalType",this.data.type)},updateSelection:function(t,e){this.catalogId=e.catalogId,this.priceId=e.priceId,this.catalogItemSource=e.catalogItemSource;var i={priceId:e.priceId,catalogId:e.catalogId,catalogItemSource:e.catalogItemSource,price:this.model.getPriceGivenPriceId(e.priceId),desc:this.model.getDesc(e.priceId,e.catalogId),term:this.model.getTermGivenPriceId(e.priceId),trialPeriod:this.model.getTrialPeriod()};C.utility.setLocal("priceSelectedData",i)},setType:function(t,e){this.data.type=e}})),C("cspricemodal"),C.cspricemodal.model=C.Model.extend({objName:"C.cspricemodal.model",initialize:function(t){this.data=t,this.getSubsData()},getSubsData:function(){$.ajax({url:"/_ajax/hwh/subscription/",type:"GET",data:{token:C.global.csrfToken,alcItemId:this.data.alcItemId,page:this.data.page,csPriceModal:!0},context:this,success:function(t){this.set("subsPriceData",t.subsPriceData)},error:function(){C.utility.refresh()}}).done(function(t){this.set("annualOptionExists",this.annualOptionExists()),this.set("alcOptionExists",this.alcItemExists()),this.set("offerType",this.getOfferType()),this.trigger("subsDataCaptured")})},annualOptionExists:function(){return"undefined"!=typeof this.get("subsPriceData").yearly},alcItemExists:function(){return"undefined"!=typeof this.get("subsPriceData").alacarte&&"undefined"!=typeof this.get("subsPriceData").alacarte.prices&&"undefined"!=typeof this.get("subsPriceData").alacarte.prices.price},getOfferType:function(){return this.hasFreeTrial()?"free-trial":this.get("annualOptionExists")?this.get("annualOptionExists")&&!this.get("alcOptionExists")?"monthly-and-annual":this.get("alcOptionExists")?"alacarte":"monthly-only":"monthly-only"},getAddToCartUrl:function(t,e,i){return"/shoppingcart/add/?redirect=hwh&command="+t+","+e+",1,"+i},getPriceGivenPriceId:function(t){return this.get("subsPriceData").monthly.priceId===t?this.get("subsPriceData").monthly.price:this.get("annualOptionExists")&&this.get("subsPriceData").yearly.priceId===t?this.get("subsPriceData").yearly.price:this.get("subsPriceData").alacarte.prices.price},getDesc:function(t,e){return this.get("subsPriceData").monthly.priceId===t?this.get("subsPriceData").monthly.desc:this.get("annualOptionExists")&&this.get("subsPriceData").yearly.priceId===t?this.get("subsPriceData").yearly.desc:this.get("alcOptionExists")&&this.get("subsPriceData").alacarte.catalogItemId==e?this.get("subsPriceData").alacarte.desc:""},getTermGivenPriceId:function(t){return this.get("subsPriceData").monthly.priceId===t?"month":this.get("annualOptionExists")&&this.get("subsPriceData").yearly.priceId===t?"year":""},hasFreeTrial:function(){return parseInt(this.get("subsPriceData").monthly.trialPeriod)<parseInt(this.get("subsPriceData").monthly.renewalPeriod)},getTrialPeriod:function(){return this.hasFreeTrial()?this.get("subsPriceData").monthly.trialPeriod:""}}),Eggshell.define("C.common.cspricemodal.alacarte",{inputs:["render"],outputs:[]},C.View.extend({initialize:function(t){this.data=$.extend({type:"",alcItemId:""},t),this.model=new C.cspricemodal.alacarte.model({subsPriceData:this.data.subsPriceData}),this.setUpListeners()},alcContent:{alcFineprint:"Access limited to the chegg.com website. Excludes mobile app access.",alcSubheaderTBS:"This Textbook Solution",alcSubheaderQNA:"This answer"},setUpListeners:function(){this.Eggshell.on("render",this.render)},render:function(t,e){this.el=e.el.split(".").join("-");var i=this.getALaCarteMarkup(e);$(this.el).find(".content").append(i)},getALaCarteMarkup:function(t){var e="tbs"===t.type?this.alcContent.alcSubheaderTBS:this.alcContent.alcSubheaderQNA,i=this.model.getAlcContent(),o="tbs"===t.type?'<div class="tbs-chapter">Chapter '+i.chapter+", Problem "+i.problem+'</div><div class="tbs-title">'+i.bookTitle+"</div>":'<div class="qna-body">'+i.qnaBody+"</div>",s='<div class="alc-radio">'+t.priceTemplate({checked:"checked",option:"alcarte",label:this.model.getALaCartePrice(),term:this.model.getAlcBillingText(),priceId:this.model.getAlcPriceId(),catalogId:this.model.getAlcCatalogId(),hide:""})+"</div>";return'<div class="cs-wrapper"><div class="cs-subheadline">'+e+'</div><div class="alc-content">'+o+'</div><div class="cs-fineprint">'+this.alcContent.alcFineprint+"</div>"+s+"</div>"}})),C("cspricemodal.alacarte"),C.cspricemodal.alacarte.model=C.Model.extend({objName:"C.cspricemodal.alacarte.model ",initialize:function(t){this.subsPriceData=t.subsPriceData},getALaCartePrice:function(){return this.subsPriceData.alacarte.prices.price},isTBSAlcItem:function(){return-1!==this.subsPriceData.alacarte.type.indexOf("TBS")?!0:!1},getAlcContent:function(){var t={};return this.isTBSAlcItem()?(t.bookTitle=this.subsPriceData.alacarte.bookTitle,t.chapter=this.subsPriceData.alacarte.chapterName,t.problem=this.subsPriceData.alacarte.problemName):(t.qnaBody=this.subsPriceData.alacarte.body,this.subsPriceData.alacarte.transcribedData&&(t.qnaBody=JSON.parse(this.subsPriceData.alacarte.transcribedData).text)),t},getAlcPriceId:function(){return this.subsPriceData.alacarte.prices.logId;

},getAlcCatalogId:function(){return this.subsPriceData.alacarte.catalogItemId},getAlcBillingText:function(){return this.isTBSAlcItem()?"1 solution":"1 answer"}}),Eggshell.define("C.common.cspricemodal.subscription",{inputs:["render"],outputs:[]},C.View.extend({initialize:function(t){this.data=$.extend({type:""},t),this.model=new C.cspricemodal.subscription.model({subsPriceData:this.data.subsPriceData}),this.setUpListeners()},subsContent:{tbsLi:"<li>Step-by-step Textbook Solutions for over 22,000 ISBNs</li>",answerLi:"<li>Get this answer and millions more</li>",qnaLi:"<li>Ask questions of experts and enthusiasts 24/7</li>",hwhLi:"<li>Search millions of homework answers</li>",tutorsMsg:'<span class="includes">INCLUDES FREE:</span> 30 minutes live, online tutoring (up to $20 value)',headlineAlc:"Select option",headlineNoTrial:"Choose monthly or annual",headlineNoAnnual:"Ace your course",csSubheader:"Chegg Study",tbsSubheader:"All Textbook Solutions and more",qnaSubheader:"All answers, Textbook Solutions and more"},setUpListeners:function(){this.Eggshell.on("render",this.render)},render:function(t,e){this.el=e.el.split(".").join("-"),$(this.el).find(".content").append(this.getCSMarkup(e)),$(this.el).find(".headline").append(this.getHeadline(e))},getHeadline:function(t){return this.data.alcOptionExists?this.subsContent.headlineAlc:this.model.hasFreeTrial()?"Start "+t.trialPeriod+"-day free trial":this.model.get("annualOptionExists")?this.subsContent.headlineNoTrial:this.subsContent.headlineNoAnnual},getCSMarkup:function(t){var e=this.model.get("annualOptionExists")||this.data.alcOptionExists?"":"hide";this.checkMonthly=this.data.alcOptionExists?"":"checked",this.checkYearly="","chkout"===t.page&&this.getCSDefaultRadio();var i='<div class="cs-radio">'+t.priceTemplate({checked:this.checkMonthly,option:"monthly",label:this.model.getMonthlyPrice(),term:this.model.getBillingText("monthly"),priceId:this.model.getMonthlyPriceId(),catalogId:this.model.getMonthlyCatalogId(),catalogItemSource:this.model.getCatalogItemSource(),hide:e});this.model.get("annualOptionExists")&&(i+=t.priceTemplate({checked:this.checkYearly,option:"yearly",label:this.model.getAnnualPrice(),term:this.model.getBillingText("annually"),priceId:this.model.getAnnualPriceId(),catalogId:this.model.getAnnualCatalogId(),catalogItemSource:this.model.getCatalogItemSource(),hide:e})),i+="</div>";var o=this.subsContent.csSubheader;this.data.alcOptionExists&&(o=this.model.isTBSAlcItem()?this.subsContent.tbsSubheader:this.subsContent.qnaSubheader);var s='<div class="cs-wrapper"><div class="cs-subheadline">'+o+"</div>"+this.getCSListContent()+i+"</div>";return s+='<div class="tutor-messaging">'+this.subsContent.tutorsMsg+"</div>"},getCSDefaultRadio:function(){if(C.utility.getLocal("priceSelectedData")){var t=C.utility.getLocal("priceSelectedData").desc;this.checkMonthly="",this.checkYearly="",-1!==t.indexOf("annual")?this.checkYearly="checked":-1!==t.indexOf("monthly")&&(this.checkMonthly="checked")}},getCSListContent:function(){var t="";return t+="qna"===this.data.type?this.subsContent.answerLi+this.subsContent.tbsLi+this.subsContent.qnaLi:this.subsContent.tbsLi+this.subsContent.qnaLi+this.subsContent.hwhLi,'<ul class="cs-list">'+t+"</ul>"}})),C("cspricemodal.subscription"),C.cspricemodal.subscription.model=C.Model.extend({objName:"C.cspricemodal.subscription.model",initialize:function(t){this.data=t,this.subsPriceData=t.subsPriceData,this.set("annualOptionExists",this.annualOptionExists())},annualOptionExists:function(){return"undefined"!=typeof this.subsPriceData.yearly},isTBSAlcItem:function(){return this.data.alcOptionExists&&-1!==this.subsPriceData.alacarte.type.indexOf("TBS")?!0:!1},getMonthlyPrice:function(){return this.subsPriceData.monthly.price},getAnnualPrice:function(){return this.get("annualOptionExists")?this.subsPriceData.yearly.price:""},getMonthlyPriceId:function(){return this.subsPriceData.monthly.priceId},getAnnualPriceId:function(){return this.get("annualOptionExists")?this.subsPriceData.yearly.priceId:""},getMonthlyCatalogId:function(){return this.subsPriceData.monthly.catalogId},getAnnualCatalogId:function(){return this.get("annualOptionExists")?this.subsPriceData.yearly.catalogId:""},hasFreeTrial:function(){return parseInt(this.subsPriceData.monthly.trialPeriod)<parseInt(this.subsPriceData.monthly.renewalPeriod)},getBillingText:function(t){return this.hasFreeTrial()?t+" after trial":t},getCatalogItemSource:function(){return this.subsPriceData.monthly.catalogItemSource}}),Eggshell.define("C.common.onboardingoverlay",{inputs:{render:{payload:null},set_instruction_points:{payload:"object"},render_header_overlay:{payload:null},show_close_control:{payload:null},dismiss_on_click:{payload:null},set_on_click_callback:{payload:null},hide_overlay:{payload:null}},outputs:[]},function(){var t=Backbone.View.extend({initialize:function(){this.instructionPoints=[],this.showCloseControl=!1,this.dismissOnClick=!1,this.onClickCallback=null,this.$headerHandle=$(C.dom&&C.dom.$header?C.dom.$header:".chgg-hdr"),this.origHeaderBorder=this.$headerHandle?this.$headerHandle.css("border-bottom"):"",Eggshell.find(this).on("render",this.render,this).on("show_overlay_close",this.setShowCloseControl,this).on("hide_overlay",this.hideOverlay,this).on("dismiss_on_click",this.setDismissOnClick,this).on("set_on_click_callback",this.setOnClickCallback,this).on("render_header_overlay",this.setRenderHeaderOverlay,this).on("set_instruction_points",this.setInstructionPoints,this)},render:function(){this.$el.prepend(this.overlayTemplate({showCloseControl:this.showCloseControl})),this.renderHeaderOverlay&&(this.$headerHandle.prepend(this.headerOverlayTemplate({})),this.$headerHandle.css({"border-bottom":"none"})),this.showCloseControl&&this.$el.find(".onboardingoverlay-close").css({top:this.$el.parent().position().top+50});for(var t=0;t<this.instructionPoints.length;t++){this.instructionPoints[t].id=t;var e=this.instructionPoints[t];$(e.handle).append(this.instructionPointTemplate({id:e.id,top:e.top_padding,left:e.left_padding,img:e.img}))}C.logger.doSessionLog({onboarding_overlay_opened:1}),this.setActionListeners()},setInstructionPoints:function(t,e){if(!e||"object"!=typeof e)throw"Invalid instruction point. Type needs to be an object value.";$.extend(this.instructionPoints,e)},setShowCloseControl:function(t,e){this.showCloseControl=!0},setDismissOnClick:function(t,e){this.dismissOnClick=!0},setRenderHeaderOverlay:function(t,e){this.renderHeaderOverlay=!0},setOnClickCallback:function(t,e){this.onClickCallback=e},setActionListeners:function(){this.showCloseControl&&$(".onboardingoverlay-close").on("click",$.proxy(function(t){Eggshell.find(this).trigger("hide_overlay")},this)),this.dismissOnClick&&$(".onboardingoverlay-screenblocker, .onboardingoverlay-header-screenblocker").on("click",$.proxy(function(t){Eggshell.find(this).trigger("hide_overlay"),this.onClickCallback&&this.onClickCallback()},this))},hideOverlay:function(){C.logger.doSessionLog({onboarding_overlay_closed:1}),$(".onboardingoverlay-header-screenblocker, .onboardingoverlay-screenblocker").remove(),$(".onboardingoverlay-instruction-point").remove(),this.$headerHandle.css({"border-bottom":this.origHeaderBorder}),Eggshell.find(this).trigger("destroy")},headerOverlayTemplate:_.template('<div class="onboardingoverlay-header-screenblocker"></div>'),overlayTemplate:_.template('<% if(showCloseControl){ %><div class="onboardingoverlay-close"></div><% } %><div class="onboardingoverlay-screenblocker"></div>'),instructionPointTemplate:_.template('<div class="onboardingoverlay-instruction-point point-<%- id %>" style="top:<%- top %>px; left:<%- left %>px;"><img src="http://c.cheggcdn.com/_public-assets/<%- img %>"/></div>')});return t}()),Eggshell.define("C.common.onboardingsequence",{inputs:{render:{payload:null},set_banner_handle:{payload:"selector"},set_obfuscation_handle:{payload:"selector"},set_instruction_points:{payload:"object"},begin_sequence:{payload:null},disable_header_obfuscation:{payload:null},apply_custom_css_prefix:{payload:"string"}},outputs:["step_viewed","sequence_completed","sequence_done","close_button_clicked"]},function(){var t=Backbone.View.extend({initialize:function(){this.$obfuscationHandle=null,this.$bannerHandle=null,this.$headerHandle=$(C.dom&&C.dom.$header?C.dom.$header:".chgg-hdr"),this.origHeaderBorder=this.$headerHandle?this.$headerHandle.css("border-bottom"):"",this.cssPrefix="onboardingsequence",this.instructionPoints=[],this.tooltipSequence=[],this.currentTooltipIndex=null,this.sequenceStarted=!1,this.headerObfuscationEnabled=!0,Eggshell.find(this).on("render",this.render,this).on("set_instruction_points",this.setInstructionPoints,this).on("set_banner_handle",this.setBannerHandle,this).on("set_obfuscation_handle",this.setObfuscationHandle,this).on("disable_header_obfuscation",this.disableHeaderObfuscation,this).on("apply_custom_css_prefix",this.setCustomCssPrefix,this).on("begin_sequence",this.beginSequence,this)},render:function(){this.getCleanTooltips(),this.renderObfuscation(),this.renderTooltips(),this.renderBanner(),this.addBodyClickListener()},renderObfuscation:function(){this.$obfuscationHandle&&(this.$obfuscationHandle.prepend(this.obfuscationTemplate({})),this.headerObfuscationEnabled&&(this.$headerHandle.append(this.headerObfuscation({})),this.$headerHandle.css({"border-bottom":"none"})))},renderBanner:function(){this.$bannerHandle&&$(this.bannerTemplate({})).insertAfter(this.$bannerHandle)},renderTooltips:function(){for(var t=0;t<this.instructionPoints.length;t++){var e=this.instructionPoints[t],i=Eggshell.create("C.common.overlay.tooltip"),o=t+1;switch(i.on("return tooltip content node",$.proxy(function(t,s){var n=s;n.html(this.instructionPointContentTemplate({stepNumber:o,content:e.content,buttonText:o==this.instructionPoints.length?"GOT IT":"NEXT",total:this.instructionPoints.length,cssPrefix:this.cssPrefix})),this.attachButtonListener(i)},this)).trigger("set target",$(e.handle.selector)).trigger("disable tooltip on hover").trigger("disable_max_z_index").trigger("enable close button").trigger("get tooltip content node"),e.position){case"left":i.trigger("set tooltip on the left of target");break;case"right":i.trigger("set tooltip on the right of target");break;case"top":i.trigger("set tooltip above target"),i.trigger("position caret center");break;case"bottom":i.trigger("set tooltip below target"),i.trigger("top-right"===e.caretPosition?"position caret on top right":"position caret center")}e.tooltipWidth&&i.trigger("set tooltip the width",e.tooltipWidth);var s=i.getId().replace(".","-");$("#"+s).addClass(this.cssPrefix+"-tooltip");var n=e.highlightHandle?e.highlightHandle:"";this.tooltipSequence.push({tooltip:i,highlight:n})}},getCleanTooltips:function(){for(var t=0;t<this.instructionPoints.length;t++){var e=$(this.instructionPoints[t].handle.selector);e.length||this.instructionPoints.splice(t,1)}},beginSequence:function(){this.sequenceStarted=!0,$.each(this.tooltipSequence,function(t,e){e.tooltip.trigger("hide")}),this.tooltipSequence&&this.tooltipSequence[0]&&(this.currentTooltipIndex=0,this.showTooltip(this.tooltipSequence[0].tooltip,this.tooltipSequence[0].highlight,this.currentTooltipIndex+1))},showNextTooltip:function(){this.tooltipSequence[this.currentTooltipIndex].tooltip.trigger("hide");var t=this.currentTooltipIndex+1,e=this.tooltipSequence[this.currentTooltipIndex].highlight;if(t<this.tooltipSequence.length){var i=this.tooltipSequence[t].tooltip,o=this.tooltipSequence[t].highlight;this.currentTooltipIndex=t,this.removeHighlight(e),this.showTooltip(i,o,this.currentTooltipIndex+1)}else this.removeObfuscation(),this.removeHighlight(e),this.scrollTo(0),this.removeBodyClickListener(),Eggshell.find(this).trigger("sequence_completed"),Eggshell.find(this).trigger("sequence_done")},attachButtonListener:function(t){var e=t.getId().replace(".","-"),i="#"+e;$(i+" .close-btn").on("click",$.proxy(function(e){e.preventDefault(),e.stopPropagation();var o=$(i).find("."+this.cssPrefix+"-instruction-point").data("step"),s=this.tooltipSequence[o-1].highlight;Eggshell.find(this).trigger("close_button_clicked",{stepNumber:o}),this.removeObfuscation(),this.removeHighlight(s),t.trigger("hide"),this.removeBodyClickListener(),Eggshell.find(this).trigger("sequence_done")},this))},showTooltip:function(t,e,i){Eggshell.find(this).trigger("step_viewed",{stepNumber:i});var o=t.getId().replace(".","-");t.trigger("show"),this.addHighlight(e),this.scrollTo($("#"+o).position().top-200)},addHighlight:function(t){t[0].style.pointerEvents="none",$(t).addClass("onboarding-sequence-highlight")},removeHighlight:function(t){t[0].style.pointerEvents="auto",$(t).removeClass("onboarding-sequence-highlight")},addBodyClickListener:function(){$("body").bind("click",$.proxy(this.onBodyClick,this))},removeBodyClickListener:function(){$("body").unbind("click",$.proxy(this.onBodyClick,this))},onBodyClick:function(){this.sequenceStarted?this.showNextTooltip():$(".onboarding-banner").animate({height:0,opacity:0},400,$.proxy(function(){$(".onboarding-banner").remove(),this.beginSequence()},this))},setInstructionPoints:function(t,e){if(!e||"object"!=typeof e)throw"Invalid instruction point. Type needs to be an object value.";$.extend(this.instructionPoints,e)},setBannerHandle:function(t,e){this.$bannerHandle=e},setObfuscationHandle:function(t,e){this.$obfuscationHandle=e},removeObfuscation:function(){$(".onboarding-sequence-obfuscation").remove(),$(".onboarding-sequence-header-obfus").remove(),this.$headerHandle.css({"border-bottom":this.origHeaderBorder})},disableHeaderObfuscation:function(){this.headerObfuscationEnabled=!1},setCustomCssPrefix:function(t,e){this.cssPrefix=e},instructionPointContentTemplate:_.template('<div class="<%=cssPrefix%>-instruction-point" data-step="<%= stepNumber %>"><span class="instruction-point-counter"><%= stepNumber %> of <%= total %></span><span class="instruction-point-content"><%= content %></span><button class="btn-primary-outline btn-sm"><%= buttonText %></button></div>'),bannerTemplate:_.template('<div class="onboarding-banner"><span class="message-text">Welcome to Chegg Study, your start to better grades <button class="btn-primary-outline btn-mini">Show me around</button></span></div>'),obfuscationTemplate:_.template('<div class="onboarding-sequence-obfuscation"></div>'),headerObfuscation:_.template('<div class="onboarding-sequence-header-obfus"></div>'),scrollTo:function(t){$("body, html").animate({scrollTop:t})}});return t}()),Eggshell.define("C.page.playerpages_sdk",{inputs:{render:{payload:null}},outputs:{},strict:!1},function(){var t=Backbone.View.extend({initialize:function(t){this.options=t,this.firstTimeLoading=!0,C.utility.loadScript(this.options.tbsSdkCDN+"js/index.js",this.render.bind(this)),this.wireTutorComponent(),this.doSessionLogging(),this.configureHeaderAutosuggest(),this.doFreeAccessOffer(),this.doUnCancelBanner(),this.Eggshell.on("destroy",this.destroy)},doFreeAccessOffer:function(){if(this.options.accessExpireDate){var t=function(t){var t=t.subsPriceData,e="undefined"!=typeof t.monthly?"$"+t.monthly.price+" monthly":"";this.adjustPageForFullWidthBanner($("#free-access-banner")),$("#free-access-banner .price").html(e),$("#free-access-banner button").on("click",$.proxy(function(){C.logger.doSessionLog({freemium_banner_click:"1"}),this.displayCSPriceModal()},this))}.bind(this);if(this.getSubsPriceData(t),C.utility.getParams().freeAccessOffered&&!C.utility.getLocal("freeAccessDialogShown")){C.utility.setLocal("freeAccessDialogShown",1);var e=Eggshell.create("C.common.dialog").trigger("set headline","Welcome to Chegg Study").trigger("set sub headline","( 24-hour free access )").trigger("set id","free-access-dialog").trigger("set content html","You have access to :<ul><li>Millions of homework answers</li><li>Step-by-step solutions for your textbooks</li></ul>").trigger("enable default control").trigger("set primary button","Start studying").trigger("hide icon").trigger("hide close button").trigger("disable screen blocker click").on("primary button clicked",function(t){$("#free-access-dialog").find(".close").trigger("click")},this);C.logger.doSessionLog({freemium_onboarding:1})}}},getSubsPriceData:function(t){$.ajax({url:"/_ajax/hwh/subscription/",type:"GET",data:{token:C.global.csrfToken},context:this,success:t,error:function(t){console.log("Error in getting subscription price data: "+JSON.stringify(t))}})},doUnCancelBanner:function(){this.options.showUnCancelBanner&&(this.adjustPageForFullWidthBanner($("#uncancel-banner")),$("#uncancel-banner .uncancel-button").on("click",$.proxy(function(t){var e=$(t.currentTarget).hasClass("uncancel-link")?"uncancel_link_click":"uncancel_button_click",i=JSON.parse('{"'+e+'":1}');C.logger.doSessionLog(i),this.showRestartModal()},this)))},adjustPageForFullWidthBanner:function(t){$(".global-breadcrumb").addClass("adjust-top");var e=function(){var e=$(t).position().top-$(".chgg-hdr").outerHeight();$(t).css({"margin-top":-1*e+"px"})};$(window).on("resize",e),e()},showRestartModal:function(){this.popupRestart?this.popupRestart.trigger("show"):this.popupRestart=Eggshell.create("C.common.csrestartmodal",{subscription:this.options.latestSubscriptionData}).on("primary_cta_clicked",function(){C.logger.doSessionLog({uncancel_modal_click:1}),$("#uncancel-modal").find("button").prop("disabled","disabled")}).on("restart_success",function(){var t=window.location.origin+window.location.pathname+"?cs_restart=1";C.utility.navigate(t)}).trigger("render")},displayCSPriceModal:function(){"undefined"==typeof this.popUp?this.popUp=Eggshell.create("C.common.cspricemodal").on("loaded",$.proxy(function(){this.popUp.trigger("set type","qna").trigger("show cs price modal")},this)):this.popUp.trigger("show cs price modal"),C.logger.doSessionLog({CS_pricemodal:"qna"})},configureHeaderAutosuggest:function(){C.global.headerAutosuggest&&Eggshell.find(C.global.headerAutosuggest).trigger("render",{ajaxEndpoint:"/_ajax/search/tbsserp",target:$(".chgg-hdr .autosuggest-input-field"),filters:{type:"group",count:5,destination:"tbs"}})},fixHeaderOnScroll:function(){var t=$("#solution-player-sdk"),e=$("#solution-player-sdk .main"),i=$(".TBS_TOC"),o=$(".chgg-hdr").hasClass("type-study");$(window).on("scroll",function(s){var n=$(window).scrollTop(),a=e.height();n>137&&a+137>n?(t.addClass(o?"fixed-dedicated-hdr":"fixed-header"),e.addClass(o?"adjust-dedicated-main":"adjust-main"),i.css({top:n-70+"px"})):(t.removeClass(o?"fixed-dedicated-hdr":"fixed-header"),e.removeClass(o?"adjust-dedicated-main":"adjust-main"),i.removeAttr("style"))})},doSessionLogging:function(){C.logger.doSessionLog(this.options.editionPage?{SDK_edition_page:1}:this.options.chapterPage?{SDK_chapter_page:1}:{SDK_problem_page:1})},wireTutorComponent:function(){var t=$('<div class="tbs-sub-tutors"></div>');t.insertAfter("#solution-player-sdk"),this.renderTutorEggshell(t,"tbs",5)},renderTutorEggshell:function(t,e,i,o){this.tutorComponent=Eggshell.create("C.common.tutors",{el:t}),this.setTutorsOpportunityModalData(),this.tutorComponent.trigger("show tutors",{type:e,variant:o,product:"TBS",subjectId:this.options.subjectIdForTutors,subjectName:this.options.subjectNameforTutors,userHasCsSubscription:1,count:i,campaign:"Chegg_Study-TBS",entityId:this.options.problemId})},setTutorsOpportunityModalData:function(){var t=window.location.origin+window.location.pathname;this.tutorComponent.trigger("set opportunity modal data",{modalContext:"TBS_OPP_FLOW",modalBody:"Hi! I'm working on the following textbook problem and would like some help: "+t})},updateBreadcrumb:function(t,e){if(this.options.chapterPage&&"chapter"===e){var i=$(".global-breadcrumb");return void i.html(i.html().replace(/chapter .+/,"chapter "+t))}if("chapter"===e){var o=$(".global-breadcrumb a").last();o.text("chapter "+t);var s=o.attr("href").replace(/-chapter-[^-]+-/,"-chapter-"+t+"-");o.attr("href",s)}if("problem"===e){var i=$(".global-breadcrumb");i.html(i.html().replace(/problem .+/,"problem "+t))}},getRoutes:function(){var t=this.scrubTitleForRoutes(),e={problem:this.convertProblemPathToRoute()};if(this.options.solutionPage||(e={problem:"/homework-help/"+t+"-"+this.options.editionText+"-edition-chapter-:chapter-problem-:problem-solution-:isbn13",chapter:this.convertChapterPathToRoute()}),this.options.editionPage){var i=window.location.pathname,o=i.slice(0,i.lastIndexOf("-"));e=_.extend(e,{base:o+"-:isbn13"})}return e},convertProblemPathToRoute:function(){var t=window.location.pathname,e=/(.*chapter-)[^-]+(-problem-)[^-]+(-solution-)[^-]+/;return t.replace(e,"$1:chapter$2:problem$3:isbn13")},convertChapterPathToRoute:function(){var t=window.location.pathname,e=/(.*chapter-)[^-]+(-solutions-)[^-]+/;return t.replace(e,"$1:chapter$2:isbn13")},scrubTitleForRoutes:function(){var t=this.options.bookTitleText?this.options.bookTitleText.replace(/[^\w-_.~]/g,"-"):"";return t=t.replace(/-+/g,"-")},doAdobeLogging:function(){digitalData.page.pageName="TBS Solution Page",_satellite.track("pageView")},storeBookmarkedKvp:function(){$.ajax({url:"/_ajax/common/userkvp/set",type:"GET",data:{token:C.global.csrfToken,key:"bookmarkedTBS",value:1},context:this,success:$.proxy(function(t){this.displayBookmarkOnboarding(),this.options.bookmarkedTBS=!0},this),error:function(t){console.log("Error storing user kvp value "+JSON.stringify(t))}})},displayBookmarkOnboarding:function(){var t=$(".nav-item"),e=$(".nav-item.study-item .nav-hover-box"),i=$(".chg-container.center-content, .chg-content");e.css("display","block"),t.css("pointer-events","none"),i.css("position","relative"),$("body").addClass("noscroll");var o=function(){e.css("display","none"),t.css("pointer-events","auto"),$("body").removeClass("noscroll"),i.css("position","static")},s=[{top_padding:15,left_padding:60,handle:$(".nav-item-header.link-textbook-solutions"),img:"site/images/tbs2-overlay-text.png"}];Eggshell.create("C.common.onboardingoverlay",{el:$(".chg-container-content")}).trigger("dismiss_on_click").trigger("set_on_click_callback",o).trigger("set_instruction_points",s).trigger("render")},render:function(){var t=!0,e=this.options.odinConcatUrl?this.options.odinConcatUrl:window.location.origin;TBSPlayer.setRootURL(e);var i=TBSPlayer.getPlayer({target:document.querySelector("#solution-player-sdk"),isbn13:this.options.isbn13,user:this.options.userData,routes:this.getRoutes(),show_comments:this.options.accessExpireDate?!1:!0,show_bookmark:this.options.showBookmark,onProblemOpened:$.proxy(function(t){(this.options.solutionPage||this.options.chapterPage)&&(this.updateBreadcrumb(t.chapter,"chapter"),this.updateBreadcrumb(t.problem,"problem")),C.logger.doSessionLog({isbn_viewed:this.options.isbn13,problem_viewed:t.problem,chapter_viewed:t.chapter}),this.firstTimeLoading||this.doAdobeLogging(),this.firstTimeLoading=!1},this),onProblemLoaded:$.proxy(function(e){if(t)this.options.doOnboardingSequence&&setTimeout($.proxy(function(){this.doOnboardingSequence()},this),1e3);else{var i=$(".TBS_ROOT .main").offset().top;window.scrollTo(0,i-50)}var o=e&&e.problemId?e.problemId:null;o&&(Eggshell.find(this.tutorComponent).trigger("set entity id",o),this.setTutorsOpportunityModalData()),t=!1},this),onLimitExceeded:function(t){$(".fullscreen.contract").trigger("click"),Eggshell.create("C.common.viewlimitmodal")},onNoSolutionCTA:$.proxy(function(){C.utility.navigate(window.location.origin+"/"+this.options.qaPostPage)},this),onNetworkErrorCTA:function(){C.utility.refresh()},onBookmarkClicked:$.proxy(function(t){C.logger.doSessionLog(t.bookmarked?{bookmark_tbs_save:t.id}:{bookmark_tbs_unsave:t.id}),this.options.bookmarkedTBS||(C.logger.doSessionLog({bookmark_tbs_overlay:1}),this.storeBookmarkedKvp())},this),onReviewClicked:function(t){C.logger.doSessionLog({feedback_click:0==t.reviewValue?"thumbs_up":"thumbs_down"})}});this.fixHeaderOnScroll(),this.listenToFullScreenChange()},listenToFullScreenChange:function(){document.addEventListener("mozfullscreenchange",function(){window.fullScreen||$(".fullscreen.contract").trigger("click")},!1)},doOnboardingSequence:function(){C.logger.doSessionLog({onboarding_sequence_started:"TBS"});var t=[{handle:$(".TBS_TOOLBAR .bookmark-tab"),highlightHandle:$(".TBS_TOOLBAR .bookmark-tab"),content:"Save solution for quick access later on",position:"bottom"},{handle:$(".review-box .thumb-up"),highlightHandle:$(".review-box"),content:"Give us feedback on the solution provided",position:"bottom"},{handle:$(".chgg-hdr-search-container .chgg-hdr-search-box"),highlightHandle:$(".chgg-hdr-search-container .chgg-hdr-search-box"),content:"Search archive of millions of homework answers",position:"bottom"}],e=$(".chg-content"),i=$(".chg-content .global-breadcrumb");$(".chg-container.center-content").css({position:"relative"}),Eggshell.create("C.common.onboardingsequence",{el:$(".chg-container-content")}).trigger("set_banner_handle",i).trigger("set_obfuscation_handle",e).trigger("set_instruction_points",t).on("sequence_completed",function(){C.logger.doSessionLog({onboarding_sequence_completed:"TBS"})}).on("sequence_done",function(){$(".chg-container.center-content").css({position:"static"})}).on("close_button_clicked",function(t,e){C.logger.doSessionLog({onboarding_sequence_close:e.stepNumber})}).on("step_viewed",function(t,e){C.logger.doSessionLog({onboarding_sequence_viewed:e.stepNumber})}).trigger("render")},destroy:function(){var t=this.options.tbsSdkCDN+"js/index.js";$('script[type="text/javascript"][src~="'+t+'"]').remove()}});return t}());